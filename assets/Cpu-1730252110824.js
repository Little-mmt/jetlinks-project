import{au as C,aJ as U,aK as B,dr as H,af as F,A as T,g as V}from"./index-1730252110824.js";import"./index-1730252110824279.js";import{d as M}from"./dashboard-1730252110824.js";import{t as P,a as D,c as E,g as L,d as R}from"./tool-1730252110824.js";import G from"./ServerList-1730252110824.js";import J from"./echarts-1730252110824.js";import{d as j,k as p,r as K,e as X,w as Z,ab as $,U as y,V as A,X as l,_ as d,f as u,u as s,E as k,Z as q,F as z,G as Q,Y as W,af as ee,ag as te}from"./vue-1730252110824.js";import"./index-1730252110824297.js";const ae=c=>(ee("data-v-32537650"),c=c(),te(),c),se={class:"dash-board"},oe={class:"header"},ne=ae(()=>d("h3",null,"CPU使用率趋势",-1)),re={style:{height:"300px"}},le=j({name:"Cpu"}),ue=j({...le,props:{serviceId:{type:String,default:void 0},isNoCommunity:{type:Boolean,default:!1}},setup(c){p({});const g=p(!1),a=p({type:"hour",time:[null,null]}),h=p(!1),i=p([]),x=p([]),m=K({xAxis:[],data:[]}),N=()=>{a.value.type=void 0,w(a.value)},O=X(()=>{const t=i.value.length?i.value.map(e=>S(m.data,e)):P;return{xAxis:{type:"category",boundaryGap:!1,data:D(m.xAxis)},tooltip:{trigger:"axis",valueFormatter:e=>`${e}%`},yAxis:{type:"value"},grid:{left:"50px",right:"50px"},dataZoom:[{type:"inside",start:0,end:a.value.type!=="hour"?5:100},{start:0,end:a.value.type!=="hour"?5:100}],color:E,series:t}}),w=async t=>{var r;g.value=!0;const e=await M(R("cpu",t));if(e.success){const n={},_=new Set;(r=e.result)!=null&&r.length?(h.value=!1,e.result.forEach(v=>{var Y;const f=v.data.value,o=v.data.clusterNodeId;_.add(C(f.timestamp).format("YYYY-MM-DD HH:mm")),n[o]||(n[o]=[]),(Y=n[o])==null||Y.push(Number(f.cpuSystemUsage).toFixed(2))}),I(n,[..._.keys()])):(I([],[]),h.value=!0)}setTimeout(()=>{g.value=!1},300)},S=(t,e)=>({data:D(t[e]),name:e!="undefined"?e:"",type:"line",smooth:!0,symbol:"none"}),I=(t,e)=>{const r=Object.keys(t);i.value=r,x.value=r,m.xAxis=e,m.data=t};return Z(()=>a.value.type,t=>{if(t===void 0)return;const e=L(t);a.value.time=[C(e),C(new Date)],w(a.value)},{immediate:!0,deep:!0}),(t,e)=>{const r=$("AIcon"),n=U,_=B,b=H,v=F,f=T;return y(),A(f,{spinning:s(g)},{default:l(()=>[d("div",se,[d("div",oe,[ne,u(b,{onChange:N,allowClear:!1,"show-time":{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",value:s(a).time,"onUpdate:value":e[1]||(e[1]=o=>s(a).time=o)},{suffixIcon:l(()=>[u(r,{type:"CalendarOutlined"})]),renderExtraFooter:l(()=>[u(_,{"default-value":"a","button-style":"solid",style:{"margin-right":"10px"},value:s(a).type,"onUpdate:value":e[0]||(e[0]=o=>s(a).type=o)},{default:l(()=>[u(n,{value:"hour"},{default:l(()=>[k(" 最近1小时 ")]),_:1}),u(n,{value:"day"},{default:l(()=>[k(" 最近24小时 ")]),_:1}),u(n,{value:"week"},{default:l(()=>[k(" 近一周 ")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"])]),d("div",null,[s(h)?(y(),A(v,{key:0,style:{height:"200px","margin-top":"100px"}})):(y(),q(z,{key:1},[d("div",re,[u(J,{options:s(O)},null,8,["options"])]),s(x).length>1?(y(),A(G,{key:0,value:s(i),"onUpdate:value":e[2]||(e[2]=o=>Q(i)?i.value=o:null),options:s(x),color:s(E)},null,8,["value","options","color"])):W("",!0)],64))])])]),_:1},8,["spinning"])}}});const ye=V(ue,[["__scopeId","data-v-32537650"]]);export{ye as default};
