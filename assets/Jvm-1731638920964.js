import{au as A,aJ as T,aK as B,dr as N,af as S,A as U,g as L}from"./index-1731638920964.js";import"./index-1731638920964279.js";import{d as R}from"./dashboard-1731638920964.js";import{t as G,a as Y,b as D,g as K,d as P}from"./tool-1731638920964.js";import X from"./ServerList-1731638920964.js";import Z from"./echarts-1731638920964.js";import{d as E,k as u,r as $,e as q,w as z,ab as Q,U as y,V as k,X as l,_ as m,f as i,u as o,E as j,Z as W,F as ee,G as te,Y as ae,af as oe,ag as se}from"./vue-1731638920964.js";import"./index-1731638920964297.js";const ne=c=>(oe("data-v-a8a6dc25"),c=c(),se(),c),re={class:"dash-board"},le={class:"header"},ie=ne(()=>m("h3",null,"JVM内存使用率趋势",-1)),pe={style:{height:"300px"}},ue=E({name:"Jvm"}),de=E({...ue,props:{serviceId:{type:String,default:void 0},isNoCommunity:{type:Boolean,default:!1}},setup(c){u({});const g=u(!1),a=u({type:"hour",time:[null,null]}),h=u(!1),p=u([]),x=u([]),_=$({xAxis:[],data:[]}),V=()=>{a.value.type=void 0,w(a.value)},w=async t=>{var n;g.value=!0;const e=await R(P("jvm",t));if(e.success){const s={},v=new Set;(n=e.result)!=null&&n.length?(h.value=!1,e.result.forEach(f=>{var C;const d=f.data.value,r=d.memoryJvmHeapFree,b=d.memoryJvmHeapTotal,J=f.data.clusterNodeId,O=((b-r)/b*100).toFixed(2);s[J]||(s[J]=[]),v.add(A(d.timestamp).format("YYYY-MM-DD HH:mm")),(C=s[J])==null||C.push(O)}),H(s,[...v.keys()])):(H([],[]),h.value=!0)}setTimeout(()=>{g.value=!1},300)},F=(t,e)=>({data:Y(t[e]),name:e!=="undefined"?e:"",type:"line",smooth:!0,symbol:"none"}),H=(t,e)=>{const n=Object.keys(t);p.value=n,x.value=n,_.xAxis=e,_.data=t},M=q(()=>{const t=p.value.length?p.value.map(e=>F(_.data,e)):G;return{xAxis:{type:"category",boundaryGap:!1,data:Y(_.xAxis)},tooltip:{trigger:"axis",valueFormatter:e=>`${e}%`},yAxis:{type:"value"},grid:{left:"50px",right:"50px"},dataZoom:[{type:"inside",start:0,end:a.value.type!=="hour"?10:100},{start:0,end:a.value.type!=="hour"?10:100}],color:D,series:t}});return z(()=>a.value.type,t=>{if(t===void 0)return;const e=K(t);a.value.time=[A(e),A(new Date)],w(a.value)},{immediate:!0,deep:!0}),(t,e)=>{const n=Q("AIcon"),s=T,v=B,I=N,f=S,d=U;return y(),k(d,{spinning:o(g)},{default:l(()=>[m("div",re,[m("div",le,[ie,i(I,{onChange:V,allowClear:!1,"show-time":{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",value:o(a).time,"onUpdate:value":e[1]||(e[1]=r=>o(a).time=r)},{suffixIcon:l(()=>[i(n,{type:"CalendarOutlined"})]),renderExtraFooter:l(()=>[i(v,{"default-value":"a","button-style":"solid",style:{"margin-right":"10px"},value:o(a).type,"onUpdate:value":e[0]||(e[0]=r=>o(a).type=r)},{default:l(()=>[i(s,{value:"hour"},{default:l(()=>[j(" 最近1小时 ")]),_:1}),i(s,{value:"day"},{default:l(()=>[j(" 最近24小时 ")]),_:1}),i(s,{value:"week"},{default:l(()=>[j(" 近一周 ")]),_:1})]),_:1},8,["value"])]),_:1},8,["value"])]),m("div",null,[o(h)?(y(),k(f,{key:0,style:{height:"200px","margin-top":"100px"}})):(y(),W(ee,{key:1},[m("div",pe,[i(Z,{options:o(M)},null,8,["options"])]),o(x).length>1?(y(),k(X,{key:0,value:o(p),"onUpdate:value":e[2]||(e[2]=r=>te(p)?p.value=r:null),options:o(x),color:o(D)},null,8,["value","options","color"])):ae("",!0)],64))])])]),_:1},8,["spinning"])}}});const xe=L(de,[["__scopeId","data-v-a8a6dc25"]]);export{xe as default};
