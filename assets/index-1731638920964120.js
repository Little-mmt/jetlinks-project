import{h as w,s as y,Y as S,g as M}from"./index-1731638920964.js";import{U as P,B as x}from"./baseMenu-1731638920964.js";import{e as E,f as B}from"./initHome-1731638920964.js";import{g as D}from"./channel-1731638920964.js";import{d as I,r as C,H as N,U,Z as k,_ as c,u as p,$ as R,af as T,ag as b}from"./vue-1731638920964.js";const A=i=>(T("data-v-93a967dc"),i=i(),b(),i),O={class:"menu-style"},V={class:"menu-img"},j=["src"],q={class:"menu-info"},F=A(()=>c("div",null,"初始化后的菜单可在“菜单管理”页面进行维护管理",-1)),H=I({__name:"index",setup(i,{expose:f}){const r=C({count:0,current:void 0}),h=async()=>{var n,s;let t="";const e=await y();if(e.success&&e.result&&(t=e.result.edition),t!=="community")try{const u=((s=(n=(await D()).result)==null?void 0:n.map)==null?void 0:s.call(n,a=>a.id))||[];return S.some(a=>u.includes(a.value))}catch{return!1}},m=async()=>{const t=await h(),e=await E();if(e.status===200){const n=d(e.result.map(o=>JSON.parse(o).id),x,t),s=l(n);r.current=n,r.count=s}},d=(t,e,n)=>e.filter(s=>{var u;let o=!1;return s.showPage&&s.showPage.length&&(o=s.showPage.some(a=>t.includes(a))),s.children&&(s.children=d(t,s.children,n)),!n&&s.code=="link/DataCollect"?!1:o||!!((u=s.children)!=null&&u.length)}),l=t=>t.reduce((e,n)=>{let s=1;return n.children&&(s=l(n.children)),e+s},0),_=t=>{t.forEach(e=>{e.options=Object.assign({show:!0},(e==null?void 0:e.options)||{}),e.children&&_(e.children)})},g=async()=>new Promise(async t=>{_(r.current),(await B([...r.current,P])).status===200?t(!0):t(!1)}),{count:v}=N(r);return m(),f({updataMenu:g}),(t,e)=>(U(),k("div",O,[c("div",V,[c("img",{src:p(w)("/init-home/menu.png")},null,8,j)]),c("div",q,[c("b",null,"系统初始化"+R(p(v))+"个菜单",1),F])]))}});const z=M(H,[["__scopeId","data-v-93a967dc"]]);export{z as default};
