import{a as E,Z as d,o as l,eX as V,d as R,as as T,aL as A,aM as J,aN as L,ax as q,e as F,a3 as M,g as U}from"./index-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import X from"./EditDialog-17316389209642.js";import{g as z,a as b,e as Y,d as Z}from"./permission-1731638920964.js";import{d as G,k as x,r as H,ab as _,U as k,V as P,X as t,_ as K,f as e,u as p,E as f,Y as Q}from"./vue-1731638920964.js";const W={class:"permission-container"},c="system/Permission",ee=G({__name:"index",setup(te){const C=E().hasPermission,g=[{title:"标识",dataIndex:"id",key:"id",ellipsis:!0,fixed:"left",search:{type:"string"}},{title:"名称",dataIndex:"name",key:"name",ellipsis:!0,search:{type:"string",first:!0}},{title:"状态",dataIndex:"status",key:"status",scopedSlots:!0,search:{type:"select",options:[{label:"启用",value:1},{label:"禁用",value:0}],handleValue:s=>s}},{title:"操作",dataIndex:"action",key:"action",width:120,fixed:"right",scopedSlots:!0}],h=x({}),I=s=>{h.value=s},m=x({}),r={openDialog:(s={})=>{u.selectItem={...s},u.visible=!0},clickImport:s=>{if(s.type==="application/json"){const a=new FileReader;a.readAsText(s),a.onload=n=>{try{const i=JSON.parse(n.target.result);b(i).then(y=>{y.status===200&&(l("导入成功"),r.refresh())})}catch{l("导入失败，请重试！","error")}}}else l("请上传json格式","error");return!1},clickExport:()=>{const s={paging:!1,...h.value},a=Y(s);return a.then(n=>{n.status===200?(V(n.result,"权限数据"),l("导出成功")):l("导出错误","error")}),a},changeStatus:s=>{const a={...s,status:s.status?0:1},n=b(a);return n.then(()=>{l("操作成功"),m.value.reload()}),n},clickDel:s=>{const a=Z(s.id);return a.then(n=>{var i;n.status===200&&((i=m.value)==null||i.reload(),l("操作成功!"))}),a},refresh:()=>{m.value.reload()}},u=H({selectItem:{},visible:!1});return(s,a)=>{const n=_("pro-search"),i=_("AIcon"),y=R,j=T,v=A,S=J,$=L,D=q,B=F,N=M,O=_("FullPage"),w=_("page-container");return k(),P(w,null,{default:t(()=>[K("div",W,[e(n,{columns:g,target:"system-permission",onSearch:I}),e(O,null,{default:t(()=>[e(N,{ref_key:"tableRef",ref:m,columns:g,request:p(z),model:"TABLE",params:p(h),defaultParams:{sorts:[{name:"id",order:"asc"}]}},{headerTitle:t(()=>[e(d,{type:"primary",hasPermission:`${c}:add`,onClick:a[0]||(a[0]=o=>r.openDialog(void 0))},{default:t(()=>[e(i,{type:"PlusOutlined"}),f("新增 ")]),_:1},8,["hasPermission"]),e($,{trigger:"hover"},{overlay:t(()=>[e(S,null,{default:t(()=>[e(v,null,{default:t(()=>[e(j,{name:"file",action:"#",accept:".json",showUploadList:!1,"before-upload":r.clickImport,disabled:!p(C)(`${c}:import`)},{default:t(()=>[e(d,{hasPermission:`${c}:import`},{default:t(()=>[f(" 导入 ")]),_:1},8,["hasPermission"])]),_:1},8,["before-upload","disabled"])]),_:1}),e(v,null,{default:t(()=>[e(d,{hasPermission:`${c}:export`,popConfirm:{title:"确认导出？",onConfirm:()=>r.clickExport()}},{default:t(()=>[f(" 导出 ")]),_:1},8,["hasPermission","popConfirm"])]),_:1})]),_:1})]),default:t(()=>[e(y,null,{default:t(()=>[f("批量操作")]),_:1})]),_:1})]),status:t(o=>[e(D,{status:o.status,text:o.status?"启用":"禁用",statusNames:{1:"success",0:"error"}},null,8,["status","text"])]),action:t(o=>[e(B,{size:16},{default:t(()=>[e(d,{hasPermission:`${c}:update`,type:"link",tooltip:{title:"编辑"},onClick:se=>r.openDialog(o)},{default:t(()=>[e(i,{type:"EditOutlined"})]),_:2},1032,["hasPermission","onClick"]),e(d,{hasPermission:`${c}:action`,type:"link",popConfirm:{title:`确认${o.status?"禁用":"启用"}？`,onConfirm:()=>r.changeStatus(o)},tooltip:{title:o.status?"禁用":"启用"}},{default:t(()=>[e(i,{type:o.status?"StopOutlined":"PlayCircleOutlined"},null,8,["type"])]),_:2},1032,["hasPermission","popConfirm","tooltip"]),e(d,{hasPermission:`${c}:delete`,type:"link",tooltip:{title:o.status?"请先禁用，再删除":"删除"},popConfirm:{title:"确认删除",onConfirm:()=>r.clickDel(o)},disabled:o.status},{default:t(()=>[e(i,{type:"DeleteOutlined"})]),_:2},1032,["hasPermission","tooltip","popConfirm","disabled"])]),_:2},1024)]),_:1},8,["request","params"])]),_:1}),p(u).visible?(k(),P(X,{key:0,visible:p(u).visible,"onUpdate:visible":a[1]||(a[1]=o=>p(u).visible=o),data:p(u).selectItem,onRefresh:r.refresh},null,8,["visible","data","onRefresh"])):Q("",!0)])]),_:1})}}});const me=U(ee,[["__scopeId","data-v-8cf0120e"]]);export{me as default};
