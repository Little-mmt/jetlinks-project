import{Z as y,o as b,J as j,ax as w,e as N,a3 as O,g as V}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import J from"./EditUserDialog-1730252110824.js";import{f as z,h as R,q as F,i as M,j as X}from"./user-17302521108242.js";import{d as D,k as x,r as Y,ab as _,U as C,V as T,X as i,_ as S,f as a,u as c,E as f,$ as v,Y as Z}from"./vue-1730252110824.js";import"./validate-1730252110824.js";import"./regular-1730252110824.js";const H={class:"user-container"},K={class:"username"},Q=D({name:"UserMange"}),W=D({...Q,setup(A){const d="system/User",g=[{title:"姓名",dataIndex:"name",key:"name",ellipsis:!0,search:{type:"string"}},{title:"用户名",dataIndex:"username",key:"username",scopedSlots:!0,search:{type:"string"}},{title:"用户类型",dataIndex:"type",key:"type",ellipsis:!0,search:{type:"select",options:()=>new Promise(s=>{R().then(n=>{s(n.result.map(o=>({label:o.name,value:o.id})))})})},scopedSlots:!0},{title:"角色",dataIndex:"roleList",key:"roleList",search:{type:"select",options:()=>new Promise(s=>{F({paging:!1,sorts:[{name:"createTime",order:"desc"},{name:"id",order:"desc"}]}).then(n=>{s(n.result.map(o=>({label:o.name,value:o.id})))})})},scopedSlots:!0},{title:"状态",dataIndex:"status",key:"status",ellipsis:!0,search:{rename:"status",type:"select",options:[{label:"正常",value:1},{label:"禁用",value:0}]},scopedSlots:!0},{title:"手机号",dataIndex:"telephone",key:"telephone",ellipsis:!0,search:{type:"string"}},{title:"邮箱",dataIndex:"email",key:"email",ellipsis:!0,search:{type:"string"}},{title:"操作",dataIndex:"action",key:"action",fixed:"right",width:200,scopedSlots:!0}],$=x({}),k=x({}),r={openDialog:(s,n)=>{p.selectItem={...n||{}},p.type=s,p.visible=!0},changeStatus:({id:s,status:n})=>{const l=M({status:n===0?1:0,id:s});return l.then(()=>{b("操作成功"),r.refresh()}),l},clickDel:s=>{const n=X(s);return n.then(()=>{b("操作成功"),r.refresh()}),n},refresh:()=>{k.value.reload()}},p=Y({selectItem:{},visible:!1,type:""}),L=s=>{var o;const n=(o=s==null?void 0:s.terms)==null?void 0:o.map(l=>{let m=[];return l.terms=l.terms.map(e=>{if(e.column==="id$in-dimension$role"){let h=e.termType==="nin"?"not$in":e.termType;e.column=`${e.column}$${h}`,delete e.termType}return["telephone","email"].includes(e.column)?{column:"id$user-detail",value:[e]}:(["type"].includes(e.column)&&e.value==="other"&&(m=[{...e,type:"or",termType:"isnull",value:1},{...e,type:"or",termType:"empty",value:1}]),e.column==="roleList"?e.termType==="eq"||e.termType==="in"?{column:"id$in-dimension$role",type:e.type,value:e.value}:{column:"id$in-dimension$role$not",type:e.type,value:e.value}:e.column==="roleList"?e.termType==="eq"||e.termType==="in"?{column:"id$in-dimension$role",type:e.type,value:e.value}:{column:"id$in-dimension$role$not",type:e.type,value:e.value}:e)}),m.length&&(l.terms=[...l.terms,...m]),l});$.value={terms:n||[]}};return(s,n)=>{const o=_("pro-search"),l=_("AIcon"),m=_("Ellipsis"),e=j,h=w,P=N,U=O,q=_("FullPage"),E=_("page-container");return C(),T(E,null,{default:i(()=>[S("div",H,[a(o,{columns:g,target:"system-user",onSearch:L}),a(q,null,{default:i(()=>[a(U,{ref_key:"tableRef",ref:k,columns:g,request:c(z),model:"TABLE",params:c($),defaultParams:{sorts:[{name:"createTime",order:"desc"},{name:"username",order:"asc",value:"admin"}]}},{headerTitle:i(()=>[a(y,{hasPermission:`${d}:add`,type:"primary",onClick:n[0]||(n[0]=t=>r.openDialog("add"))},{default:i(()=>[a(l,{type:"PlusOutlined"}),f("新增 ")]),_:1},8,["hasPermission"])]),username:i(t=>[S("div",K,[a(m,null,{default:i(()=>[f(v(t.username),1)]),_:2},1024)])]),type:i(t=>{var u;return[f(v((u=t.type)==null?void 0:u.name),1)]}),roleList:i(t=>[a(e,null,{default:i(()=>{var u;return[f(v((u=t==null?void 0:t.roleList)==null?void 0:u.map(B=>B.name).join(",")),1)]}),_:2},1024)]),status:i(t=>[a(h,{status:t.status,text:t.status?"正常":"禁用",statusNames:{1:"success",0:"error"}},null,8,["status","text"])]),action:i(t=>[a(P,{size:16},{default:i(()=>[a(y,{hasPermission:`${d}:update`,type:"link",tooltip:{title:"编辑"},onClick:u=>r.openDialog("edit",t)},{default:i(()=>[a(l,{type:"EditOutlined"})]),_:2},1032,["hasPermission","onClick"]),a(y,{hasPermission:`${d}:action`,type:"link",tooltip:{title:`${t.status?"禁用":"启用"}`},popConfirm:{title:`确认${t.status?"禁用":"启用"}？`,onConfirm:()=>r.changeStatus(t)}},{default:i(()=>[a(l,{type:t.status?"StopOutlined":"PlayCircleOutlined"},null,8,["type"])]),_:2},1032,["hasPermission","tooltip","popConfirm"]),a(y,{hasPermission:`${d}:update`,type:"link",tooltip:{title:"重置密码"},onClick:u=>r.openDialog("reset",t)},{default:i(()=>[a(l,{type:"icon-zhongzhimima"})]),_:2},1032,["hasPermission","onClick"]),a(y,{type:"link",hasPermission:`${d}:delete`,tooltip:{title:t.status?"请先禁用，再删除":"删除"},popConfirm:{title:"确认删除?",onConfirm:()=>r.clickDel(t.id)},disabled:t.status},{default:i(()=>[a(l,{type:"DeleteOutlined"})]),_:2},1032,["hasPermission","tooltip","popConfirm","disabled"])]),_:2},1024)]),_:1},8,["request","params"])]),_:1}),c(p).visible?(C(),T(J,{key:0,type:c(p).type,visible:c(p).visible,"onUpdate:visible":n[1]||(n[1]=t=>c(p).visible=t),data:c(p).selectItem,onConfirm:r.refresh},null,8,["type","visible","data","onConfirm"])):Z("",!0)])]),_:1})}}});const ue=V(W,[["__scopeId","data-v-fdfb98d4"]]);export{ue as default};
