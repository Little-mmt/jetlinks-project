import{g as I,k as S,g1 as $,aC as j,gx as L,gv as Z,o as q,Z as A}from"./index-1730252110824.js";import{Z as F}from"./index-1730252110824309.js";import z from"./editTag-1730252110824.js";import{c as h,k as d,o as R,ab as x,U as g,Z as C,_ as p,f as r,X as m,E as w,u as o,F as D,a1 as U,a0 as X,$ as Y,V as G,Y as H,d as J}from"./vue-1730252110824.js";const K={class:"tag"},Q={class:"tagLeft"},W={class:"controls"},ee=J({name:"CalendarTags"}),te=Object.assign(ee,{setup(ae){const v=S(),n=v.$state.calendarTagColor,E=h("tagsMap"),_=h("rapidOn"),i=d(!1),k=d(),f=d(),y=d(),T=d(),B=()=>{i.value=!0,y.value="add"},N=["weekend","holiday","workday"],c=new Map;c.set("weekend","rgb(149, 222, 100)"),c.set("holiday","rgb(161, 180, 204)"),c.set("workday","rgba(105,177,255)");const O=()=>{new F(k.value,{itemSelector:".tagName",eventData:function(e){return{id:e.id,title:e.innerText,backgroundColor:n.get(e.id)||"#000000",color:"#000",editable:!1}}})},b=async()=>{const e=await $();e.success&&(await v.getTagsColor(),f.value=e.result.map(t=>{let a="#000000",l=!1;return n.has(t.id)&&(a=n.get(t.id)),N.includes(t.id)&&(l=!0,a=c.get(t.id)),{...t,color:a,disabled:l}}),E.value=f.value.map(t=>j(t,["disabled"])))},V=()=>{i.value=!1,b()},M=async e=>{if((await L([e])).success){if(n.has(e)){n.delete(e);let a=new Object;n.forEach((l,u)=>{a[u]=l}),await Z(a)}q("操作成功"),b()}},P=e=>{i.value=!0,y.value="edit",T.value=e};return R(()=>{b(),O()}),(e,t)=>{const a=A,l=x("Ellipsis"),u=x("AIcon");return g(),C(D,null,[p("div",{class:"tagsContainer",ref_key:"tags",ref:k},[r(a,{type:"primary",hasPermission:"system/Calendar:add",ghost:"",block:"",onClick:B,disabled:o(_),style:{"margin-bottom":"10px"}},{default:m(()=>[w(" + 新增标签 ")]),_:1},8,["disabled"]),(g(!0),C(D,null,U(o(f),s=>(g(),C("div",K,[p("div",Q,[p("div",{style:X({background:s.color}),class:"colorExtractor"},null,4),r(l,{class:"tagName",style:{width:"120px",cursor:"url('/images/calendar/hover.png'), pointer"},id:s.id},{default:m(()=>[w(Y(s.name),1)]),_:2},1032,["id"])]),p("div",W,[r(a,{type:"text",hasPermission:"system/Calendar:update",disabled:s.disabled||o(_),tooltip:{title:"编辑"},onClick:()=>P(s)},{icon:m(()=>[r(u,{type:"EditOutlined"})]),_:2},1032,["disabled","onClick"]),r(a,{type:"text",hasPermission:"system/Calendar:delete",disabled:s.disabled||o(_),tooltip:{title:"删除"},popConfirm:{title:"确认删除？",onConfirm:()=>M(s.id)}},{icon:m(()=>[r(u,{type:"DeleteOutlined"})]),_:2},1032,["disabled","popConfirm"])])]))),256))],512),o(i)?(g(),G(z,{key:0,"edit-type":o(y),editData:o(T),onCloseEditTag:t[0]||(t[0]=s=>i.value=!1),onRefresh:V},null,8,["edit-type","editData"])):H("",!0)],64)}}}),re=I(te,[["__scopeId","data-v-7c6418c5"]]);export{re as default};
