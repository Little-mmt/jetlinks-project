import{fy as O,a6 as k,v as P,a0 as N,a1 as B,F as D}from"./index-1731638920964.js";import"./index.vue_vue_type_script_setup_true_name_Timer_lang-1731638920964.js";import"./TopCard.vue_vue_type_style_index_0_scoped_47c4fbf1_lang-1731638920964.js";import"./TriggerWay.vue_vue_type_style_index_0_scoped_1bb0f74d_lang-1731638920964.js";import{_ as S}from"./FunctionCall.vue_vue_type_script_setup_true_name_FunctionCall_lang-1731638920964.js";import{d as T,r as U,k as m,e as _,q as $,U as y,V as h,X as s,f as u,u as r,Y as q,_ as J}from"./vue-1731638920964.js";const A=J("span",{style:{"line-height":"32px","padding-left":"24px"}}," 定时调用所选属性 ",-1),M=T({name:"WriteProperties"}),G=T({...M,props:{value:{type:Object,default:()=>[]},action:{type:String,default:""},properties:{type:Array,default:()=>[]}},emits:["update:value","update:action"],setup(f,{expose:g,emit:i}){const p=f,l=U({reportKey:void 0,data:Object.keys(p.value).map(t=>({name:t,value:p.value[t]}))||[]}),j=m(),v=m();m([]);const w=(t,e)=>{var a;if(e==="enum")return(a=t.valueType.elements)==null?void 0:a.map(o=>({...o,label:o.text}));if(e==="boolean")return[{label:t.valueType.trueText,value:t.valueType.trueValue},{label:t.valueType.falseText,value:t.valueType.falseValue}]},d=_(()=>{const t=Object.keys(p.value);return t.length?t.map(e=>{var o;const a=p.properties.find(n=>n.id===e);if(a){const n=w(a,(o=a.valueType)==null?void 0:o.type);return{id:a.id,name:a.name,type:a.valueType?a.valueType.type:"-",format:a.valueType?a.valueType.format:void 0,options:n,value:p.value[e]}}return{id:e,name:e,type:"",format:void 0,options:void 0,value:void 0}}):[]});$(()=>{l.reportKey=Object.keys(p.value)[0]});const x=_(()=>!!l.reportKey),b=(t,e)=>{const a={[t]:void 0};j.value=[{id:t,value:void 0}],i("update:value",a),i("update:action",`修改${e.name}`)},K=t=>{var e;i("update:value",{[l.reportKey]:(e=t[0])==null?void 0:e.value})},C=[{validator(t,e){if(!(e!=null&&e.length)&&d.value.length)return Promise.reject("请选择属性值");{let a=e.find(o=>!o.value);if(a){const o=d.value.find(n=>n.id===a.name);return Promise.reject(o!=null&&o.name?`请输入${o==null?void 0:o.name}值`:"请输入属性值")}}return Promise.resolve()}}];return g({validateFields:()=>new Promise(async t=>{var a;const e=await((a=v.value)==null?void 0:a.validateFields());t(e)})}),(t,e)=>{const a=k,o=P,n=N,V=B,F=D;return y(),h(F,{ref_key:"writeForm",ref:v,model:r(l),layout:"vertical",colon:!1},{default:s(()=>[u(V,{futter:[24,24]},{default:s(()=>[u(n,{span:10},{default:s(()=>[u(o,{name:"reportKey",rules:[{required:!0,message:"请输入修改值"}]},{default:s(()=>[u(a,{showSearch:"",style:{width:"100%"},placeholder:"请选择属性",value:r(l).reportKey,"onUpdate:value":e[0]||(e[0]=c=>r(l).reportKey=c),options:f.properties,"filter-option":r(O),onChange:b},null,8,["value","options","filter-option"])]),_:1})]),_:1}),u(n,{span:14},{default:s(()=>[A]),_:1}),r(x)?(y(),h(n,{key:0,span:24},{default:s(()=>[u(o,{name:"data",rules:C},{default:s(()=>[u(r(S),{value:r(l).data,"onUpdate:value":e[1]||(e[1]=c=>r(l).data=c),data:r(d),onChange:K},null,8,["value","data"])]),_:1})]),_:1})):q("",!0)]),_:1})]),_:1},8,["model"])}}});export{G as _};
