import{au as j,o as _,Z as H,e as J,a3 as L}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{d as R,g as U,r as Z}from"./firmware-1730252110824.js";import $ from"./index-173025211082449.js";import z from"./index-173025211082446.js";import{l as b}from"./lodash.default-1730252110824.js";import{d as S,k as s,o as X,ab as u,U as p,V as m,X as o,_ as k,f as i,u as r,E as G,$ as P,Z as K,F as Q,a1 as W,Y as T}from"./vue-1730252110824.js";import"./index-1730252110824299.js";import"./index-1730252110824300.js";import"./index.vue_vue_type_script_setup_true_name_TaskPage_lang-1730252110824.js";import"./SelectDevices-1730252110824.js";import"./index-173025211082447.js";import"./FileUpload-1730252110824.js";import"./throttle-1730252110824.js";import"./min-1730252110824.js";import"./isNil-1730252110824.js";import"./isUndefined-1730252110824.js";import"./difference-1730252110824.js";import"./flattenDeep-1730252110824.js";import"./sortBy-1730252110824.js";import"./unionBy-1730252110824.js";import"./uniqBy-1730252110824.js";import"./toLower-1730252110824.js";const ee=S({name:"FirmwarePage"}),De=S({...ee,setup(te){const f=s({}),v=s({}),y=s([]),c=s(!1),d=s({}),h=s(!1),g=s(""),C=s(),I=[{title:"固件名称",key:"name",dataIndex:"name",fixed:"left",width:200,ellipsis:!0,search:{type:"string"}},{title:"固件版本",dataIndex:"version",key:"version",ellipsis:!0,search:{type:"string"}},{title:"所属产品",dataIndex:"productId",key:"productId",ellipsis:!0,width:200,scopedSlots:!0,search:{type:"select",options:y}},{title:"签名方式",dataIndex:"signMethod",key:"signMethod",scopedSlots:!0,search:{type:"select",options:[{label:"MD5",value:"md5"},{label:"SHA256",value:"sha256"}]},width:150},{title:"创建时间",key:"createTime",dataIndex:"createTime",search:{type:"date"},width:200,scopedSlots:!0},{title:"说明",dataIndex:"description",key:"description",ellipsis:!0,search:{type:"string"}},{title:"操作",key:"action",fixed:"right",width:120,scopedSlots:!0}],F=e=>e?[{key:"view",text:"升级任务",tooltip:{title:"升级任务"},icon:"FileTextOutlined",onClick:async()=>{D(e)}},{key:"update",text:"编辑",tooltip:{title:"编辑"},icon:"EditOutlined",onClick:async()=>{M(e)}},{key:"delete",text:"删除",tooltip:{title:"删除"},popConfirm:{title:"确认删除?",onConfirm:()=>A(e.id)},icon:"DeleteOutlined"}]:[],D=e=>{h.value=!0,g.value=e.id,C.value=e.productId,console.log(e)},B=()=>{d.value={},c.value=!0},M=e=>{d.value=b.cloneDeep(e),c.value=!0},O=e=>{c.value=!1,d.value={},e&&(_("操作成功","success"),f.value.reload())},A=e=>{const n=Z(e);return n.then(t=>{t.status===200?(_("操作成功","success"),f.value.reload()):_(t==null?void 0:t.message,"error")}),n};X(()=>{R({paging:!1,sorts:[{name:"name",order:"desc"}],terms:[{column:"state",value:1}]}).then(e=>{const n=e.result.filter(t=>b.map((t==null?void 0:t.features)||[],"id").includes("supportFirmware"));y.value=n.map(t=>({label:t.name,value:t.id}))})});const E=e=>{v.value=e};return(e,n)=>{const t=u("pro-search"),w=u("AIcon"),x=H,N=J,V=L,Y=u("FullPage"),q=u("page-container");return p(),m(q,null,{default:o(()=>[k("div",null,[i(t,{columns:I,target:"search-firmware",onSearch:E}),i(Y,null,{default:o(()=>[i(V,{ref_key:"tableRef",ref:f,model:"TABLE",columns:I,request:r(U),defaultParams:{sorts:[{name:"createTime",order:"desc"}]},params:r(v)},{headerTitle:o(()=>[i(x,{type:"primary",onClick:B,hasPermission:"device/Firmware:add"},{icon:o(()=>[i(w,{type:"PlusOutlined"})]),default:o(()=>[G(" 新增 ")]),_:1})]),productId:o(l=>[k("span",null,P(l.productName),1)]),createTime:o(l=>[k("span",null,P(r(j)(l.createTime).format("YYYY-MM-DD HH:mm:ss")),1)]),action:o(l=>[i(N,{size:16},{default:o(()=>[(p(!0),K(Q,null,W(F(l),a=>(p(),m(x,{key:a.key,disabled:a.disabled,popConfirm:a.popConfirm,tooltip:{...a.tooltip},style:{padding:"0px"},onClick:a.onClick,type:"link",danger:a.key==="delete",hasPermission:"device/Firmware:"+a.key},{icon:o(()=>[i(w,{type:a.icon},null,8,["type"])]),_:2},1032,["disabled","popConfirm","tooltip","onClick","danger","hasPermission"]))),128))]),_:2},1024)]),_:1},8,["request","params"])]),_:1})]),r(c)?(p(),m(z,{key:0,data:r(d),productOptions:r(y),onChange:O},null,8,["data","productOptions"])):T("",!0),r(h)?(p(),m($,{key:1,firmwareId:r(g),productId:r(C),onCloseDrawer:n[0]||(n[0]=l=>h.value=!1)},null,8,["firmwareId","productId"])):T("",!0)]),_:1})}}});export{De as default};
