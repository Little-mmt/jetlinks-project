import{d as P,ac as T,e as k,k as _,p as V,U as v,Z as j,f as o,X as r,u as a,V as C,E as y,Y as M,G as S,af as w,ag as x,_ as J}from"./vue-1731638920964.js";import{cD as K,Z as b,eV as R,eC as U,eT as O,e as Z,_ as q,f as A,g as D}from"./index-1731638920964.js";import{u as G}from"./instance-1731638920964.js";import L from"./index-1731638920964104.js";import X from"./index-1731638920964103.js";import u from"./Base-1731638920964.js";import{u as Y}from"./metadata-1731638920964.js";import"./product-17316389209644.js";import"./product-17316389209645.js";import"./encodeQuery-1731638920964.js";import"./index-1731638920964302.js";import"./context-1731638920964.js";import"./columns-1731638920964.js";import"./utils-1731638920964.js";import"./Source-1731638920964.js";import"./Source.vue_vue_type_style_index_0_scoped_5dc360f1_lang-1731638920964.js";import"./index.vue_vue_type_script_setup_true_name_VirtualRule_lang-1731638920964.js";import"./Rule.vue_vue_type_script_setup_true_name_Rule_lang-1731638920964.js";import"./index-1731638920964304.js";import"./index-1731638920964284.js";import"./index-1731638920964282.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./lodash.default-1731638920964.js";import"./throttle-1731638920964.js";import"./min-1731638920964.js";import"./isNil-1731638920964.js";import"./isUndefined-1731638920964.js";import"./difference-1731638920964.js";import"./flattenDeep-1731638920964.js";import"./sortBy-1731638920964.js";import"./unionBy-1731638920964.js";import"./uniqBy-1731638920964.js";import"./toLower-1731638920964.js";import"./index-1731638920964294.js";import"./index-1731638920964296.js";import"./data-17316389209643.js";import"./index-1731638920964293.js";import"./index-1731638920964295.js";import"./ConfigParams.vue_vue_type_style_index_0_scoped_5c08861f_lang-1731638920964.js";import"./ConfigModal.vue_vue_type_script_setup_true_name_ConfigModal_lang-1731638920964.js";import"./ValueObject.vue_vue_type_script_setup_true_name_ValueObject_lang-1731638920964.js";import"./DataTypeObjectChild-1731638920964.js";import"./OtherConfigInfo.vue_vue_type_script_setup_true_name_OtherConfigInfo_lang-1731638920964.js";import"./ModelButton-1731638920964.js";import"./Metrics.vue_vue_type_script_setup_true_name_Metrics_lang-1731638920964.js";import"./ValueItem-1731638920964.js";import"./item-17316389209642.js";import"./BooleanSelect-1731638920964.js";import"./OtherSetting.vue_vue_type_style_index_0_scoped_d8c8c8c1_lang-1731638920964.js";import"./index-1731638920964276.js";import"./useRequest-1731638920964.js";import"./OutputParams.vue_vue_type_style_index_0_scoped_6ffcb997_lang-1731638920964.js";import"./Type.vue_vue_type_script_setup_true_name_DataTypeSelect_lang-1731638920964.js";import"./Constraint-1731638920964.js";import"./OtherSetting-1731638920964.js";import"./metadata-17316389209642.js";import"./PropertiesModal.vue_vue_type_script_setup_true_name_PropertiesModal_lang-1731638920964.js";import"./index-1731638920964300.js";import"./JsonView-1731638920964.js";import"./index-1731638920964285.js";import"./DetailModal-1731638920964.js";import"./FunctionModal.vue_vue_type_script_setup_true_name_FunctionModal_lang-1731638920964.js";import"./EventModal.vue_vue_type_script_setup_true_name_EventModal_lang-1731638920964.js";import"./TagsModal.vue_vue_type_script_setup_true_name_TagsModal_lang-1731638920964.js";import"./data-17316389209644.js";import"./Import-1731638920964.js";const z=n=>(w("data-v-40826b80"),n=n(),x(),n),F={class:"device-detail-metadata",style:{position:"relative"}},H=z(()=>J("span",{class:"desc"},"设备会默认继承产品的物模型，继承的物模型不支持删改",-1)),Q=P({name:"Metadata"}),W=P({...Q,props:{type:{},independentMetadata:{type:Boolean}},setup(n){const c=n,I=T(),l=G(),h=Y(),s=k(()=>c.type==="device"?"device/Instance":"device/Product"),p=_(!1),m=_(!1),g=_("properties");V("_metadataType",c.type);const B=k(()=>{if(c.type==="device"&&l.current.productMetadata){const e=JSON.parse(l.current.productMetadata||"{}"),t=JSON.parse(l.current.metadata||"{}");return!K(t,e)}return!1}),E=()=>{const{id:e}=I.params,t=R(e);return t.then(f=>{f.status===200&&(U.info("操作成功"),l.refresh(e).then(()=>{h.set("importMetadata",!0)}))}),t},N=e=>{O.emit("MetadataTabs",()=>{g.value=e})};return(e,t)=>{const f=Z,d=q,$=A;return v(),j("div",F,[o($,{class:"metadataNav",activeKey:a(g),destroyInactiveTabPane:"",type:"card",onChange:N},{rightExtra:r(()=>[o(f,null,{default:r(()=>[a(B)?(v(),C(b,{key:"reload",hasPermission:`${a(s)}:update`,popConfirm:{title:"确认重置？",onConfirm:E},tooltip:{title:"重置后将使用产品的物模型配置"}},{default:r(()=>[y(" 重置操作 ")]),_:1},8,["hasPermission","popConfirm"])):M("",!0),o(b,{hasPermission:`${a(s)}:update`,onClick:t[0]||(t[0]=i=>p.value=!0),key:"import"},{default:r(()=>[y("快速导入")]),_:1},8,["hasPermission"]),o(b,{hasPermission:`${a(s)}:update`,onClick:t[1]||(t[1]=i=>m.value=!0),key:"tsl"},{default:r(()=>[y("物模型TSL")]),_:1},8,["hasPermission"])]),_:1})]),centerExtra:r(()=>[H]),default:r(()=>[o(d,{tab:"属性定义",key:"properties"},{default:r(()=>[o(u,{target:e.type,type:"properties",permission:a(s)},null,8,["target","permission"])]),_:1}),o(d,{tab:"功能定义",key:"functions"},{default:r(()=>[o(u,{target:e.type,type:"functions",permission:a(s)},null,8,["target","permission"])]),_:1}),o(d,{tab:"事件定义",key:"events"},{default:r(()=>[o(u,{target:e.type,type:"events",permission:a(s)},null,8,["target","permission"])]),_:1}),o(d,{tab:"标签定义",key:"tags"},{default:r(()=>[o(u,{target:e.type,type:"tags",permission:a(s)},null,8,["target","permission"])]),_:1})]),_:1},8,["activeKey"]),a(p)?(v(),C(L,{key:0,visible:a(p),"onUpdate:visible":t[2]||(t[2]=i=>S(p)?p.value=i:null),type:e.type,onClose:t[3]||(t[3]=i=>p.value=!1)},null,8,["visible","type"])):M("",!0),o(X,{visible:a(m),"onUpdate:visible":t[4]||(t[4]=i=>S(m)?m.value=i:null),onClose:t[5]||(t[5]=i=>m.value=!1),type:e.type},null,8,["visible","type"])])}}});const fe=D(W,[["__scopeId","data-v-40826b80"]]);export{fe as default};
