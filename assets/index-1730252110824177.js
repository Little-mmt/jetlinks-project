import{d as O,ad as E,ac as z,k as x,w as Z,ab as q,U as u,V as g,X as t,f as e,u as a,E as d,Z as w,F as $,Y as f,B as L,af as X,ag as Y,_ as y}from"./vue-1730252110824.js";import{o as G,I as K,v as W,a0 as ee,a6 as te,w as ae,$ as ne,a7 as oe,C as le,a1 as re,d as ie,F as se,aI as ue,g as de}from"./index-1730252110824.js";import"./index-1730252110824288.js";import"./index-1730252110824280.js";import{s as pe,u as ce,q as me,a as fe}from"./stream-1730252110824.js";import{t as ge}from"./validate-1730252110824.js";import"./regular-1730252110824.js";const R=k=>(X("data-v-71500a40"),k=k(),Y(),k),_e=R(()=>y("div",{class:"form-label"},null,-1)),Pe={key:2,class:"form-item-checked"},ye=R(()=>y("div",{class:"form-label"},null,-1)),Re=R(()=>y("div",{class:"form-label"},null,-1)),ve={key:1,style:{width:"100%",display:"flex"}},Ie=R(()=>y("div",{class:"form-label"},null,-1)),xe=R(()=>y("div",{class:"form-label"},null,-1)),ke={key:2,class:"form-item-checked"},we=R(()=>y("div",{class:"form-label"},null,-1)),be=R(()=>y("div",{class:"form-label"},null,-1)),he=O({name:"StreamDetail"}),Te=O({...he,setup(k){const H=E(),U=z(),Q=U.query.view,b=U.params.id,C=x(),I=x(!1),j=x([]),p=x(!1),B={regDomain:new RegExp(/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i),regOnlyNumber:new RegExp(/^\d+$/)},h=(c,n)=>new Promise(async(s,i)=>ge(n)||B.regDomain.test(n)?s(""):n?i("请输入正确的IP地址或者域名"):s("")),o=x({name:"",provider:void 0,configuration:{secret:"",apiHost:"",apiPort:"",rtpIp:"",rtpPort:"",rtspPort:"",rtmpPort:"",dynamicRtpPort:!1,dynamicRtpPortRange0:"",dynamicRtpPortRange1:""}}),F=async()=>{var r;let c=await((r=C.value)==null?void 0:r.validate()),n={...c};const{configuration:s}=c;if(s.dynamicRtpPort){const{dynamicRtpPortRange0:v,dynamicRtpPortRange1:T}=s;delete s.dynamicRtpPortRange0,delete s.dynamicRtpPortRange1,n.configuration={...s,dynamicRtpPortRange:[v,T]}}I.value=!0,(b===":id"?await pe(n):await ce({...n,id:b})).status===200&&(G("操作成功","success"),H.push("/iot/link/Stream")),I.value=!1};return(async c=>{I.value=!0;const n=await me();if(j.value=n.result.map(s=>({value:s.id,label:s.name})),c!==":id"){const s=await fe(c);if(s.success){const i=s.result;o.value={...i};const{configuration:r}=i;if(r.dynamicRtpPort){const{dynamicRtpPortRange:v}=r;delete r.dynamicRtpPortRange,o.value.configuration={...r,dynamicRtpPortRange0:v[0],dynamicRtpPortRange1:v[1]}}}}I.value=!1})(b),Z(()=>o.value.configuration.dynamicRtpPort,c=>{p.value=c},{deep:!0,immediate:!0}),(c,n)=>{const s=K,i=W,r=ee,v=te,T=ae,_=q("AIcon"),P=ne,m=oe,S=le,A=re,M=ie,N=se,V=ue,D=q("FullPage"),J=q("page-container");return u(),g(J,null,{default:t(()=>[e(D,null,{default:t(()=>[e(V,null,{default:t(()=>[e(N,{ref_key:"formRef",ref:C,class:"form",layout:"vertical",model:a(o),name:"basic",autocomplete:"off"},{default:t(()=>[e(A,{gutter:[16,0]},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(i,{label:"流媒体名称",name:"name",rules:[{required:!0,message:"请输入流媒体名称"},{max:64,message:"最多可输入64个字符"}]},{default:t(()=>[e(s,{value:a(o).name,"onUpdate:value":n[0]||(n[0]=l=>a(o).name=l),placeholder:"请输入流媒体名称"},null,8,["value"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(i,{label:"服务商",name:"provider",rules:[{required:!0,message:"请选择服务商"}]},{default:t(()=>[e(v,{ref:"select",value:a(o).provider,"onUpdate:value":n[1]||(n[1]=l=>a(o).provider=l),options:a(j),placeholder:"请选择服务商"},null,8,["value","options"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(i,{label:"密钥",name:["configuration","secret"],rules:[{max:64,message:"最多可输入64个字符"}]},{default:t(()=>[e(T,{placeholder:"请输入密钥",value:a(o).configuration.secret,"onUpdate:value":n[2]||(n[2]=l=>a(o).configuration.secret=l)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:8,class:"form-item"},{default:t(()=>[e(i,{name:["configuration","apiHost"],rules:[{required:!0,message:"请输入API Host"},{validator:h,message:"请输入正确的IP地址或者域名"}]},{label:t(()=>[d(" API Host "),e(P,{title:"调用流媒体接口时请求的服务地址"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(s,{placeholder:"请输入API Host",value:a(o).configuration.apiHost,"onUpdate:value":n[3]||(n[3]=l=>a(o).configuration.apiHost=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),e(r,{span:4},{default:t(()=>[e(i,{class:"form-item",name:["configuration","apiPort"],rules:[{required:!0,message:"请输入端口"}]},{default:t(()=>[_e,e(m,{style:{width:"100%"},min:1,max:65535,precision:0,placeholder:"请输入输入端口",value:a(o).configuration.apiPort,"onUpdate:value":n[4]||(n[4]=l=>a(o).configuration.apiPort=l)},null,8,["value"])]),_:1})]),_:1}),a(o).provider==="embedded-zlmedia"?(u(),w($,{key:0},[e(r,{span:24},{default:t(()=>[e(i,{name:["configuration","rtpIp"],rules:[{required:!0,message:"请输入IP"},{validator:h,message:"请输入正确的IP地址或者域名"}]},{label:t(()=>[d(" IP "),e(P,{title:"视频设备将流推送到该IP地址下，部分设备仅支持IP地址，建议全是用IP地址"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(s,{placeholder:"请输入IP",style:{width:"50%"},value:a(o).configuration.rtpIp,"onUpdate:value":n[5]||(n[5]=l=>a(o).configuration.rtpIp=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),e(r,{span:12,class:"item"},{default:t(()=>[e(A,{gutter:[16,0]},{default:t(()=>[a(p)?f("",!0):(u(),g(r,{key:0,span:20},{default:t(()=>[e(i,{class:"form-item",name:["configuration","rtpPort"],rules:[{required:!0,message:"请输入RTP端口"}]},{label:t(()=>[d(" RTP 端口 "),e(P,{title:"视频设备将流推送到该IP地址对应的RTP端口下，部分设备仅支持IP地址，建议全是用IP地址"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(m,{style:{width:"100%"},min:1,max:65535,precision:0,placeholder:"请输入RTP端口",value:a(o).configuration.rtpPort,"onUpdate:value":n[6]||(n[6]=l=>a(o).configuration.rtpPort=l)},null,8,["value"])]),_:1})]),_:1})),a(p)?(u(),g(r,{key:1,span:8},{default:t(()=>[e(i,{class:"form-item",name:["configuration","dynamicRtpPortRange0"],rules:[{required:!0,message:"请输入起始端口"}]},{label:t(()=>[d(" RTP 端口 "),e(P,{title:"视频设备将流推送到该IP地址对应的RTP端口下，部分设备仅支持IP地址，建议全是用IP地址"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(m,{style:{width:"100%"},min:1,max:a(o).configuration.dynamicRtpPortRange1||65535,precision:0,placeholder:"起始端口",value:a(o).configuration.dynamicRtpPortRange0,"onUpdate:value":n[7]||(n[7]=l=>a(o).configuration.dynamicRtpPortRange0=l)},null,8,["max","value"])]),_:1})]),_:1})):f("",!0),a(p)?(u(),w("div",Pe," 至 ")):f("",!0),a(p)?(u(),g(r,{key:3,span:8},{default:t(()=>[e(i,{class:"form-item",name:["configuration","dynamicRtpPortRange1"],rules:[{required:!0,message:"请输入终止端口"}]},{default:t(()=>[ye,e(m,{style:{width:"100%"},min:a(o).configuration.dynamicRtpPortRange0||1,max:65535,precision:0,placeholder:"终止端口",value:a(o).configuration.dynamicRtpPortRange1,"onUpdate:value":n[8]||(n[8]=l=>a(o).configuration.dynamicRtpPortRange1=l)},null,8,["min","value"])]),_:1})]),_:1})):f("",!0),e(r,{span:4},{default:t(()=>[e(i,{class:"form-item-checked2",name:["configuration","dynamicRtpPort"]},{default:t(()=>[Re,e(S,{checked:a(o).configuration.dynamicRtpPort,"onUpdate:checked":n[9]||(n[9]=l=>a(o).configuration.dynamicRtpPort=l)},{default:t(()=>[d(" 动态端口 ")]),_:1},8,["checked"])]),_:1})]),_:1}),e(r,{span:24},{default:t(()=>[e(i,{class:"form-item",name:["configuration","rtmpPort"],rules:[{required:!0,message:"请输入RTMP端口"}]},{label:t(()=>[d(" RTMP 端口 "),e(P,{title:"对外分享的RTMP视频流地址对应端口"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(m,{style:{width:"100%"},min:1,max:65535,precision:0,placeholder:"RTMP 端口",value:a(o).configuration.rtmpPort,"onUpdate:value":n[10]||(n[10]=l=>a(o).configuration.rtmpPort=l)},null,8,["value"])]),_:1})]),_:1}),e(r,{span:24},{default:t(()=>[e(i,{name:["configuration","rtspPort"],rules:[{required:!0,message:"请输入RTSP端口"}]},{label:t(()=>[d(" RTSP 端口 "),e(P,{title:"对外分享的RTSP视频流地址对应端口"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(m,{style:{width:"100%"},min:1,max:65535,precision:0,placeholder:"RTSP 端口",value:a(o).configuration.rtspPort,"onUpdate:value":n[11]||(n[11]=l=>a(o).configuration.rtspPort=l)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})],64)):(u(),w("div",ve,[e(r,{span:8,class:"form-item"},{default:t(()=>[e(i,{name:["configuration","rtpIp"],rules:[{required:!0,message:"请输入RTP IP"},{validator:h,message:"请输入正确的IP地址或者域名"}]},{label:t(()=>[d(" RTP IP "),e(P,{title:"视频设备将流推送到该IP地址下，部分设备仅支持IP地址，建议全是用IP地址"},{default:t(()=>[e(_,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})]),default:t(()=>[e(s,{placeholder:"请输入RTP IP",value:a(o).configuration.rtpIp,"onUpdate:value":n[12]||(n[12]=l=>a(o).configuration.rtpIp=l)},null,8,["value"])]),_:1},8,["rules"])]),_:1}),a(p)?f("",!0):(u(),g(r,{key:0,span:4},{default:t(()=>[e(i,{class:"form-item",name:["configuration","rtpPort"],rules:[{required:!0,message:"请输入端口"}]},{default:t(()=>[Ie,e(m,{style:{width:"100%"},min:1,max:65535,precision:0,placeholder:"请输入端口",value:a(o).configuration.rtpPort,"onUpdate:value":n[13]||(n[13]=l=>a(o).configuration.rtpPort=l)},null,8,["value"])]),_:1})]),_:1})),a(p)?(u(),g(r,{key:1,span:4},{default:t(()=>[e(i,{class:"form-item",name:["configuration","dynamicRtpPortRange0"],rules:[{required:!0,message:"请输入起始端口"}]},{default:t(()=>[xe,e(m,{style:{width:"100%"},min:1,max:a(o).configuration.dynamicRtpPortRange1||65535,precision:0,placeholder:"起始端口",value:a(o).configuration.dynamicRtpPortRange0,"onUpdate:value":n[14]||(n[14]=l=>a(o).configuration.dynamicRtpPortRange0=l)},null,8,["max","value"])]),_:1})]),_:1})):f("",!0),a(p)?(u(),w("div",ke," 至 ")):f("",!0),a(p)?(u(),g(r,{key:3,span:4},{default:t(()=>[e(i,{class:"form-item",name:["configuration","dynamicRtpPortRange1"],rules:[{required:!0,message:"请输入终止端口"}]},{default:t(()=>[we,e(m,{style:{width:"100%"},min:a(o).configuration.dynamicRtpPortRange0||1,max:65535,precision:0,placeholder:"终止端口",value:a(o).configuration.dynamicRtpPortRange1,"onUpdate:value":n[15]||(n[15]=l=>a(o).configuration.dynamicRtpPortRange1=l)},null,8,["min","value"])]),_:1})]),_:1})):f("",!0),e(r,{span:4},{default:t(()=>[e(i,{class:"form-item-checked2",name:["configuration","dynamicRtpPort"]},{default:t(()=>[be,e(S,{checked:a(o).configuration.dynamicRtpPort,"onUpdate:checked":n[16]||(n[16]=l=>a(o).configuration.dynamicRtpPort=l)},{default:t(()=>[d(" 动态端口 ")]),_:1},8,["checked"])]),_:1})]),_:1})])),e(r,{span:24},{default:t(()=>[e(i,null,{default:t(()=>[a(Q)==="false"?(u(),g(M,{key:0,"html-type":"submit",type:"primary",onClick:L(F,["prevent"]),loading:a(I)},{default:t(()=>[d("保存")]),_:1},8,["onClick","loading"])):f("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}});const Qe=de(Te,[["__scopeId","data-v-71500a40"]]);export{Qe as default};
