import{X as F,Z as N,e as D,a3 as J,g as K}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{a as E}from"./scene-1730252110824.js";import{q as X}from"./configuration-1730252110824.js";import{d as Z,ac as j,ai as H,r as O,k as y,ab as b,U as d,Z as U,f as n,X as o,u as a,E as Y,V as h,Y as S,F as $,af as z,ag as G,_ as L}from"./vue-1730252110824.js";import Q from"./index-1730252110824200.js";import{u as W}from"./alarm-1730252110824.js";import ee from"./SceneDrawer-1730252110824.js";import ae from"./CardBox-17302521108242.js";import{u as te}from"./useRequest-1730252110824.js";import"./Title-17302521108242.js";import"./Title-1730252110824.js";import"./AddButton-1730252110824.js";import"./BranchesTabs-17302521108242.js";import"./index-1730252110824295.js";import"./Terms-1730252110824.js";import"./WhenItem-1730252110824.js";import"./utils-17302521108243.js";import"./Actions-17302521108242.js";import"./util-1730252110824.js";import"./config-17302521108242.js";import"./util-17302521108242.js";import"./scene-17302521108242.js";import"./util-17302521108243.js";import"./tags-1730252110824.js";import"./index-1730252110824299.js";import"./index-1730252110824284.js";const oe=c=>(z("data-v-bb60373e"),c=c(),G(),c),se=oe(()=>L("div",{class:"scene-view"}," 查看详情 ",-1)),re=Z({__name:"index",setup(c){var p;F();const i=(p=j().query)==null?void 0:p.id,C=W(),{configurationData:g}=H(C),s=O({visible:!1,detail:void 0}),m=y(),{data:I,reload:T}=te(X,{defaultParams:{terms:[{column:"alarmId",value:i}]},onSuccess(e){return e.result.data.reduce((r,t)=>(r[t.ruleId]?r[t.ruleId].push(t.branchIndex):r[t.ruleId]=[t.branchIndex],r),{})||{}},defaultValue:{}}),k=e=>E(e),u=y(!1),w=()=>{u.value=!0},x=()=>{u.value=!1},B=()=>{u.value=!1,m.value.reload(),T()},q=e=>{s.detail=e,s.visible=!0},P=()=>{var e;s.visible=!1,s.detail=void 0,(e=m.value)==null||e.reload()};return(e,R)=>{var f;const r=b("AIcon"),t=N,V=D,A=J,M=b("FullPage");return d(),U($,null,[n(M,null,{default:o(()=>[n(A,{model:"CARD",request:k,gridColumns:[1,2,3],defaultParams:{sorts:[{name:"createTime",order:"desc"}],terms:[{terms:[{column:"id",termType:"alarm-bind-rule",value:a(i)}],type:"and"}]},ref_key:"actionRef",ref:m},{headerTitle:o(()=>[n(V,null,{default:o(()=>[n(t,{type:"primary",onClick:w,hasPermission:"rule-engine/Alarm/Configuration:add"},{icon:o(()=>[n(r,{type:"PlusOutlined"})]),default:o(()=>[Y(" 新增 ")]),_:1})]),_:1})]),card:o(l=>{var _,v;return[n(ae,{value:l,status:(_=l.state)==null?void 0:_.value,statusText:(v=l.state)==null?void 0:v.text,alarmId:a(i),activeKeys:a(I)[l.id],showMask:!1,showBranches:!1,showBindTags:!0,showRule:!1,showHistory:!1,onClick:ie=>q(l)},{default:o(()=>[se]),_:2},1032,["value","status","statusText","alarmId","activeKeys","onClick"])]}),_:1},8,["defaultParams"])]),_:1}),a(u)?(d(),h(Q,{key:0,id:a(i),type:(f=a(g).current)==null?void 0:f.targetType,onCloseSave:x,onSaveScene:B},null,8,["id","type"])):S("",!0),a(s).visible?(d(),h(ee,{key:1,detail:a(s).detail,id:a(i),onCancel:P},null,8,["detail","id"])):S("",!0)],64)}}});const Ee=K(re,[["__scopeId","data-v-bb60373e"]]);export{Ee as default};
