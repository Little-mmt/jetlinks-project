import{eP as F,o as I,dv as L,dw as B,v as J,F as M,aa as O}from"./index-1730252110824.js";import"./index-1730252110824283.js";import{u as P}from"./instance-1730252110824.js";import{d as U,k as w,r as q,e as N,U as X,V as $,X as g,f as v,u as c,J as z}from"./vue-1730252110824.js";const H=U({__name:"Save",props:{data:{type:Object,default:()=>{}}},emits:["close"],setup(d,{emit:b}){const e=d,V=w(!1),h=P(),T=w(),m=q({propertyValue:void 0}),j=()=>{b("close")},C=N(()=>{var a,t,o,f,i,y,s,r,u,p,_,x,k;const l=((t=(a=e.data)==null?void 0:a.valueType)==null?void 0:t.type)||((o=e.data)==null?void 0:o.dataType);if(l==="enum")return(((i=(f=e.data)==null?void 0:f.valueType)==null?void 0:i.elements)||[]).map(n=>({label:n==null?void 0:n.text,value:n==null?void 0:n.value}));if(l==="boolean")return[{label:(s=(y=e.data)==null?void 0:y.valueType)==null?void 0:s.falseText,value:(u=(r=e.data)==null?void 0:r.valueType)==null?void 0:u.falseValue},{label:(_=(p=e.data)==null?void 0:p.valueType)==null?void 0:_.trueText,value:(k=(x=e.data)==null?void 0:x.valueType)==null?void 0:k.trueValue}]}),R={propertyValue:[{required:!0,message:"该字段是必填字段"}]},S=()=>{T.value.validate().then(async()=>{var a,t,o;V.value=!0,(await F(((a=h.current)==null?void 0:a.id)||"",{[(t=e.data)==null?void 0:t.id]:(o=z(m))==null?void 0:o.propertyValue}).finally(()=>{V.value=!1})).status===200&&(I("操作成功！"),b("close"),T.value.resetFields())}).catch(l=>{console.log("error",l)})};return(l,a)=>{const t=L,o=B,f=J,i=M,y=O;return X(),$(y,{maskClosable:!1,visible:!0,title:"编辑",onOk:S,onCancel:j,confirmLoading:c(V)},{default:g(()=>[v(t,{message:"当数据来源为设备时，填写的值将下发到设备",type:"warning",showIcon:""}),v(i,{rules:R,layout:"vertical",ref_key:"formRef",ref:T,model:c(m),style:{"margin-top":"20px"}},{default:g(()=>{var s;return[v(f,{name:"propertyValue",label:((s=d.data)==null?void 0:s.name)||"自定义属性"},{default:g(()=>{var r,u,p;return[v(o,{modelValue:c(m).propertyValue,"onUpdate:modelValue":a[0]||(a[0]=_=>c(m).propertyValue=_),itemType:((u=(r=d.data)==null?void 0:r.valueType)==null?void 0:u.type)||((p=d.data)==null?void 0:p.dataType),options:c(C)},null,8,["modelValue","itemType","options"])]}),_:1},8,["label"])]}),_:1},8,["model"])]),_:1},8,["confirmLoading"])}}});export{H as _};
