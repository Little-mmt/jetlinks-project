import{Z as J,e as L,a3 as V,o as b,g as N}from"./index-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import{q as U,d as Z}from"./category-1731638920964.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_name_modifyModal_lang-1731638920964.js";import{d as w,k as o,r as P,q as v,H as z,ab as f,U as x,V as R,X as s,f as a,u as e,G,E as H,Z as M,F as X,a1 as $}from"./vue-1731638920964.js";const Q=w({name:"Category"}),W=w({...Q,setup(Y){const l=o([]),_=o({}),d=o();o([]);const p=o({}),u=o(""),r=o(0),i=o(0),T=o(!1),k=o(),S=P({columns:[{title:"名称",dataIndex:"name",key:"name",search:{type:"string"}},{title:"排序",dataIndex:"sortIndex",key:"sortIndex",search:{type:"number",componentProps:{precision:0,min:1}},scopedSlots:!0},{title:"说明",key:"description",dataIndex:"description",search:{type:"string"}},{title:"操作",key:"action",fixed:"right",width:250,scopedSlots:!0}]});let g=o();const A=t=>{g.value=t,l.value=[]},q=(t,y)=>t?[{key:"update",text:"编辑",tooltip:{title:"编辑"},icon:"EditOutlined",onClick:async()=>{u.value="编辑分类",r.value=2,p.value=t,v(()=>{d.value.show(t)})}},{key:"add",text:"添加子分类",tooltip:{title:"添加子分类"},icon:"PlusCircleOutlined",onClick:()=>{u.value="新增子分类",r.value=0,p.value={},t.children&&t.children.length>0?i.value=1:i.value=2,v(()=>{d.value.show(t),k.value=t.id})}},{key:"delete",text:"删除",tooltip:{title:"删除"},popConfirm:{title:"确认删除?",okText:" 确定",cancelText:"取消",onConfirm:()=>{const c=Z(t.id);return c.then(m=>{m.status===200?(b("操作成功！"),_.value.reload()):b("操作失败！","error")}),c}},icon:"DeleteOutlined"}]:[],C=P({columns:[{title:"名称",dataIndex:"name",key:"name",ellipsis:!0,width:500},{title:"排序",dataIndex:"sortIndex",key:"sortIndex",scopedSlots:!0,width:100},{title:"说明",dataIndex:"description",key:"description",ellipsis:!0},{title:"操作",key:"action",fixed:"right",ellipsis:!0,scopedSlots:!0,width:120}],add:async()=>{u.value="新增分类",r.value=0,i.value=3,v(()=>{d.value.show(p.value)})},refresh:()=>{r.value===0&&i.value!==3&&l.value.push(k.value),console.log(l.value),_.value.reload()}}),{add:B,columns:ee,refresh:E}=z(C);return(t,y)=>{const I=f("pro-search"),c=f("AIcon"),m=J,F=L,K=V,O=f("FullPage"),D=f("page-container");return x(),R(D,null,{default:s(()=>[a(I,{columns:e(S).columns,target:"category",onSearch:A},null,8,["columns"]),a(O,null,{default:s(()=>[a(K,{ref_key:"tableRef",ref:_,columns:e(C).columns,request:e(U),model:"TABLE",type:"TREE",expandedRowKeys:e(l),"onUpdate:expandedRowKeys":y[0]||(y[0]=h=>G(l)?l.value=h:null),scroll:{y:550},defaultParams:{paging:!1,sorts:[{name:"sortIndex",order:"asc"},{name:"createTime",order:"desc"}]},params:e(g),loading:e(T)},{headerTitle:s(()=>[a(m,{type:"primary",onClick:e(B),hasPermission:"device/Category:add"},{icon:s(()=>[a(c,{type:"PlusOutlined"})]),default:s(()=>[H(" 新增 ")]),_:1},8,["onClick"])]),action:s(h=>[a(F,{size:16},{default:s(()=>[(x(!0),M(X,null,$(q(h,"table"),n=>(x(),R(m,{key:n.key,disabled:n.disabled,popConfirm:n.popConfirm,hasPermission:"device/Category:"+n.key,tooltip:{...n.tooltip},onClick:n.onClick,type:"link",style:{padding:"0px"},danger:n.key==="delete"},{icon:s(()=>[a(c,{type:n.icon},null,8,["type"])]),_:2},1032,["disabled","popConfirm","hasPermission","tooltip","onClick","danger"]))),128))]),_:2},1024)]),_:1},8,["columns","request","expandedRowKeys","params","loading"])]),_:1}),a(j,{ref_key:"modifyRef",ref:d,formData:e(p),title:e(u),isAdd:e(r),isChild:e(i),onRefresh:e(E)},null,8,["formData","title","isAdd","isChild","onRefresh"])]),_:1})}}});const pe=N(W,[["__scopeId","data-v-deb1660e"]]);export{pe as default};
