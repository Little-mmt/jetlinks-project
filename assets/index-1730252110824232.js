import{X as oe,g7 as V,go as ne,Z as O,h as le,ax as ae,gp as ie,o as q,gq as re,a0 as pe,a1 as de,d as ce,$ as ue,aL as _e,aM as me,aN as fe,a2 as ye,e as ve,a3 as ge,g as he}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{_ as be}from"./MenuDialog.vue_vue_type_script_setup_true_lang-1730252110824.js";import ke from"./ThirdMenu-1730252110824.js";import xe from"./Add-1730252110824.js";import{d as U,k as m,o as Ce,ab as C,U as p,V as v,X as s,_,f as n,u as d,E as A,W as J,R as Ae,$ as h,Z as M,F as D,a1 as F,Y as j,G as Se,af as $e,ag as Ie}from"./vue-1730252110824.js";import"./ChooseIconDialog-1730252110824.js";import"./index-1730252110824229.js";import"./MUpload-1730252110824.js";const z=S=>($e("data-v-36b86027"),S=S(),Ie(),S),Pe={class:"apply-container"},je={style:{display:"flex","align-items":"center"}},we={style:{margin:"0 0 0 30px",color:"#0000008c"}},Te=["src"],Oe=z(()=>_("div",{class:"card-item-content-text"}," 类型 ",-1)),Me=z(()=>_("div",{class:"card-item-content-text"}," 说明 ",-1)),Re={key:0},Be={class:"dialogs"},Ee=U({name:"Apply"}),Le=U({...Ee,setup(S){const $=oe(),c="system/Apply",R=m([]),w=m(!1);m(!1);const B=[{title:"名称",dataIndex:"name",key:"name",ellipsis:!0,search:{type:"string"}},{title:"类型",dataIndex:"provider",key:"provider",ellipsis:!0,search:{type:"select",options:()=>new Promise(e=>{V().then(t=>{e(t.result.map(o=>({label:o.name,value:o.provider})))})})},scopedSlots:!0},{title:"状态",dataIndex:"status",key:"status",ellipsis:!0,search:{rename:"state",type:"select",options:[{label:"正常",value:"enabled"},{label:"禁用",value:"disabled"}]},scopedSlots:!0},{title:"说明",dataIndex:"description",key:"description",ellipsis:!0,search:{type:"string"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:!0,width:"200px",fixed:"right"}],T=m({}),E=m(),b=m({}),r={refresh:()=>{E.value.reload(T.value)},toAdd:()=>{w.value=!0},toSave:(e,t=!1)=>{e?$.jumpPage("system/Apply/Save",{},{id:e,view:t}):$.jumpPage("system/Apply/Save")},changeStatus:e=>{const t=e.state.value==="enabled"?"disabled":"enabled",o=ie(e.id,{state:t});return o.then(a=>{a.status===200&&(q("操作成功"),r.refresh())}),o},clickDel:e=>{const t=re(e.id);return t.then(o=>{o.status===200&&(q("操作成功"),r.refresh())}),t},getActions:(e,t)=>{var I,x;if(!e)return[];const o=e.state.value==="enabled",a=[{permission:`${c}:update`,key:"edit",text:"编辑",tooltip:{title:"编辑"},icon:"EditOutlined",onClick:()=>r.toSave(e.id)},{permission:`${c}:action`,key:"action",text:o?"禁用":"启用",tooltip:{title:o?"禁用":"启用"},popConfirm:{title:`确认${o?"禁用":"启用"}`,onConfirm:()=>r.changeStatus(e)},icon:o?"StopOutlined":"PlayCircleOutlined"},{permission:`${c}:delete`,key:"delete",text:"删除",tooltip:{title:o?"请先禁用再删除":"删除"},popConfirm:{title:"确认删除?",onConfirm:()=>r.clickDel(e)},disabled:o,icon:"DeleteOutlined"}],k=e.integrationModes.map(P=>P.value),y={key:"others",text:"其他",icon:"EllipsisOutlined",children:[]};return k.includes("page")&&((I=y.children)==null||I.push({permission:[`${c}:add`,`${c}:update`],key:"page",text:"集成菜单",tooltip:{title:o?"集成菜单":"请先启用"},icon:"MenuUnfoldOutlined",disabled:!o,onClick:()=>{X.value=e.id,Z.value=e.provider,b.value=e,f.value=!0}})),k.includes("apiServer")&&((x=y.children)==null||x.push({permission:[`${c}:add`,`${c}:update`],key:"empowerment",text:"赋权",tooltip:{title:"赋权"},icon:"icon-fuquan",onClick:()=>{$.jumpPage("system/Apply/Api",{},{code:e.id})}},{permission:[`${c}:add`,`${c}:update`],key:"viewApi",text:"查看API",tooltip:{title:"查看API"},icon:"icon-chakanAPI",onClick:()=>{$.jumpPage("system/Apply/View",{},{code:e.id})}})),y.children.length>0&&(t==="card"?a.splice(a.length-1,0,y):a.splice(a.length-1,0,...y.children)),a},getTypeLabel:e=>{var t,o;return e?(o=(t=R.value)==null?void 0:t.find(a=>(a==null?void 0:a.value)===e))==null?void 0:o.label:""}},f=m(!1),X=m(""),Z=m("");return Ce(()=>{V().then(e=>{if(e.status===200){const t=e.result.map(o=>({label:o.name,value:o.provider}));R.value=t}})}),(e,t)=>{const o=C("pro-search"),a=C("AIcon"),k=C("Ellipsis"),y=pe,I=de,x=ce,P=ue,G=_e,W=me,Y=fe,H=ye,K=ve,Q=ge,ee=C("FullPage"),te=C("page-container");return p(),v(te,null,{default:s(()=>[_("div",Pe,[n(o,{columns:B,target:"system-apply",onSearch:t[0]||(t[0]=l=>T.value={...l})}),n(ee,null,{default:s(()=>[n(Q,{ref_key:"tableRef",ref:E,columns:B,request:d(ne),defaultParams:{sorts:[{name:"createTime",order:"desc"}]},params:d(T),gridColumn:3},{headerTitle:s(()=>[_("div",je,[n(O,{hasPermission:`${c}:add`,type:"primary",onClick:t[1]||(t[1]=()=>r.toAdd())},{default:s(()=>[n(a,{type:"PlusOutlined"}),A("新增 ")]),_:1},8,["hasPermission"]),_("p",we,[n(a,{type:"ExclamationCircleOutlined",style:{"margin-right":"12px"}}),A(" 应用管理将多个应用系统的登录简化为一次登录，实现多处访问、集中管控的业务场景。 ")])])]),card:s(l=>{var u,L;return[n(H,J({value:l,actions:r.getActions(l,"card")},l,{status:(u=l.state)==null?void 0:u.value,statusText:(L=l.state)==null?void 0:L.text,statusNames:{enabled:"processing",disabled:"error"}}),{img:s(()=>[Ae(e.$slots,"img",{},()=>[_("img",{src:d(le)("/apply.png")},null,8,Te)],!0)]),content:s(()=>[n(k,{style:{width:"calc(100% - 100px)","font-size":"16px",color:"rgb(49, 94, 251)","font-weight":"700","margin-bottom":"8px"}},{default:s(()=>[A(h(l.name),1)]),_:2},1024),n(I,null,{default:s(()=>[n(y,{span:12},{default:s(()=>[Oe,_("div",null,h(r.getTypeLabel(l.provider)),1)]),_:2},1024),n(y,{span:12},{default:s(()=>[Me,n(k,null,{default:s(()=>[A(h(l.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),actions:s(i=>[n(P,J(i.tooltip,{title:i.disabled&&i.tooltip.title}),{default:s(()=>[i.key==="others"?(p(),v(Y,{key:0,placement:"bottomRight"},{overlay:s(()=>[n(W,null,{default:s(()=>[(p(!0),M(D,null,F(i.children,(g,se)=>(p(),v(G,{key:se},{default:s(()=>{var N;return[n(P,{title:(N=g==null?void 0:g.tooltip)==null?void 0:N.title},{default:s(()=>[n(x,{type:"link",onClick:g.onClick,disabled:g.disabled},{default:s(()=>[n(a,{type:g.icon},null,8,["type"]),_("span",null,h(g.text),1)]),_:2},1032,["onClick","disabled"])]),_:2},1032,["title"])]}),_:2},1024))),128))]),_:2},1024)]),default:s(()=>[n(x,null,{default:s(()=>[n(a,{type:i.icon},null,8,["type"]),_("span",null,h(i.text),1)]),_:2},1024)]),_:2},1024)):(p(),v(O,{key:1,hasPermission:i.permission,tooltip:i.tooltip,"pop-confirm":i.popConfirm,onClick:i.onClick,disabled:i.disabled},{default:s(()=>[n(a,{type:i.icon},null,8,["type"]),i.key!=="delete"?(p(),M("span",Re,h(i.text),1)):j("",!0)]),_:2},1032,["hasPermission","tooltip","pop-confirm","onClick","disabled"]))]),_:2},1040,["title"])]),_:2},1040,["value","actions","status","statusText"])]}),provider:s(l=>[A(h(r.getTypeLabel(l.provider)),1)]),status:s(l=>[n(ae,{status:l.state.value,text:l.state.text,statusNames:{enabled:"processing",disabled:"error"}},null,8,["status","text"])]),action:s(l=>[n(K,{size:16},{default:s(()=>[(p(!0),M(D,null,F(r.getActions(l,"table"),u=>(p(),v(O,{hasPermission:u.permission,type:"link",key:u.key,tooltip:u.tooltip,"pop-confirm":u.popConfirm,onClick:u.onClick,disabled:u.disabled},{default:s(()=>[n(a,{type:u.icon},null,8,["type"])]),_:2},1032,["hasPermission","tooltip","pop-confirm","onClick","disabled"]))),128))]),_:2},1024)]),_:3},8,["request","params"])]),_:3})]),_("div",Be,[d(f)&&d(b).provider!=="third-party"?(p(),v(be,{key:0,visible:d(f),"onUpdate:visible":t[2]||(t[2]=l=>Se(f)?f.value=l:null),mode:"edit",data:d(b),onRefresh:r.refresh},null,8,["visible","data","onRefresh"])):j("",!0),d(f)&&d(b).provider==="third-party"?(p(),v(ke,{key:1,data:d(b),mode:"edit",onCancel:t[3]||(t[3]=l=>f.value=!1),onOk:t[4]||(t[4]=()=>{f.value=!1,r.refresh})},null,8,["data"])):j("",!0)]),d(w)?(p(),v(xe,{key:0,onClose:t[5]||(t[5]=l=>w.value=!1)})):j("",!0)]),_:3})}}});const Ke=he(Le,[["__scopeId","data-v-36b86027"]]);export{Ke as default};
