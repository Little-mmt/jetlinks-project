import{d as I,ac as F,k as _,r as N,ab as L,U as y,V as O,X as l,_ as i,f as n,u as a,E as B,Z as P,$ as b,Y as q,af as A,ag as E}from"./vue-1730252110824.js";import{o as J,$,I as z,v as G,a9 as Q,F as X,aa as Y,g as Z}from"./index-1730252110824.js";import{M as H,R as K,a as W,I as ee}from"./rules-1730252110824.js";import ae from"./UploadFile-17302521108242.js";import{u as te,c as oe,v as ne}from"./plugin-17302521108242.js";const se={deviceGateway:"设备接入网关",thingsManager:"物管理",media:"视频接入网关"},S=s=>(A("data-v-92a53b76"),s=s(),E(),s),le={key:0,class:"file-detail"},ie=S(()=>i("span",null,"插件类型：",-1)),de={class:"file-detail-item"},re=S(()=>i("span",null,"版本：",-1)),ce={class:"file-detail-item"},ue=I({name:"PluginSave"}),pe=I({...ue,props:{data:{type:Object,default:()=>({})}},emits:["cancel","ok"],setup(s,{emit:f}){const o=s,h=F(),p=_();_(o.data.type);const m=_(!1),w=async(r,t)=>{if(!o.data.id&&t){const c=await ne(t);if(c.success&&c.result&&!c.result.passed)return Promise.reject("ID重复")}return Promise.resolve()},x=[K("插件名称"),...W],j=[...ee,{validator:w,trigger:"blur"}],C=[{required:!0,message:"请上传文件",trigger:"blur"}],e=N({id:o.data.id,name:o.data.name,description:o.data.description,type:o.data.type,provider:o.data.provider||"jar",version:o.data.version,filename:o.data.filename,configuration:o.data.configuration||{}}),k=r=>{e.type=r.type.value,e.filename=r.filename,e.configuration.location=r.accessUrl},R=async()=>{if(await p.value.validate()){m.value=!0,e.id=e.id?e.id:null;const t=o.data.id?await te(e).catch(()=>{}):await oe(e).catch(()=>{});if(m.value=!1,t.success){if(J("操作成功！"),h.query.save&&window.onTabSaveSuccess){window.onTabSaveSuccess(t),setTimeout(()=>window.close(),300);return}f("ok"),p.value.resetFields()}}},M=()=>{f("cancel")};return(r,t)=>{var g;const c=L("AIcon"),T=$,v=z,u=G,V=Q,U=X,D=Y;return y(),O(D,{maskClosable:!1,visible:!0,title:(g=s.data)!=null&&g.id?"编辑":"新增",confirmLoading:a(m),onOk:R,onCancel:M,width:"650px"},{default:l(()=>[i("div",null,[n(U,{layout:"vertical",ref_key:"formRef",ref:p,model:a(e)},{default:l(()=>[n(u,{name:"id",rules:j},{label:l(()=>[i("span",null,[B(" 插件ID "),n(T,{title:"若不填写，系统将自动生成唯一ID"},{default:l(()=>[n(c,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:l(()=>[n(v,{placeholder:"请输入插件ID",value:a(e).id,"onUpdate:value":t[0]||(t[0]=d=>a(e).id=d),disabled:!!s.data.id},null,8,["value","disabled"])]),_:1}),n(u,{label:"插件名称",name:"name",rules:x},{default:l(()=>[n(v,{placeholder:"请输入插件名称",value:a(e).name,"onUpdate:value":t[1]||(t[1]=d=>a(e).name=d)},null,8,["value"])]),_:1}),n(u,{label:"文件",name:"version",rules:C},{default:l(()=>[n(ae,{modelValue:a(e).version,"onUpdate:modelValue":t[2]||(t[2]=d=>a(e).version=d),onChange:k,fileName:s.data.filename},null,8,["modelValue","fileName"])]),_:1}),a(e).version?(y(),P("div",le,[i("div",null,[ie,i("span",de,b(a(se)[a(e).type]),1)]),i("div",null,[re,i("span",ce,b(a(e).version),1)])])):q("",!0),n(u,{label:"描述",name:"describe",rules:a(H)},{default:l(()=>[n(V,{value:a(e).description,"onUpdate:value":t[3]||(t[3]=d=>a(e).description=d),placeholder:"请输入说明",showCount:"",maxlength:200},null,8,["value"])]),_:1},8,["rules"])]),_:1},8,["model"])])]),_:1},8,["title","confirmLoading"])}}});const me=Z(pe,[["__scopeId","data-v-92a53b76"]]),be=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{me as S,se as T,be as a};
