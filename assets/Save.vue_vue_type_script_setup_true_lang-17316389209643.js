import{et as S,o as E,eu as B,dw as D,aT as L,aa as N}from"./index-1731638920964.js";import"./index-1731638920964282.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import{u as U}from"./instance-1731638920964.js";import{l as j}from"./lodash.default-1731638920964.js";import{d as M,k as g,s as O,ab as $,U as _,V as d,X as v,f as J,u as k,_ as K,E as X,$ as q}from"./vue-1731638920964.js";const z={style:{width:"280px"}},Z=M({__name:"Save",emits:["close","save"],setup(A,{emit:i}){const w=[{title:"ID",dataIndex:"key",with:"33%"},{title:"名称",dataIndex:"name",with:"33%"},{title:"值",dataIndex:"value",with:"34%"}],f=U(),s=g([]),l=g(!1);O(()=>{var t;const n=((t=f.current)==null?void 0:t.tags)||[];s.value=j.cloneDeep(n)});const V=async()=>{var n;if(s.value.length){l.value=!0;const t=(s.value||[]).filter(a=>(a==null?void 0:a.key)&&(a==null?void 0:a.value)).map(a=>{const{dataType:o,...c}=a;return{...c}});t.length&&(await S(((n=f.current)==null?void 0:n.id)||"",t).catch(()=>{l.value=!1})).status===200&&E("操作成功！");const u=(s.value||[]).filter(a=>(a==null?void 0:a.key)&&!(a!=null&&a.value));u.length&&u.map(async a=>{var o;a.id&&await B(((o=f.current)==null?void 0:o.id)||"",a.id).catch(()=>{l.value=!1})}),setTimeout(()=>{l.value=!1,i("save")},1e3)}else i("close")},b=()=>{i("close")};return(n,t)=>{const u=$("Ellipsis"),a=D,o=L,c=N;return _(),d(c,{title:"编辑标签",width:1e3,visible:!0,confirmLoading:k(l),onOk:V,onCancel:b},{default:v(()=>[J(o,{rowKey:"id",columns:w,"data-source":k(s),bordered:"",pagination:!1},{bodyCell:v(({column:I,text:C,record:e})=>{var y,m,h,T,x;return[K("div",z,[["key","name"].includes(I.dataIndex)?(_(),d(u,{key:0},{default:v(()=>[X(q(C),1)]),_:2},1024)):(_(),d(a,{key:1,modelValue:e.value,"onUpdate:modelValue":p=>e.value=p,itemType:e.type,options:e.type==="enum"?(((y=e==null?void 0:e.dataType)==null?void 0:y.elements)||[]).map(p=>({label:p.text,value:p.value})):e.type==="boolean"?[{label:(m=e==null?void 0:e.dataType)==null?void 0:m.trueText,value:(h=e==null?void 0:e.dataType)==null?void 0:h.trueValue},{label:(T=e==null?void 0:e.dataType)==null?void 0:T.falseText,value:(x=e==null?void 0:e.dataType)==null?void 0:x.falseValue}]:void 0},null,8,["modelValue","onUpdate:modelValue","itemType","options"]))])]}),_:1},8,["data-source"])]),_:1},8,["confirmLoading"])}}});export{Z as _};
