import{g as x,aH as T,J as k,ah as C,ai as D,dB as V,dE as j}from"./index-1731638920964.js";import"./index-1731638920964299.js";import"./index-1731638920964284.js";import{u as q}from"./useRequest-1731638920964.js";import{q as E,b as G,a as N,c as K}from"./configuration-1731638920964.js";import{t as M,h as A}from"./utils-17316389209643.js";import J from"./BranchesTabs-17316389209642.js";import{k as O,e as p,U as m,V as U,X as r,_,f as a,E as f,$ as h,u as d,Z as $,Y as z,d as F}from"./vue-1731638920964.js";import"./index-1731638920964295.js";import"./Terms-1731638920964.js";import"./WhenItem-1731638920964.js";import"./Actions-17316389209642.js";import"./util-1731638920964.js";import"./config-17316389209642.js";import"./util-17316389209642.js";import"./scene-1731638920964.js";import"./scene-17316389209642.js";import"./util-17316389209643.js";const H={class:"scene-warp"},L={class:"branches-warp"},P={key:0,class:"branches-loading"},R=F({name:"SceneDrawer"}),X=Object.assign(R,{props:{id:{type:String,default:void 0},detail:{type:Object,default:()=>({})}},emits:["cancel"],setup(s,{emit:b}){const e=s,i=O(!1),g=p(()=>M.get(e.detail.triggerType)||{}),y=p(()=>{var t;return A(e.detail.branches,((t=e.detail.options)==null?void 0:t.when)||[])}),{data:l}=q(E,{defaultParams:{terms:[{column:"alarmId",value:e.id}]},onSuccess(t){return t.result.data.reduce((n,o)=>(e.detail.id===o.ruleId&&n.push(o.branchIndex),n),[])||[]},defaultValue:[]}),v=()=>{b("cancel")},w=(t,u)=>{i.value=!0,u?G([{alarmId:e.id,ruleId:e.detail.id,branchIndex:t}]).then(n=>{l.value.push(t)}).finally(()=>{i.value=!1}):(t===-1?N(e.id,[e.detail.id]):K(e.detail.id,e.id,[t])).then(o=>{l.value=l.value.filter(c=>c!==t)}).finally(()=>{i.value=!1})};return(t,u)=>{const n=T,o=k,c=C,I=D,B=V,S=j;return m(),U(S,{visible:"",title:"关联场景联动详情",width:600,closable:!1,keyboard:!1,onClose:v},{default:r(()=>[_("div",H,[a(n,{data:"基本信息"}),a(I,{size:"small",column:2,bordered:""},{default:r(()=>[a(c,{label:"场景名称"},{default:r(()=>[a(o,null,{default:r(()=>[f(h(s.detail.name),1)]),_:1})]),_:1}),a(c,{label:"场景类型"},{default:r(()=>[f(h(d(g).text),1)]),_:1})]),_:1}),a(n,{data:"关联详情",style:{margin:"12px 0"}}),_("div",L,[a(J,{branchesGroup:d(y),alarmId:s.id,branchesId:s.detail.id,activeKeys:d(l),show:!0,showDetailBtn:!1,showUnbindBtn:!0,triggerType:s.detail.triggerType,onSelect:w},null,8,["branchesGroup","alarmId","branchesId","activeKeys","triggerType"]),d(i)?(m(),$("div",P,[a(B)])):z("",!0)])])]),_:1})}}}),_e=x(X,[["__scopeId","data-v-ed5c003b"]]);export{_e as default};
