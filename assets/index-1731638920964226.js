import{d as w,ai as V,ac as E,k as f,b as I,ab as g,U as s,V as u,X as a,f as c,_ as l,u as e,Z as N,$ as x,E as S,Y as k}from"./vue-1731638920964.js";import{h as r,X as R,o as M,F as U,Z as j,g as X}from"./index-1731638920964.js";import{u as Z}from"./scene-17316389209642.js";import{_ as $}from"./index.vue_vue_type_script_setup_true_name_SceneSaveDevice_lang-1731638920964.js";import q from"./index-1731638920964213.js";import H from"./index-1731638920964214.js";import{m as L}from"./scene-1731638920964.js";import Y from"./Description-1731638920964.js";import{h as z}from"./util-17316389209642.js";import"./AddModal-1731638920964.js";import"./index-1731638920964287.js";import"./index-1731638920964286.js";import"./Product-17316389209642.js";import"./index-1731638920964278.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import"./product-17316389209644.js";import"./category-1731638920964.js";import"./department-17316389209642.js";import"./setting-17316389209642.js";import"./DeviceSelect-1731638920964.js";import"./TopCard-17316389209647.js";import"./TopCard.vue_vue_type_style_index_0_scoped_47c4fbf1_lang-1731638920964.js";import"./DeviceList-1731638920964.js";import"./OrgList-1731638920964.js";import"./util-17316389209644.js";import"./Type-17316389209643.js";import"./index.vue_vue_type_script_setup_true_name_Timer_lang-1731638920964.js";import"./WhenOption-1731638920964.js";import"./Calendar-1731638920964.js";import"./useRequest-1731638920964.js";import"./index-1731638920964235.js";import"./index-1731638920964309.js";import"./TriggerWay.vue_vue_type_style_index_0_scoped_1bb0f74d_lang-1731638920964.js";import"./FunctionCall.vue_vue_type_script_setup_true_name_FunctionCall_lang-1731638920964.js";import"./ReadProperties.vue_vue_type_script_setup_true_name_ReadProperties_lang-1731638920964.js";import"./WriteProperty.vue_vue_type_script_setup_true_name_WriteProperties_lang-1731638920964.js";import"./InvokeFunction.vue_vue_type_script_setup_true_name_InvokeFunction_lang-1731638920964.js";import"./AddButton-1731638920964.js";import"./Title-17316389209642.js";import"./Terms-17316389209642.js";import"./index-1731638920964291.js";import"./util-17316389209645.js";import"./Branches-1731638920964.js";import"./WhenItem.vue_vue_type_script_setup_true_name_WhenItem_lang-1731638920964.js";import"./TermsItem.vue_vue_type_script_setup_true_name_TermsItem_lang-1731638920964.js";import"./ParamsItem.vue_vue_type_script_setup_true_name_ParamsItem_lang-1731638920964.js";import"./DropdownButton-1731638920964.js";import"./DropdownButton.vue_vue_type_style_index_0_scoped_011bae6b_lang-1731638920964.js";import"./Menus-1731638920964.js";import"./util-17316389209643.js";import"./isUndefined-1731638920964.js";import"./Time.vue_vue_type_style_index_0_lang-1731638920964.js";import"./index-1731638920964223.js";import"./typings-1731638920964.js";import"./Array-1731638920964.js";import"./Array.vue_vue_type_style_index_0_scoped_59b5dd9b_lang-1731638920964.js";import"./Double.vue_vue_type_script_setup_true_name_DoubleParamsDropdown_lang-1731638920964.js";import"./index-1731638920964222.js";import"./index-1731638920964276.js";import"./index-1731638920964224.js";import"./List-1731638920964.js";import"./index-1731638920964219.js";import"./ActionTypeComponent.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./index.vue_vue_type_script_setup_true_lang-173163892096430.js";import"./index-1731638920964220.js";import"./NotifyWay-1731638920964.js";import"./config-17316389209642.js";import"./NotifyConfig.vue_vue_type_style_index_0_lang-1731638920964.js";import"./const-17316389209642.js";import"./NotifyTemplate.vue_vue_type_style_index_0_lang-1731638920964.js";import"./template-1731638920964.js";import"./VariableDefinitions.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./BuildIn.vue_vue_type_script_setup_true_name_NotifyBuildIn_lang-1731638920964.js";import"./Org.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./Tag.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./InputFile.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./User.vue_vue_type_script_setup_true_name_NotifyUser_lang-1731638920964.js";import"./unionBy-1731638920964.js";import"./index-1731638920964218.js";import"./Product-17316389209643.js";import"./index.vue_vue_type_script_setup_true_name_Device_lang-1731638920964.js";import"./TopCard-17316389209646.js";import"./Device-1731638920964.js";import"./Tag-1731638920964.js";import"./RelationSelect.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./lodash.default-1731638920964.js";import"./throttle-1731638920964.js";import"./min-1731638920964.js";import"./isNil-1731638920964.js";import"./difference-1731638920964.js";import"./flattenDeep-1731638920964.js";import"./sortBy-1731638920964.js";import"./uniqBy-1731638920964.js";import"./toLower-1731638920964.js";import"./index.vue_vue_type_script_setup_true_name_ActionDeviceActions_lang-1731638920964.js";import"./EditTable.vue_vue_type_script_setup_true_lang-17316389209642.js";import"./FunctionItem.vue_vue_type_script_setup_true_name_FunctionItem_lang-1731638920964.js";import"./index-1731638920964310.js";import"./WriteProperty.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./CardSelect-1731638920964.js";import"./Item-17316389209643.js";import"./index-1731638920964221.js";import"./AlarmModal-1731638920964.js";import"./useAlarmLevel-1731638920964.js";import"./config-1731638920964.js";import"./configuration-1731638920964.js";import"./util-1731638920964.js";import"./FilterGroup.vue_vue_type_script_setup_true_name_FilterGroup_lang-1731638920964.js";import"./FilterCondition.vue_vue_type_script_setup_true_name_FilterCondition_lang-1731638920964.js";import"./CheckFilterItem-1731638920964.js";import"./CheckItem.vue_vue_type_script_setup_true_name_ActionCheckItem_lang-1731638920964.js";import"./TermsTabPane-1731638920964.js";import"./BranchesNameEdit-1731638920964.js";import"./CheckItem.vue_vue_type_script_setup_true_name_CheckItem_lang-1731638920964.js";import"./AddModal.vue_vue_type_script_setup_true_name_timerAddModel_lang-1731638920964.js";import"./Title-1731638920964.js";const A={timer:r("/scene/trigger-type-icon/timing.png"),manual:r("/scene/trigger-type-icon/manual.png"),device:r("/scene/trigger-type-icon/device.png")};r("/scene/scene-timer.png"),r("/scene/scene-hand.png"),r("/scene/scene-device.png");const G={manual:"手动触发",timer:"定时触发",device:"设备触发"},J={class:"scene-warp"},K={key:0,class:"header"},O={class:"title"},Q={class:"type"},W=["src"],tt={style:{flex:"1 1 0","min-width":"0","margin-left":"8px"}},et=w({name:"Scene"}),ot=w({...et,setup(it){const v=Z(),T=R(),{data:t}=V(v),{getDetail:b,refresh:_}=v,F=E(),y=f(),d=f(!1),h=f(),B=async()=>{var m;if(await y.value.validateFields().catch(i=>{var o;const p=i.errorFields[0].name;(o=h.value)==null||o.changePaneIndex(p[1])})){d.value=!0;const i=(m=t.value.branches)==null?void 0:m.filter(n=>n),p=z(i),o=await L(t.value.id,{...t.value,features:p,branches:i}).then(n=>n).catch(()=>{d.value=!1});d.value=!1,o.success&&(window.onTabSaveSuccess?(window.onTabSaveSuccess(o),setTimeout(()=>window.close(),300)):T.jumpPage("rule-engine/Scene"),M("操作成功"))}};return b(F.query.id),I(()=>{_==null||_()}),(P,m)=>{const i=g("Ellipsis"),p=U,o=j,n=g("FullPage"),C=g("page-container");return s(),u(C,null,{default:a(()=>[c(n,null,{default:a(()=>[l("div",J,[e(t).name?(s(),N("div",K,[c(i,{tooltip:e(t).name,style:{"max-width":"50%"}},{default:a(()=>[l("span",O,x(e(t).name),1)]),_:1},8,["tooltip"]),l("div",Q,[l("img",{src:e(A)[e(t).triggerType]},null,8,W),S(" "+x(e(G)[e(t).triggerType]),1)]),l("div",tt,[c(Y,{value:e(t).description,"onUpdate:value":m[0]||(m[0]=D=>e(t).description=D)},null,8,["value"])])])):k("",!0),c(p,{ref_key:"sceneForm",ref:y,model:e(t),colon:!1,layout:"vertical"},{default:a(()=>[e(t).triggerType==="device"?(s(),u($,{key:0,ref_key:"deviceRef",ref:h},null,512)):e(t).triggerType==="manual"?(s(),u(q,{key:1})):e(t).triggerType==="timer"?(s(),u(H,{key:2})):k("",!0)]),_:1},8,["model"]),c(o,{type:"primary",hasPermission:"rule-engine/Scene:update",loading:e(d),onClick:B},{default:a(()=>[S(" 保存 ")]),_:1},8,["loading"])])]),_:1})]),_:1})}}});const vo=X(ot,[["__scopeId","data-v-c7b24fd0"]]);export{vo as default};
