import{a as X,o as r,I as Y,Z as z,as as H,cU as Q,aO as W,$ as ee,dg as te,af as se,g as ae}from"./index-1731638920964.js";import"./index-1731638920964281.js";import"./index-1731638920964291.js";import{a as oe,b as ne,c as $}from"./dictionary-1731638920964.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang-173163892096432.js";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang-173163892096431.js";import{d as ce,k as d,o as re,ab as P,U as u,Z as de,_ as m,f as n,X as i,u as a,G as ue,E as _,V as f,$ as pe,Y as B,F as me}from"./vue-1731638920964.js";import"./index-1731638920964279.js";import"./regular-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964280.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";const _e={class:"left-contain"},fe={class:"controls"},ye={class:"tree"},ve=["onClick"],he={class:"itemText"},ke=ce({__name:"index",emits:["selectData"],setup(Ce,{emit:N}){const y=X().hasPermission,v=d(!1),D=d("add"),g=d([]),V=d(),p=d([]),j=()=>{v.value=!0,D.value="add"},x=d(!1),h=d(),k=(s,e)=>{const o=e?{paging:!1,sorts:[{name:"createTime",order:"desc"},{name:"name",order:"desc"}],terms:[{terms:[{value:"%"+e+"%",termType:"like",column:"name"}]}]}:{sorts:[{name:"createTime",order:"desc"},{name:"name",order:"desc"}],paging:!1};oe(o).then(l=>{l.status===200&&(g.value=l.result,s&&l.result.length?w(l.result[0]):p.value&&(console.log(p.value),w(l.result.find(c=>c.id===p.value[0]))))})},S=()=>{k(!0,h.value)},J=()=>{h.value===""&&k(!0)},L=s=>{v.value=!0,D.value="edit",V.value=s},b=()=>{k()},U=s=>{v.value=!1,p.value=[s],b()},A=s=>{const e=ne(s);return e.then(o=>{o.status===200?(r("操作成功!"),k(!0)):r("操作失败!","error")}),e},F=s=>{s.status=s.status===1?0:1;const e=$(s);return e.then(o=>{o.status===200?(r("操作成功!"),b()):r("操作失败!","error")}),e},w=s=>{p.value=[s.id],N("selectData",s)},M=s=>{if(s.type==="application/json"){const e=new FileReader;e.readAsText(s),e.onload=async o=>{var l;if((l=o==null?void 0:o.target)!=null&&l.result){const c=o.target.result;let C;try{C=JSON.parse(c)}catch{return r("请上传json格式的文件","error"),!1}(await $(C)).status===200&&(b(),r("操作成功！"))}else r("文件内容不能为空","error")}}else r("请上传json格式的文件","error")},O=()=>{x.value=!1};return re(()=>{k(!0)}),(s,e)=>{const o=P("AIcon"),l=Y,c=z,C=H,T=P("Ellipsis"),I=Q,K=W,R=ee,Z=te,q=se,G=P("Import");return u(),de(me,null,[m("div",_e,[n(l,{placeholder:"字典名称",value:a(h),"onUpdate:value":e[0]||(e[0]=t=>ue(h)?h.value=t:null),onPressEnter:S,onChange:J},{suffix:i(()=>[n(o,{type:"SearchOutlined",onClick:S})]),_:1},8,["value"]),m("div",fe,[n(c,{type:"primary",hasPermission:"system/Dictionary:add",onClick:j,style:{width:"160px"}},{default:i(()=>[_(" 新增字典 ")]),_:1}),n(c,{type:"text",hasPermission:"system/Dictionary:down",onClick:e[1]||(e[1]=t=>x.value=!0)},{default:i(()=>[_(" 下载 ")]),_:1}),n(C,{"before-upload":M,accept:".json","show-upload-list":!1,disabled:!a(y)("system/Dictionary:import")},{default:i(()=>[n(c,{type:"text",hasPermission:"system/Dictionary:import"},{default:i(()=>[_(" 导入 ")]),_:1})]),_:1},8,["disabled"])]),m("div",ye,[a(g).length?(u(),f(Z,{key:0,"tree-data":a(g),fieldNames:{title:"name",key:"id"},blockNode:"",selectedKeys:a(p)},{title:i(t=>[m("div",{class:"treeItem",onClick:()=>w(t.data)},[m("div",he,[n(T,{style:{width:"calc(100%-100px)"}},{default:i(()=>[_(pe(t.name),1)]),_:2},1024)]),m("div",{onClick:e[2]||(e[2]=E=>E.stopPropagation())},[a(y)("system/Dictionary:action")&&t.data.classified!=="system"?(u(),f(K,{key:0,title:t.data.status===1?"禁用后引用该字典的页面将受到影响，确认禁用？":"确认启用？",onConfirm:()=>F(t.data)},{default:i(()=>[n(I,{checked:t.status,disabled:!a(y)("system/Dictionary:action")||t.data.classified==="system",checkedValue:1,unCheckedValue:0},null,8,["checked","disabled"])]),_:2},1032,["title","onConfirm"])):(u(),f(R,{key:1,placement:"top",title:a(y)("system/Dictionary:action")?"内置数据不支持修改":"暂无权限,请联系管理员"},{default:i(()=>[n(I,{checked:t.status,disabled:!a(y)("system/Dictionary:action")||t.data.classified==="system",checkedValue:1,unCheckedValue:0},null,8,["checked","disabled"])]),_:2},1032,["title"])),n(c,{type:"text",hasPermission:"system/Dictionary:delete",disabled:t.data.classified==="system",tooltip:t.data.classified==="system"?{title:"内置数据不支持修改"}:null,popConfirm:{title:"确认删除？",onConfirm:()=>A(t.id)}},{default:i(()=>[_(" 删除 ")]),_:2},1032,["disabled","tooltip","popConfirm"]),n(c,{type:"text",disabled:t.data.classified==="system",tooltip:t.data.classified==="system"?{title:"内置数据不支持修改"}:null,hasPermission:"system/Dictionary:update",onClick:E=>L(t.data)},{default:i(()=>[_(" 编辑 ")]),_:2},1032,["disabled","tooltip","onClick"])])],8,ve)]),_:1},8,["tree-data","selectedKeys"])):(u(),f(q,{key:1,style:{"margin-top":"100px"}}))])]),a(v)?(u(),f(ie,{key:0,type:a(D),onCloseSave:e[3]||(e[3]=t=>v.value=!1),onSuccess:U,data:a(V)},null,8,["type","data"])):B("",!0),a(x)?(u(),f(le,{key:1,onCloseDown:O})):B("",!0),n(G)],64)}}});const Ne=ae(ke,[["__scopeId","data-v-eefdf411"]]);export{Ne as default};
