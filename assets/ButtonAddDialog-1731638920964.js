import{gl as y,o as B,da as C,v as D,I as R,a9 as w,F as U,aa as A,g as L}from"./index-1731638920964.js";import"./index-1731638920964303.js";import V from"./PermissChoose-1731638920964.js";import{d as q,k as _,r as F,U as J,V as M,X as i,f as d,u as t,E as N,$ as v,_ as O,J as E}from"./vue-1731638920964.js";import"./index-1731638920964280.js";import"./permission-1731638920964.js";const $={class:"message"},S=q({__name:"ButtonAddDialog",props:{menuInfo:{},visible:{type:Boolean},mode:{},data:{},menuData:{}},emits:["confirm","update:visible"],setup(b,{emit:p}){const s=b,m=_(!1),g=()=>{c.value&&c.value.validate().then(()=>{var n;const l=E((n=s.menuInfo)==null?void 0:n.buttons)||[],e=l==null?void 0:l.find(r=>r.id===a.data.id);e?Object.entries(a.data).forEach(([r,f])=>{e[r]=f}):l.push({...a.data});const u={...s.menuInfo,buttons:l};m.value=!0,y(u).then(r=>{B("操作成功"),p("confirm"),p("update:visible",!1)}).finally(()=>m.value=!1).catch(()=>{m.value=!1})})},x={name:"",id:"",permissions:[],description:""},c=_(),a=F({data:{...x,...s.data},checkPermission:(l,e)=>!e||e.length<1?Promise.reject("请选择权限"):Promise.resolve()}),I=[{label:"add",value:"add",message:"新增"},{label:"delete",value:"delete",message:"删除"},{label:"update",value:"update",message:"更新"}],h=(l,e)=>s.mode==="编辑"||s.mode==="查看"?Promise.resolve(""):s.menuData.find(n=>n.id===e)?Promise.reject("编码重复"):Promise.resolve("");return(l,e)=>{const u=C,n=D,r=R,f=w,j=U,k=A;return J(),M(k,{visible:"",title:s.mode,width:"660px",onOk:g,onCancel:e[4]||(e[4]=o=>p("update:visible",!1)),maskClosable:!1,confirmLoading:t(m)},{default:i(()=>[d(j,{model:t(a).data,class:"basic-form",ref_key:"formRef",ref:c},{default:i(()=>[d(n,{label:"编码",name:"id",rules:[{required:!0,message:"请输入编码"},{max:64,message:"最多可输入64个字符"},{validator:h,trigger:"blur"}]},{default:i(()=>[d(u,{value:t(a).data.id,"onUpdate:value":e[0]||(e[0]=o=>t(a).data.id=o),options:I,placeholder:"请输入编码",disabled:s.mode!=="新增"},{option:i(({value:o,message:P})=>[N(v(o)+" ",1),O("span",$,v(P),1)]),_:1},8,["value","disabled"])]),_:1},8,["rules"]),d(n,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多可输入64个字符"}]},{default:i(()=>[d(r,{value:t(a).data.name,"onUpdate:value":e[1]||(e[1]=o=>t(a).data.name=o),disabled:s.mode==="查看",placeholder:"请输入名称"},null,8,["value","disabled"])]),_:1}),d(n,{label:"权限",name:"permissions",rules:[{required:!0,message:"请选择权限",validator:t(a).checkPermission}]},{default:i(()=>[d(V,{"first-width":8,"max-height":"350px",value:t(a).data.permissions,"onUpdate:value":e[2]||(e[2]=o=>t(a).data.permissions=o),disabled:s.mode==="查看",btnId:t(a).data.id},null,8,["value","disabled","btnId"])]),_:1},8,["rules"]),d(n,{label:"说明",name:"description",rules:[{max:200,message:"最多可输入200个字符"}]},{default:i(()=>[d(f,{value:t(a).data.description,"onUpdate:value":e[3]||(e[3]=o=>t(a).data.description=o),rows:4,placeholder:"请输入说明",disabled:s.mode==="查看"},null,8,["value","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirmLoading"])}}});const Q=L(S,[["__scopeId","data-v-81d026dd"]]);export{Q as default};
