import{au as y,dt as H,dq as Y,Z as N,e as U,a3 as V,ah as J,ai as O,d as R,aa as G,g as F}from"./index-1731638920964.js";import"./index-1731638920964284.js";import"./index-1731638920964278.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import{q as Z}from"./log-17316389209642.js";import{d as k,k as d,ab as u,U as m,Z as b,_ as T,f as s,X as t,E as o,$ as n,u as a,F as x,a1 as z,V as X,G as $}from"./vue-1731638920964.js";const K={class:"userName"},Q=k({name:"AccessLog"}),W=k({...Q,setup(ee){const v=d({}),_=d({}),f=[{title:"IP",dataIndex:"ip",key:"ip",search:{type:"string"},scopedSlots:!0,width:150,fixed:"left"},{title:"请求路径",dataIndex:"url",key:"url",search:{type:"string"},ellipsis:!0},{title:"说明",dataIndex:"description",key:"description",scopedSlots:!0,search:{type:"string"},ellipsis:!0},{title:"请求方法",dataIndex:"httpMethod",key:"httpMethod",search:{type:"select",options:[{label:"POST",value:"POST"},{label:"GET",value:"GET"},{label:"PATCH",value:"PATCH"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}]},scopedSlots:!0,width:100},{title:"请求时间",dataIndex:"requestTime",key:"requestTime",scopedSlots:!0,search:{type:"date"},width:200},{title:"请求耗时",dataIndex:"responseTime",key:"responseTime",scopedSlots:!0,width:100},{title:"请求用户",dataIndex:"username",key:"username",width:150,scopedSlots:!0},{title:"操作",key:"action",fixed:"right",width:60,scopedSlots:!0}],l=d({url:"",httpMethod:"",action:"",target:"",method:"",ip:"",requestTime:0,responseTime:0,httpHeaders:"",parameters:"",exception:""}),p=d(!1),g=c=>{p.value=!1},E=c=>c?[{key:"eye",text:"查看",tooltip:{title:"查看"},icon:"EyeOutlined",onClick:()=>{l.value=c,p.value=!0}}]:[],S={username:"context.username",description:"action"},q=c=>{_.value=H(c,S)};return(c,h)=>{const I=u("pro-search"),C=Y,P=u("Ellipsis"),w=u("AIcon"),A=N,D=U,L=V,r=J,M=O,j=R,B=G;return m(),b(x,null,[T("div",null,[s(I,{columns:f,target:"search-access",onSearch:q}),s(L,{ref_key:"tableRef",ref:v,model:"TABLE",columns:f,request:a(Z),defaultParams:{sorts:[{name:"responseTime",order:"desc"}]},params:a(_)},{requestTime:t(e=>[o(n(a(y)(e.requestTime).format("YYYY-MM-DD HH:mm:ss")),1)]),description:t(e=>[o(n(e.action),1)]),responseTime:t(e=>[s(C,{color:"purple"},{default:t(()=>[o(n(e.responseTime-e.requestTime)+" ms ",1)]),_:2},1024)]),username:t(e=>[T("div",K,[s(P,{style:{"max-width":"100px"}},{default:t(()=>[o(n(e.context.userName),1)]),_:2},1024)])]),action:t(e=>[s(D,{size:16},{default:t(()=>[(m(!0),b(x,null,z(E(e),i=>(m(),X(A,{key:i.key,tooltip:{...i.tooltip},onClick:i.onClick,type:"link",style:{padding:"0 5px"}},{icon:t(()=>[s(w,{type:i.icon},null,8,["type"])]),_:2},1032,["tooltip","onClick"]))),128))]),_:2},1024)]),_:1},8,["request","params"])]),s(B,{width:1100,visible:a(p),"onUpdate:visible":h[0]||(h[0]=e=>$(p)?p.value=e:null),title:"详情"},{footer:t(()=>[s(j,{type:"primary",onClick:g},{default:t(()=>[o("关闭")]),_:1})]),default:t(()=>[s(M,{data:a(l),title:"",bordered:"",column:2},{default:t(()=>[s(r,{label:"URL"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.url),1)]}),_:1}),s(r,{label:"请求方法"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.httpMethod),1)]}),_:1}),s(r,{label:"动作"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.action),1)]}),_:1}),s(r,{label:"类名"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.target),1)]}),_:1}),s(r,{label:"方法名"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.method),1)]}),_:1}),s(r,{label:"IP"},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.ip),1)]}),_:1}),s(r,{label:"请求时间"},{default:t(()=>{var e;return[o(n(a(y)((e=a(l))==null?void 0:e.requestTime).format("YYYY-MM-DD HH:mm:ss")),1)]}),_:1}),s(r,{label:"请求耗时"},{default:t(()=>{var e,i;return[o(n(((e=a(l))==null?void 0:e.responseTime)-((i=a(l))==null?void 0:i.requestTime)+"ms"),1)]}),_:1}),s(r,{label:"请求头",span:2},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.httpHeaders),1)]}),_:1}),s(r,{label:"请求参数",span:2},{default:t(()=>{var e;return[o(n((e=a(l))==null?void 0:e.parameters),1)]}),_:1}),s(r,{label:"异常信息",span:2},{default:t(()=>[o(n(a(l).exception),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["visible"])],64)}}});const de=F(W,[["__scopeId","data-v-b9525546"]]);export{de as default};
