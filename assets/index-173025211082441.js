import{X as N,ag as A,K as B,M as L,af as M,A as V,y as w,g as E}from"./index-1730252110824.js";import"./index-1730252110824276.js";import{g as R}from"./notificationSubscription-1730252110824.js";import{g as D}from"./data-1730252110824.js";import F from"./Item-1730252110824.js";import{d as J,k as u,o as O,ab as U,U as r,V as l,X as p,f as h,_ as m,E as X,u as _,G as z,a0 as G,Z as I,a1 as S,F as C}from"./vue-1730252110824.js";import"./index-1730252110824277.js";import"./Unsubscribe-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-17302521108242.js";import"./Bind-1730252110824.js";import"./Wechat.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./Card-17302521108242.js";import"./Detail-1730252110824.js";const P={style:{padding:"0 10px"}},T={class:"alert"},Z={class:"content-collapse"},$=J({__name:"index",setup(q){const j=N(),b=u([]),f=u([]),d=u(),y=u(!1);let x;const k=()=>{y.value=!0,A().then(e=>{if(e.status===200){const a=x.map(t=>{const n=t.children.map(o=>{const g=(e.result||[]).find(i=>(i==null?void 0:i.provider)===(o==null?void 0:o.provider));return{...o,...g}});return{...t,children:n}}).filter(t=>{var n;return(n=t.children.filter(o=>o==null?void 0:o.id))==null?void 0:n.length}).map(t=>({...t,children:t.children.filter(n=>n==null?void 0:n.id)}));f.value=a}}),R().then(e=>{var a;e.status===200&&(b.value=((a=e==null?void 0:e.result)==null?void 0:a.data)||[])}).finally(()=>{y.value=!1})};return O(()=>{const e=["alarm","system-monitor","system-business"];j.hasMenu("process")&&e.push("workflow-notification"),d.value=e,x=D(),k()}),(e,a)=>{const t=U("AIcon"),n=B,o=L,g=M,i=V,K=w;return r(),l(K,{height:"calc(100% - 51px)"},{default:p(()=>[h(i,{spinning:_(y)},{default:p(()=>[m("div",P,[m("div",T,[h(t,{type:"InfoCircleOutlined"}),X(" 你可以在该页面选择需要订阅的主题及接收通知的方式。 ")]),m("div",Z,[_(f).length?(r(),l(o,{key:0,bordered:!1,activeKey:_(d),"onUpdate:activeKey":a[0]||(a[0]=s=>z(d)?d.value=s:null),"expand-icon-position":"right"},{expandIcon:p(({isActive:s})=>[h(t,{type:"CaretRightOutlined",style:G({transform:`rotate(${s?90:0}deg)`})},null,8,["style"])]),default:p(()=>[(r(!0),I(C,null,S(_(f),s=>(r(),l(n,{key:s.provider,header:s.name},{default:p(()=>[m("div",null,[(r(!0),I(C,null,S(s.children,c=>(r(),l(F,{key:c.id,onRefresh:k,data:c,subscribe:_(b).find(v=>(v==null?void 0:v.topicProvider)===(c==null?void 0:c.provider))},null,8,["data","subscribe"]))),128))])]),_:2},1032,["header"]))),128))]),_:1},8,["activeKey"])):(r(),l(g,{key:1,style:{margin:"200px 0"}}))])])]),_:1},8,["spinning"])]),_:1},8,["height"])}}});const le=E($,[["__scopeId","data-v-545d7eb8"]]);export{le as default};
