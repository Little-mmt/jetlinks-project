import{aF as O,d2 as L,v as B,F,aa as I,g as M}from"./index-1730252110824.js";import{_ as T}from"./ActionTypeComponent.vue_vue_type_script_setup_true_lang-1730252110824.js";import P from"./CardSelect-1730252110824.js";import{d as g,k as b,r as S,w as z,U as l,V as y,X as m,f as d,u as i,_ as E,E as q,Z as A,Y as f,W as D}from"./vue-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082430.js";import"./index-1730252110824220.js";import"./index-1730252110824286.js";import"./NotifyWay-1730252110824.js";import"./config-17302521108242.js";import"./NotifyConfig.vue_vue_type_style_index_0_lang-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import"./const-17302521108242.js";import"./NotifyTemplate.vue_vue_type_style_index_0_lang-1730252110824.js";import"./template-1730252110824.js";import"./VariableDefinitions.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./BuildIn.vue_vue_type_script_setup_true_name_NotifyBuildIn_lang-1730252110824.js";import"./scene-1730252110824.js";import"./scene-17302521108242.js";import"./Org.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./Tag.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./InputFile.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./User.vue_vue_type_script_setup_true_name_NotifyUser_lang-1730252110824.js";import"./unionBy-1730252110824.js";import"./index-1730252110824218.js";import"./index-1730252110824287.js";import"./Product-17302521108243.js";import"./product-17302521108244.js";import"./category-1730252110824.js";import"./department-17302521108242.js";import"./setting-17302521108242.js";import"./index.vue_vue_type_script_setup_true_name_Device_lang-1730252110824.js";import"./TopCard-17302521108246.js";import"./Device-1730252110824.js";import"./Tag-1730252110824.js";import"./RelationSelect.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./util-17302521108242.js";import"./util-17302521108245.js";import"./lodash.default-1730252110824.js";import"./throttle-1730252110824.js";import"./min-1730252110824.js";import"./isNil-1730252110824.js";import"./isUndefined-1730252110824.js";import"./difference-1730252110824.js";import"./flattenDeep-1730252110824.js";import"./sortBy-1730252110824.js";import"./uniqBy-1730252110824.js";import"./toLower-1730252110824.js";import"./index.vue_vue_type_script_setup_true_name_ActionDeviceActions_lang-1730252110824.js";import"./EditTable.vue_vue_type_script_setup_true_lang-17302521108242.js";import"./FunctionItem.vue_vue_type_script_setup_true_name_FunctionItem_lang-1730252110824.js";import"./index-1730252110824223.js";import"./typings-1730252110824.js";import"./DropdownButton.vue_vue_type_style_index_0_scoped_011bae6b_lang-1730252110824.js";import"./Menus-1730252110824.js";import"./util-17302521108243.js";import"./Time.vue_vue_type_style_index_0_lang-1730252110824.js";import"./Array.vue_vue_type_style_index_0_scoped_59b5dd9b_lang-1730252110824.js";import"./Double.vue_vue_type_script_setup_true_name_DoubleParamsDropdown_lang-1730252110824.js";import"./index-1730252110824310.js";import"./WriteProperty.vue_vue_type_script_setup_true_lang-1730252110824.js";const J={style:{position:"relative"}},W={key:0,class:"action-tip"},X=g({name:"UpdateActionItemModal"}),Y=g({...X,props:{branchesName:{type:Number,default:0},thenName:{type:Number,default:0},name:{type:Number,default:0},data:{type:Object,default:()=>({key:O(),actionId:L()})},parallel:{type:Boolean},actionOptions:{type:Object,default:()=>({})}},emits:["cancel","save"],setup(c,{emit:n}){var _;const e=c,a=Object.keys(e.data).length>2&&((_=e.data)==null?void 0:_.executor)==="alarm",h=[{label:"设备输出",value:"device",iconUrl:"icon-shebeishuchu",subLabel:"配置设备调用功能、读取属性、设置属性规则",disabled:a},{label:"消息通知",value:"notify",iconUrl:"icon-xiaoxitongzhi",subLabel:"配置向指定用户发邮件、钉钉、微信、短信等通知",disabled:a},{label:"延迟执行",value:"delay",iconUrl:"icon-yanchizhihang",subLabel:"等待一段时间后，再执行后续动作",disabled:a},{label:"触发告警",value:"trigger",iconUrl:"icon-chufagaojing",subLabel:"配置触发告警规则，需配合“告警配置”使用"},{label:"解除告警",value:"relieve",iconUrl:"icon-jiechugaojing",subLabel:"配置解除告警规则，需配合“告警配置”使用"}],u=b(),p=S({type:"device"}),r=b("");z(()=>e.data,t=>{var o;t!=null&&t.executor&&(p.type=(t==null?void 0:t.executor)==="alarm"?(o=t==null?void 0:t.alarm)==null?void 0:o.mode:t==null?void 0:t.executor)},{immediate:!0,deep:!0});const v=()=>{u.value.validate().then(t=>{r.value=t==null?void 0:t.type,((t==null?void 0:t.type)==="relieve"||(t==null?void 0:t.type)==="trigger")&&n("save",{key:e.data.key,actionId:e.data.actionId,executor:"alarm",alarm:{mode:t.type}},{})})},x=()=>{n("cancel")},k=(t,o)=>{n("save",{...t,executor:t.type},o),r.value=""},N=()=>{r.value=""};return(t,o)=>{const j=B,C=F,U=I;return l(),y(U,{title:"类型",visible:"",width:860,onCancel:x,onOk:v,maskClosable:!1},{default:m(()=>[d(C,{ref_key:"actionForm",ref:u,model:i(p),layout:"vertical"},{default:m(()=>[d(j,{name:"type",rules:[{required:!0,message:"请选择类型"}]},{label:m(()=>[E("div",J,[q(" 类型 "),i(a)?(l(),A("div",W," 告警类型执行动作涉及绑定告警配置，不支持修改为其它类型 ")):f("",!0)])]),default:m(()=>[d(P,{value:i(p).type,"onUpdate:value":o[0]||(o[0]=s=>i(p).type=s),options:h.filter(s=>!(s.value==="delay"&&c.parallel))},null,8,["value","options"])]),_:1}),i(r)?(l(),y(T,D({key:0},e,{actionType:i(r),options:c.actionOptions,onSave:k,onCancel:N}),null,16,["actionType","options"])):f("",!0)]),_:1},8,["model"])]),_:1})}}});const eo=M(Y,[["__scopeId","data-v-cabc375b"]]);export{eo as default};
