import{d as U,ac as $,k as P,w as J,o as L,ab as w,U as d,V as k,X as i,_ as u,f as s,E as g,$ as x,u as e,Z as A,Y as D,a5 as X,W as Z}from"./vue-1731638920964.js";import{k as H,a as W,X as Y,eT as G,o as I,i as K,fD as O,$ as Q,cU as tt,Z as et,ah as ot,ai as rt,g as it}from"./index-1731638920964.js";import"./index-1731638920964284.js";import"./index-1731638920964291.js";import{u as at}from"./product-17316389209645.js";import{_ as st}from"./indev.vue_vue_type_script_setup_true_lang-1731638920964.js";import nt from"./index-173163892096492.js";import pt from"./index-1731638920964105.js";import ct from"./index-173163892096491.js";import mt from"./index-173163892096493.js";import dt from"./index-173163892096453.js";import ut from"./index-173163892096464.js";import{_ as lt,E as _t,F as ft}from"./product-17316389209644.js";import{u as ht}from"./useParams-1731638920964.js";import"./encodeQuery-1731638920964.js";import"./index-173163892096497.js";import"./index-1731638920964290.js";import"./index-173163892096496.js";import"./regular-1731638920964.js";import"./index-1731638920964282.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-173163892096494.js";import"./marked.esm-1731638920964.js";import"./accessModal.vue_vue_type_script_setup_true_name_accessModal_lang-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964283.js";import"./plugin-17316389209642.js";import"./accessConfig-1731638920964.js";import"./metadataModal-1731638920964.js";import"./instance-1731638920964.js";import"./index-1731638920964104.js";import"./metadata-1731638920964.js";import"./index-1731638920964103.js";import"./index-1731638920964302.js";import"./Base-1731638920964.js";import"./context-1731638920964.js";import"./columns-1731638920964.js";import"./utils-1731638920964.js";import"./Source-1731638920964.js";import"./Source.vue_vue_type_style_index_0_scoped_5dc360f1_lang-1731638920964.js";import"./index.vue_vue_type_script_setup_true_name_VirtualRule_lang-1731638920964.js";import"./Rule.vue_vue_type_script_setup_true_name_Rule_lang-1731638920964.js";import"./index-1731638920964304.js";import"./lodash.default-1731638920964.js";import"./throttle-1731638920964.js";import"./min-1731638920964.js";import"./isNil-1731638920964.js";import"./isUndefined-1731638920964.js";import"./difference-1731638920964.js";import"./flattenDeep-1731638920964.js";import"./sortBy-1731638920964.js";import"./unionBy-1731638920964.js";import"./uniqBy-1731638920964.js";import"./toLower-1731638920964.js";import"./index-1731638920964294.js";import"./index-1731638920964296.js";import"./data-17316389209643.js";import"./index-1731638920964293.js";import"./index-1731638920964295.js";import"./ConfigParams.vue_vue_type_style_index_0_scoped_5c08861f_lang-1731638920964.js";import"./ConfigModal.vue_vue_type_script_setup_true_name_ConfigModal_lang-1731638920964.js";import"./ValueObject.vue_vue_type_script_setup_true_name_ValueObject_lang-1731638920964.js";import"./DataTypeObjectChild-1731638920964.js";import"./OtherConfigInfo.vue_vue_type_script_setup_true_name_OtherConfigInfo_lang-1731638920964.js";import"./ModelButton-1731638920964.js";import"./Metrics.vue_vue_type_script_setup_true_name_Metrics_lang-1731638920964.js";import"./ValueItem-1731638920964.js";import"./item-17316389209642.js";import"./BooleanSelect-1731638920964.js";import"./OtherSetting.vue_vue_type_style_index_0_scoped_d8c8c8c1_lang-1731638920964.js";import"./index-1731638920964276.js";import"./useRequest-1731638920964.js";import"./OutputParams.vue_vue_type_style_index_0_scoped_6ffcb997_lang-1731638920964.js";import"./Type.vue_vue_type_script_setup_true_name_DataTypeSelect_lang-1731638920964.js";import"./Constraint-1731638920964.js";import"./OtherSetting-1731638920964.js";import"./metadata-17316389209642.js";import"./PropertiesModal.vue_vue_type_script_setup_true_name_PropertiesModal_lang-1731638920964.js";import"./index-1731638920964300.js";import"./JsonView-1731638920964.js";import"./index-1731638920964285.js";import"./DetailModal-1731638920964.js";import"./FunctionModal.vue_vue_type_script_setup_true_name_FunctionModal_lang-1731638920964.js";import"./EventModal.vue_vue_type_script_setup_true_name_EventModal_lang-1731638920964.js";import"./TagsModal.vue_vue_type_script_setup_true_name_TagsModal_lang-1731638920964.js";import"./data-17316389209644.js";import"./Import-1731638920964.js";import"./index-1731638920964303.js";import"./index-173163892096451.js";import"./log-17316389209643.js";import"./Duration-1731638920964.js";import"./index.vue_vue_type_script_setup_true_lang-17316389209647.js";import"./AlarmLog-1731638920964.js";import"./index-1731638920964299.js";import"./Log-1731638920964.js";import"./LogDetail-1731638920964.js";import"./vue-json-viewer-1731638920964.js";import"./useAlarmLevel-1731638920964.js";import"./config-1731638920964.js";import"./index-173163892096452.js";import"./firmware-1731638920964.js";import"./index-173163892096449.js";import"./index.vue_vue_type_script_setup_true_name_TaskPage_lang-1731638920964.js";import"./SelectDevices-1731638920964.js";import"./index-173163892096447.js";const yt={style:{display:"flex","align-items":"center"}},vt={class:"productDetailHead"},bt={key:0,style:{margin:"-5px 0 0 20px"}},kt={key:1,style:{margin:"-5px 0 0 20px"}},Pt={style:{"padding-top":"10px"}},gt={style:{height:"100%",padding:"24px"}},xt=U({__name:"index",setup(Ct){var M;const{showThreshold:T}=H(),p=W(),j=Y(),F=$();P(!0);const t=at(),B=ht();P({terms1:[{column:"productId",termType:"eq",value:(M=t.current)==null?void 0:M.id}],terms2:void 0,type:"and"});const c=P([{key:"Info",tab:"配置信息"},{key:"Metadata",tab:"物模型",class:"objectModel"},{key:"Device",tab:"设备接入"}]),E={Info:st,Metadata:pt,Device:nt,DataAnalysis:ct,MetadataMap:mt,AlarmRecord:dt,Firmware:ut},V=o=>{t.tabActiveKey==="Metadata"?G.emit("MetadataTabs",()=>{t.tabActiveKey=o}):t.tabActiveKey=o},C=()=>{if(t.current.id){const o=lt(t.current.id);return o.then(a=>{a.status===200&&(I("操作成功！"),t.refresh(t.current.id))}),o}},N=()=>{if(t.current.id){const o=_t(t.current.id);return o.then(a=>{a.status===200&&(I("操作成功！"),t.refresh(t.current.id))}),o}},R=async()=>{var o,a,l,m,_,v,b;if(c.value=[{key:"Info",tab:"配置信息"},{key:"Metadata",tab:"物模型",class:"objectModel"},{key:"Device",tab:"设备接入"}],(o=t.current)!=null&&o.messageProtocol){const f=await ft((a=t.current)==null?void 0:a.messageProtocol);if(f.status===200){const r=(m=(l=f.result)==null?void 0:l.transports)==null?void 0:m.find(y=>{var S;return y.id===((S=t.current)==null?void 0:S.transportProtocol)}),n=(_=r==null?void 0:r.features)==null?void 0:_.find(y=>y.id==="transparentCodec"),z=(v=r==null?void 0:r.features)==null?void 0:v.find(y=>y.id==="supportFirmware");n&&c.value.push({key:"DataAnalysis",tab:"数据解析"}),z&&p.hasPermission("device/Firmware:view")&&K&&c.value.push({key:"Firmware",tab:"远程升级"})}const h=(b=f.result)==null?void 0:b.transports.find(r=>r.id===t.current.transportProtocol);h!=null&&h.features.find(r=>r.id==="diffMetadataSameProduct")&&c.value.push({key:"MetadataMap",tab:"物模型映射"}),p.hasPermission("rule-engine/Alarm/Configuration:view")&&K&&T&&c.value.push({key:"AlarmRecord",tab:"预处理数据"})}},q=()=>{var a;const o={column:"productName",termType:"eq",value:(a=t.current)==null?void 0:a.id};j.jumpPage("device/Instance",{},{target:"device-instance",q:O([o])})};return J(()=>t.current,()=>{R()}),L(()=>{var o;t.reSet(),t.refresh(F.params.id),t.tabActiveKey=((o=B.params)==null?void 0:o.value.tab)||"Info"}),(o,a)=>{const l=Q,m=tt,_=et,v=ot,b=rt,f=w("FullPage"),h=w("page-container");return d(),k(h,{tabList:e(c),tabActiveKey:e(t).tabActiveKey,onTabChange:V,showBack:"true"},{title:i(()=>[u("div",null,[u("div",yt,[s(l,null,{title:i(()=>[g(x(e(t).current.name),1)]),default:i(()=>[u("div",vt,x(e(t).current.name),1)]),_:1}),e(p).hasPermission("device/Product:action")?(d(),A("div",bt,[s(_,{style:{padding:"0"},type:"text",hasPermission:"device/Product:action",popConfirm:{title:e(t).current.state===1?"确认禁用":"确认启用",onConfirm:e(t).current.state===1?N:C}},{default:i(()=>[s(m,{checked:e(t).current.state===1,"checked-children":"正常","un-checked-children":"禁用",disabled:!e(p).hasPermission("device/Product:action")},null,8,["checked","disabled"])]),_:1},8,["popConfirm"])])):(d(),A("div",kt,[s(l,null,{title:i(()=>[g("暂无权限，请联系管理员")]),default:i(()=>[e(t).current.state===1?(d(),k(m,{key:0,checked:e(t).current.state===1,"checked-children":"正常","un-checked-children":"禁用",disabled:!e(p).hasPermission("device/Product:action")},null,8,["checked","disabled"])):D("",!0),e(t).current.state===0?(d(),k(m,{key:1,unCheckedValue:e(t).current.state===0,"checked-children":"正常","un-checked-children":"禁用",disabled:!e(p).hasPermission("device/Product:action")},null,8,["unCheckedValue","disabled"])):D("",!0)]),_:1})]))])])]),content:i(()=>[u("div",Pt,[s(b,{size:"small",column:4},{default:i(()=>[s(v,{label:"设备数量",labelStyle:{fontSize:"14px",opacity:.55},contentStyle:{fontSize:"14px",color:"#092EE7",cursor:"pointer"}},{default:i(()=>{var r,n;return[u("span",{onClick:q},x((r=e(t).current)!=null&&r.count?(n=e(t).current)==null?void 0:n.count:0),1)]}),_:1})]),_:1})])]),extra:i(()=>{var r,n;return[s(_,{type:"primary",popConfirm:{title:"确认应用配置?",onConfirm:C},disabled:((r=e(t).current)==null?void 0:r.state)===0,tooltip:((n=e(t).current)==null?void 0:n.state)===0?{title:"请先启用产品"}:void 0,hasPermission:"device/Product:update",placement:"topRight"},{default:i(()=>[g("应用配置")]),_:1},8,["popConfirm","disabled","tooltip"])]}),default:i(()=>[s(f,null,{default:i(()=>[u("div",gt,[(d(),k(X(E[e(t).tabActiveKey]),Z({class:e(t).tabActiveKey==="Metadata"?"metedata":""},{type:"product"}),null,16,["class"]))])]),_:1})]),_:1},8,["tabList","tabActiveKey"])}}});const Mo=it(xt,[["__scopeId","data-v-5244103e"]]);export{Mo as default};
