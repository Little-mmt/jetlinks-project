import{d as j,k as _,e as f,w as O,ab as R,U as o,Z as c,_ as t,u as a,E as $,$ as x,a0 as b,f as m,X as y,V as g,a8 as D,Y as l,v as X,A as Y,a4 as I,R as N,B as K,af as F,ag as U}from"./vue-1731638920964.js";import{X as Z,f$ as q,ax as J,g0 as A,cY as L,g as P}from"./index-1731638920964.js";import Q from"./Title-17316389209642.js";import W from"./Title-1731638920964.js";import ee from"./AddButton-1731638920964.js";import te from"./BranchesTabs-17316389209642.js";import{t as ae,h as se,a as oe}from"./utils-17316389209643.js";import V from"./tags-1731638920964.js";import"./index-1731638920964295.js";import"./Terms-1731638920964.js";import"./WhenItem-1731638920964.js";import"./Actions-17316389209642.js";import"./util-1731638920964.js";import"./config-17316389209642.js";import"./util-17316389209642.js";import"./scene-1731638920964.js";import"./scene-17316389209642.js";import"./util-17316389209643.js";const T=e=>(F("data-v-1028e438"),e=e(),U(),e),ne={class:"card-type"},ie={class:"card-type-text"},le=["src"],ce={class:"card-content",style:{paddingTop:"40px"}},re={class:"card-content-body"},de={class:"card-item-avatar"},ue=["src"],me={class:"card-item-body"},ye={style:{"font-size":"16px","font-weight":"600"}},ge={key:0},ve=T(()=>t("div",{style:{"margin-top":"16px","margin-bottom":"8px"},class:"card-item-content-text"}," 关联条件 ",-1)),he={class:"subTitle"},pe={key:0,class:"condition-name"},fe=T(()=>t("span",{style:{"padding-right":"10px"}}," 系统时间到达 ",-1)),be={key:2},ke={class:"mask-content"},we=T(()=>t("div",null," 当前告警已关联： ",-1)),xe=["onClick"],Te={class:"card-state-content"},Be=j({name:"SceneCardBox"}),Se=j({...Be,props:{value:{type:Object,default:()=>({})},statusText:{type:String,default:"正常"},status:{type:[String,Number],default:"default"},statusNames:{type:Object,default:()=>({started:"processing",disable:"error"})},disabled:{type:Boolean,default:!1},alarmId:{type:String,default:void 0},activeKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},showMask:{type:Boolean,default:!1},showBranches:{type:Boolean,default:!0},showBindTags:{type:Boolean,default:!1},showRule:{type:Boolean,default:!0},showHistory:{type:Boolean,default:!0},maskStyle:{type:Object,default:void 0}},emits:["click","change","reload"],setup(e,{emit:k}){const i=e,v=_(!1),M=Z(),B=f(()=>{const s=i.statusNames[i.status],n=A[s]||A.default;return{background:`linear-gradient(
                188.4deg,
                rgba(${n}, 0.03) 30%,
                rgba(${n}, 0) 80%
            )`}}),r=_(!1),h=f(()=>ae.get(i.value.triggerType)||{}),S=f(()=>{var s;return se(i.value.branches,((s=i.value.options)==null?void 0:s.when)||[])}),p=f(()=>{const{data:s,invalid:n}=oe(S.value,i.activeKeys);return v.value=n&&i.showHistory,s}),z=(s,n)=>{k("change",s,n)},E=()=>{v.value||(k("click"),H())},G=()=>{var d;const s=(d=M.menus["rule-engine/Scene/Save"])==null?void 0:d.path,n=window.open(`${window.location.origin+window.location.pathname}#${s}?triggerType=${i.value.triggerType}&id=${i.value.id}`);n.onTabSaveSuccess=w=>{w.success&&k("reload")}},H=()=>{r.value=!r.value};return O(()=>i.value.id,()=>{r.value=!1}),(s,n)=>{const d=R("Ellipsis"),w=L;return o(),c("div",{class:"card j-table-card-box",onClick:E},[t("div",{class:I(["card-warp",{disabled:e.disabled}])},[t("div",ne,[t("div",ie,[t("img",{height:16,src:a(h).icon,style:{"margin-right":"5px"}},null,8,le),$(" "+x(a(h).text),1)])]),t("div",ce,[t("div",{class:"card-content-bg-item card-content-bg1",style:b(a(B))},null,4),t("div",{class:"card-content-bg-item card-content-bg2",style:b(a(B))},null,4),t("div",re,[t("div",de,[t("img",{src:a(h).img},null,8,ue)]),t("div",me,[t("div",null,[m(d,{style:{width:"calc(100% - 100px)"}},{default:y(()=>[t("span",ye,x(e.value.name),1)]),_:1}),e.showBindTags&&a(p).length&&e.value.triggerType==="device"?(o(),c("div",ge,[ve,m(V,{tags:a(p)},null,8,["tags"])])):(o(),g(d,{key:1},{default:y(()=>{var u;return[t("div",he," 说明："+x(((u=e.value)==null?void 0:u.description)||a(h).tip),1)]}),_:1}))]),e.showRule?(o(),c("div",pe,[e.value.options||e.value.triggerType==="manual"?(o(),g(ee,{key:0,style:{width:"100%",padding:"8px 12px","border-radius":"4px"},showCircular:!1},D({default:y(()=>{var u,C;return[e.value.triggerType==="device"?(o(),g(Q,{key:0,options:(u=e.value.options)==null?void 0:u.trigger},null,8,["options"])):l("",!0),e.value.triggerType==="timer"?(o(),g(W,{key:1,options:(C=e.value.options)==null?void 0:C.trigger},null,8,["options"])):l("",!0),e.value.triggerType==="manual"?(o(),c("span",be," 系统在接收到手动触发指令时，触发场景 ")):l("",!0)]}),_:2},[e.value.triggerType==="timer"?{name:"extra",fn:y(()=>[fe]),key:"0"}:void 0]),1024)):l("",!0)])):l("",!0)]),e.showMask&&a(p).length&&!a(v)?X((o(),c("div",{key:0,class:I(["card-mask",{"branches-tabs-mask":a(r)}]),style:b(e.maskStyle)},[t("div",ke,[N(s.$slots,"mask",{},()=>[we,m(V,{tags:a(p),styles:{justifyContent:"center"}},null,8,["tags"])],!0)])],6)),[[Y,!a(r)]]):l("",!0),a(v)?(o(),c("div",{key:1,class:"card-mask mask-full",style:{"background-color":"rgba(0, 0, 0, 0.2)"},onClick:K(G,["stop"])},[m(w,{style:{"font-size":"16px"},type:"link"},{default:y(()=>[$("无效数据，请重新保存场景")]),_:1})],8,xe)):l("",!0)]),e.showBranches&&a(r)?(o(),c("div",{key:0,class:"card-content-tabs",onClick:n[0]||(n[0]=K(()=>{},["stop"]))},[(o(),g(te,{branchesGroup:a(S),alarmId:e.alarmId,branchesId:e.value.id,activeKeys:e.activeKeys,selectedKeys:e.selectedKeys,triggerType:e.value.triggerType,key:e.value.id,onChange:z},null,8,["branchesGroup","alarmId","branchesId","activeKeys","selectedKeys","triggerType"]))])):l("",!0),t("div",{class:"card-state",style:b({backgroundColor:a(q)(e.statusNames[e.status])})},[t("div",Te,[m(J,{status:e.status,text:e.statusText,statusNames:e.statusNames},null,8,["status","text","statusNames"])])],4)]),N(s.$slots,"default",{},void 0,!0)],2)])}}});const Ye=P(Se,[["__scopeId","data-v-1028e438"]]);export{Ye as default};
