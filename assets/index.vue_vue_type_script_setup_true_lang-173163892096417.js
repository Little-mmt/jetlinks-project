import{h as R,ev as S,ew as T,o as A,v as E,a0 as $,$ as M,I as Q,a1 as Z,aD as w,a6 as z,a9 as X,F as G,aa as H}from"./index-1731638920964.js";import{q as K}from"./product-17316389209644.js";import{d as W,k as _,r as Y,w as V,ab as C,U as f,V as k,X as t,_ as v,f as a,u as l,E as g,Z as ee,F as ae,a1 as te,$ as oe}from"./vue-1731638920964.js";const se={style:{"margin-top":"10px"}},de=W({__name:"index",props:{data:{type:Object,default:void 0}},emits:["close","save"],setup(u,{emit:b}){const c=u,x=_([]),p=_(!1),m=_(),o=Y({productId:void 0,id:void 0,name:"",describe:"",photoUrl:R("/device/instance/device-card.png")}),P=async(s,e)=>{var i;if(!((i=c==null?void 0:c.data)!=null&&i.id)&&e){const r=await S(e);return r.status===200&&r.result?Promise.reject("ID重复"):Promise.resolve()}else return Promise.resolve()};V(()=>c.data,s=>{K({paging:!1,sorts:[{name:"createTime",order:"desc"}],terms:[{terms:[{termType:"eq",column:"state",value:1}]}]}).then(e=>{e.status===200&&(x.value=e.result)}),Object.assign(o,s),o.describe=(s==null?void 0:s.describe)||(s==null?void 0:s.description)},{immediate:!0,deep:!0});const D=()=>{b("close"),m.value.resetFields()},F=()=>{m.value.validate().then(async s=>{p.value=!0;const e={...s};e.id||delete e.id,(await T(e).finally(()=>{p.value=!1})).status===200&&(A("操作成功！"),b("save"),m.value.resetFields())}).catch(s=>{console.log("error",s)})};return(s,e)=>{var U;const i=C("JProUpload"),r=E,y=$,j=C("AIcon"),I=M,h=Q,J=Z,O=w,q=z,L=X,B=G,N=H;return f(),k(N,{maskClosable:!1,width:"650px",visible:!0,title:(U=u.data)!=null&&U.id?"编辑":"新增",onOk:F,onCancel:D,confirmLoading:l(p)},{default:t(()=>[v("div",se,[a(B,{layout:"vertical",ref_key:"formRef",ref:m,model:l(o)},{default:t(()=>[a(J,{type:"flex"},{default:t(()=>[a(y,{flex:"180px"},{default:t(()=>[a(r,{name:"photoUrl"},{default:t(()=>[a(i,{accept:"image/jpeg,image/png",modelValue:l(o).photoUrl,"onUpdate:modelValue":e[0]||(e[0]=n=>l(o).photoUrl=n)},null,8,["modelValue"])]),_:1})]),_:1}),a(y,{flex:"auto"},{default:t(()=>[a(r,{name:"id",rules:[{pattern:/^[a-zA-Z0-9_\-]+$/,message:"请输入英文或者数字或者-或者_"},{max:64,message:"最多输入64个字符"},{validator:P,trigger:"blur"}]},{label:t(()=>[v("span",null,[g(" ID "),a(I,{title:"若不填写，系统将自动生成唯一ID"},{default:t(()=>[a(j,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:t(()=>{var n;return[a(h,{value:l(o).id,"onUpdate:value":e[1]||(e[1]=d=>l(o).id=d),placeholder:"请输入ID",disabled:!!((n=u.data)!=null&&n.id)},null,8,["value","disabled"])]}),_:1},8,["rules"]),a(r,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多输入64个字符"}]},{default:t(()=>[a(h,{value:l(o).name,"onUpdate:value":e[2]||(e[2]=n=>l(o).name=n),placeholder:"请输入名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(r,{name:"productId",rules:[{required:!0,message:"请选择所属产品"}]},{label:t(()=>[v("span",null,[g("所属产品 "),a(I,{title:"只能选择“正常”状态的产品"},{default:t(()=>[a(j,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:t(()=>{var n;return[a(q,{showSearch:"",value:l(o).productId,"onUpdate:value":e[3]||(e[3]=d=>l(o).productId=d),disabled:!!((n=u.data)!=null&&n.id),placeholder:"请选择状态为“正常”的产品"},{default:t(()=>[(f(!0),ee(ae,null,te(l(x),d=>(f(),k(O,{value:d.id,key:d.id,label:d.name},{default:t(()=>[g(oe(d.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","disabled"])]}),_:1}),a(r,{label:"说明",name:"describe",rules:[{max:200,message:"最多输入200个字符"}]},{default:t(()=>[a(L,{value:l(o).describe,"onUpdate:value":e[4]||(e[4]=n=>l(o).describe=n),placeholder:"请输入说明",showCount:"",maxlength:200},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["title","confirmLoading"])}}});export{de as _};
