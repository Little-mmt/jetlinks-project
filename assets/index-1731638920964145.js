import{h as y,I as T,v as F,a8 as I,a9 as q,F as J,d as L,Z as N,aa as O,g as R}from"./index-1731638920964.js";import"./index-1731638920964290.js";import{F as D,s as E,u as M}from"./FileUpload-17316389209642.js";import{d as X,k as r,w as Z,U as p,V as _,X as s,f as n,E as w,u as t}from"./vue-1731638920964.js";const $=X({__name:"index",props:{data:{type:Object,default:()=>{}}},emits:["change"],setup(f,{emit:g}){const c=f,d=r(!1);r(!1);const v=r(),m=c.data.id,k=[{label:"Jar",value:"jar",iconUrl:y("/jar.png")},{label:"Local",value:"local",iconUrl:y("/local.png")}],a=r({type:"jar",name:"",configuration:{location:""},description:""}),x=o=>{a.value.type=o[0],a.value.configuration.location=""},h=async()=>{var i,u;const o=await((i=v.value)==null?void 0:i.validate());d.value=!0;const e=m?await M({...c.data,...o}).catch(()=>{}):await E(o).catch(()=>{});(e==null?void 0:e.status)===200&&(g("change",(e==null?void 0:e.status)===200),window.onTabSaveSuccess&&(u=e.result)!=null&&u.id&&(window.onTabSaveSuccess(e),setTimeout(()=>window.close(),300))),d.value=!1},j=()=>{h()},b=()=>{g("change",!1)};return Z(()=>c.data,o=>{var e;o.id&&(a.value=o,(e=o.type[0])!=null&&e.value&&(a.value.type=o.type.map(i=>i.value)))},{immediate:!0,deep:!0}),(o,e)=>{const i=T,u=F,U=I,C=q,S=J,V=L,B=N,P=O;return p(),_(P,{title:f.data.id?"编辑":"新增",visible:!0,width:"700px",onCancel:b},{footer:s(()=>[n(V,{key:"back",onClick:b},{default:s(()=>[w("取消")]),_:1}),n(B,{key:"submit",type:"primary",loading:t(d),onClick:j,style:{"margin-left":"8px"},hasPermission:`link/Protocol:${t(m)?"update":"add"}`},{default:s(()=>[w(" 确认 ")]),_:1},8,["loading","hasPermission"])]),default:s(()=>[n(S,{class:"form",layout:"vertical",model:t(a),name:"basic",autocomplete:"off",ref_key:"formRef",ref:v},{default:s(()=>[n(u,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称",trigger:"blur"},{max:64,message:"最多可输入64个字符"}]},{default:s(()=>[n(i,{placeholder:"请输入名称",value:t(a).name,"onUpdate:value":e[0]||(e[0]=l=>t(a).name=l)},null,8,["value"])]),_:1}),n(u,{label:"类型",name:"type",rules:[{required:!0,message:"请选择类型",trigger:"blur"}]},{default:s(()=>[n(U,{disabled:!!t(m),value:t(a).type,"onUpdate:value":e[1]||(e[1]=l=>t(a).type=l),options:k,column:2,onChange:x},null,8,["disabled","value"])]),_:1}),n(u,{label:"文件地址",name:["configuration","location"],rules:[{required:!0,message:"请输入文件地址",trigger:"blur"}]},{default:s(()=>[t(a).type==="local"?(p(),_(i,{key:0,placeholder:"请输入文件地址",value:t(a).configuration.location,"onUpdate:value":e[2]||(e[2]=l=>t(a).configuration.location=l)},null,8,["value"])):(p(),_(D,{key:1,modelValue:t(a).configuration.location,"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).configuration.location=l)},null,8,["modelValue"]))]),_:1}),n(u,{label:"说明",name:"description"},{default:s(()=>[n(C,{placeholder:"请输入说明",value:t(a).description,"onUpdate:value":e[4]||(e[4]=l=>t(a).description=l),maxlength:200,rows:3,showCount:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}});const K=R($,[["__scopeId","data-v-66ab9b92"]]);export{K as default};
