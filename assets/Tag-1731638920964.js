import{a6 as J,a0 as L,dw as N,a1 as U,d as F,e as O,g as $}from"./index-1731638920964.js";import{d as V,k as C,w as E,o as M,ab as P,U as y,Z as h,F as R,a1 as X,V as m,X as p,f as u,u as k,Y}from"./vue-1731638920964.js";const Z={key:0,class:"tagName"},q=V({name:"DeviceTag"}),z=V({...q,props:{value:{type:Array,default:()=>[]},tagData:{type:Array,default:()=>[]}},emits:["update:value","change"],setup(w,{emit:T}){const d=w,b=C([]),s=C([]),x=e=>({...e,valueType:e.valueType?e.valueType.type:"-",format:e.valueType?e.valueType.format:void 0,options:e.valueType?e.valueType.elements:void 0,value:e==null?void 0:e.value}),S=()=>{s.value.push({type:"and"})},j=e=>{s.value.splice(e,1),f()},D=(e,a)=>{const t=s.value[a];t.type=e,s.value[a]=t,f()},A=(e,a)=>{const t=s.value[a].type,n=x({...e,value:void 0,type:t});s.value[a]=n,f()},f=()=>{const e=s.value.map(a=>({column:a.id,type:a==null?void 0:a.type,value:a==null?void 0:a.value}));T("update:value",[{value:e,name:"标签"}]),T("change",[{value:e,name:"标签"}],s.value)};return E(()=>[d.tagData,d.value],([e,a])=>{var n;b.value=e.map(l=>({label:l.name,value:l.id,...l}));const t=((n=a[0])==null?void 0:n.value.map(l=>{const c=e.find(_=>_.id===l.column);return c?{...x(c),value:l==null?void 0:l.value,type:l==null?void 0:l.type}:l}))||[{}];s.value=t},{immediate:!0,deep:!0}),M(()=>{var e,a,t,n;if((a=(e=d.value)==null?void 0:e[0])!=null&&a.value){const l=[];(n=(t=d.value)==null?void 0:t[0])==null||n.value.map(c=>{const _=d.tagData.find(g=>g.id===c.column);_&&l.push({..._,...c})}),T("change",d.value,l)}}),(e,a)=>{const t=J,n=L,l=N,c=U,_=P("AIcon"),g=F,B=O;return y(),h("div",null,[(y(!0),h(R,null,X(k(s),(o,i)=>(y(),m(c,{key:o.id,gutter:24,style:{"margin-bottom":"12px"}},{default:p(()=>[u(n,{span:4},{default:p(()=>[i===0?(y(),h("span",Z," 标签选择 ")):(y(),m(t,{key:1,options:[{label:"并且",value:"and"},{label:"或者",value:"or"}],value:o==null?void 0:o.type,style:{width:"100%"},onSelect:r=>D(r,i)},null,8,["value","onSelect"]))]),_:2},1024),u(n,{span:16},{default:p(()=>[u(c,{gutter:24},{default:p(()=>[u(n,{flex:"120px"},{default:p(()=>[u(t,{style:{width:"120px"},value:o.id,placeholder:"请选择标签",options:k(b),onSelect:(r,v)=>A(v,i)},null,8,["value","options","onSelect"])]),_:2},1024),u(n,{flex:"auto"},{default:p(()=>{var r;return[u(l,{modelValue:o.value,"onUpdate:modelValue":v=>o.value=v,itemType:o.valueType,onChange:f,options:o.valueType==="enum"?(((r=o==null?void 0:o.dataType)==null?void 0:r.elements)||[]).map(v=>({label:v.text,value:v.value})):o.valueType==="boolean"?[{label:"是",value:!0},{label:"否",value:!1}]:void 0},null,8,["modelValue","onUpdate:modelValue","itemType","options"])]}),_:2},1024)]),_:2},1024)]),_:2},1024),u(n,{span:4},{default:p(()=>[u(B,null,{default:p(()=>[u(g,{style:{padding:"0 8px"},onClick:S},{default:p(()=>[u(_,{type:"PlusOutlined"})]),_:1}),k(s).length>1?(y(),m(g,{key:0,danger:"",style:{padding:"0 8px"},onClick:r=>j(i)},{default:p(()=>[u(_,{type:"DeleteOutlined"})]),_:2},1032,["onClick"])):Y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])}}});const K=$(z,[["__scopeId","data-v-0d7088dc"]]);export{K as default};
