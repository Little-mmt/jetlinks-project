import{d as nt,ac as st,k as q,aq as pt,o as mt,b as ct,ab as F,U as g,V as h,X as s,_ as b,f as u,u as a,$ as w,E as f,Y as R,a5 as ut,W as dt}from"./vue-1730252110824.js";import{X as lt,k as ft,a as _t,h as vt,eT as yt,e1 as gt,o as $,eU as ht,$ as bt,x as kt,ds as Pt,Z as Ct,e as Mt,ah as xt,ai as At,dk as wt,i as j,g as St}from"./index-1730252110824.js";import"./index-1730252110824284.js";import"./index-1730252110824287.js";import{u as Dt}from"./instance-1730252110824.js";import{_ as It}from"./index.vue_vue_type_script_setup_true_lang-173025211082416.js";import Kt from"./index-173025211082480.js";import Ft from"./index-1730252110824105.js";import Rt from"./index-173025211082473.js";import{_ as $t}from"./index.vue_vue_type_style_index_0_lang-1730252110824.js";import jt from"./index-173025211082462.js";import{_ as Bt}from"./index.vue_vue_type_script_setup_true_lang-173025211082411.js";import{_ as Tt}from"./index.vue_vue_type_script_setup_true_lang-173025211082418.js";import{_ as Lt}from"./index.vue_vue_type_script_setup_true_lang-173025211082419.js";import Ut from"./index-173025211082463.js";import Et from"./index-173025211082476.js";import{_ as Nt}from"./index.vue_vue_type_script_setup_true_lang-173025211082412.js";import Ot from"./index-173025211082472.js";import Vt from"./index-173025211082453.js";import Wt from"./index-173025211082464.js";import Jt from"./index-173025211082481.js";import zt from"./index-1730252110824122.js";import{u as Gt}from"./useParams-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082417.js";import"./product-17302521108244.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082413.js";import"./Save.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./index-1730252110824302.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082415.js";import"./Save.vue_vue_type_script_setup_true_lang-17302521108243.js";import"./index-1730252110824282.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./lodash.default-1730252110824.js";import"./throttle-1730252110824.js";import"./min-1730252110824.js";import"./isNil-1730252110824.js";import"./isUndefined-1730252110824.js";import"./difference-1730252110824.js";import"./flattenDeep-1730252110824.js";import"./sortBy-1730252110824.js";import"./unionBy-1730252110824.js";import"./uniqBy-1730252110824.js";import"./toLower-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082414.js";import"./Save.vue_vue_type_script_setup_true_lang-17302521108242.js";import"./index.vue_vue_type_script_setup_true_name_InklingModal_lang-1730252110824.js";import"./index-173025211082499.js";import"./accessConfig-1730252110824.js";import"./plugin-17302521108242.js";import"./index.vue_vue_type_style_index_0_lang-17302521108242.js";import"./index-1730252110824278.js";import"./index-1730252110824283.js";import"./vue-json-viewer-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082421.js";import"./PropertyCard-1730252110824.js";import"./index-1730252110824288.js";import"./ValueRender-1730252110824.js";import"./ValueDetail.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./index-1730252110824298.js";import"./index-1730252110824289.js";import"./Save.vue_vue_type_script_setup_true_lang-17302521108244.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082420.js";import"./TimeComponent.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./Charts.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./Chart-1730252110824.js";import"./index-1730252110824297.js";import"./PropertyAMap.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./Table-17302521108243.js";import"./Indicators-1730252110824.js";import"./map-17302521108242.js";import"./index-1730252110824104.js";import"./product-17302521108245.js";import"./encodeQuery-1730252110824.js";import"./metadata-1730252110824.js";import"./index-1730252110824103.js";import"./Base-1730252110824.js";import"./context-1730252110824.js";import"./columns-1730252110824.js";import"./utils-1730252110824.js";import"./Source-1730252110824.js";import"./Source.vue_vue_type_style_index_0_scoped_5dc360f1_lang-1730252110824.js";import"./index.vue_vue_type_script_setup_true_name_VirtualRule_lang-1730252110824.js";import"./Rule.vue_vue_type_script_setup_true_name_Rule_lang-1730252110824.js";import"./index-1730252110824304.js";import"./index-1730252110824294.js";import"./index-1730252110824296.js";import"./data-17302521108243.js";import"./index-1730252110824293.js";import"./index-1730252110824295.js";import"./ConfigParams.vue_vue_type_style_index_0_scoped_5c08861f_lang-1730252110824.js";import"./ConfigModal.vue_vue_type_script_setup_true_name_ConfigModal_lang-1730252110824.js";import"./ValueObject.vue_vue_type_script_setup_true_name_ValueObject_lang-1730252110824.js";import"./DataTypeObjectChild-1730252110824.js";import"./OtherConfigInfo.vue_vue_type_script_setup_true_name_OtherConfigInfo_lang-1730252110824.js";import"./ModelButton-1730252110824.js";import"./Metrics.vue_vue_type_script_setup_true_name_Metrics_lang-1730252110824.js";import"./ValueItem-1730252110824.js";import"./item-17302521108242.js";import"./BooleanSelect-1730252110824.js";import"./OtherSetting.vue_vue_type_style_index_0_scoped_d8c8c8c1_lang-1730252110824.js";import"./index-1730252110824276.js";import"./useRequest-1730252110824.js";import"./OutputParams.vue_vue_type_style_index_0_scoped_6ffcb997_lang-1730252110824.js";import"./Type.vue_vue_type_script_setup_true_name_DataTypeSelect_lang-1730252110824.js";import"./Constraint-1730252110824.js";import"./OtherSetting-1730252110824.js";import"./metadata-17302521108242.js";import"./PropertiesModal.vue_vue_type_script_setup_true_name_PropertiesModal_lang-1730252110824.js";import"./index-1730252110824300.js";import"./JsonView-1730252110824.js";import"./index-1730252110824285.js";import"./DetailModal-1730252110824.js";import"./FunctionModal.vue_vue_type_script_setup_true_name_FunctionModal_lang-1730252110824.js";import"./EventModal.vue_vue_type_script_setup_true_name_EventModal_lang-1730252110824.js";import"./TagsModal.vue_vue_type_script_setup_true_name_TagsModal_lang-1730252110824.js";import"./data-17302521108244.js";import"./Import-1730252110824.js";import"./index.vue_vue_type_script_setup_true_name_BindChildDevice_lang-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-17302521108249.js";import"./index.vue_vue_type_script_setup_true_lang-17302521108248.js";import"./MSelect.vue_vue_type_script_setup_true_lang-1730252110824.js";import"./PatchMapping-1730252110824.js";import"./index-1730252110824301.js";import"./initHome-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-173025211082410.js";import"./index-173025211082461.js";import"./index-173025211082458.js";import"./index-173025211082459.js";import"./EditTable-17302521108242.js";import"./index-173025211082460.js";import"./Simple-1730252110824.js";import"./Advance-1730252110824.js";import"./index-173025211082483.js";import"./MSelect.vue_vue_type_script_setup_true_lang-17302521108243.js";import"./PatchMapping-17302521108243.js";import"./MSelect.vue_vue_type_script_setup_true_lang-17302521108242.js";import"./PatchMapping-17302521108242.js";import"./index-1730252110824303.js";import"./index-173025211082451.js";import"./log-17302521108243.js";import"./Duration-1730252110824.js";import"./index.vue_vue_type_script_setup_true_lang-17302521108247.js";import"./AlarmLog-1730252110824.js";import"./index-1730252110824299.js";import"./Log-1730252110824.js";import"./LogDetail-1730252110824.js";import"./useAlarmLevel-1730252110824.js";import"./config-1730252110824.js";import"./index-173025211082452.js";import"./firmware-1730252110824.js";import"./index-173025211082449.js";import"./index.vue_vue_type_script_setup_true_name_TaskPage_lang-1730252110824.js";import"./SelectDevices-1730252110824.js";import"./index-173025211082447.js";import"./cardManagement-1730252110824.js";import"./Save.vue_vue_type_script_setup_true_lang-17302521108245.js";import"./data-17302521108245.js";import"./Guide-17302521108242.js";import"./LineChart-1730252110824.js";import"./home-17302521108242.js";import"./TimeSelect.vue_vue_type_script_setup_true_lang-17302521108242.js";const Xt={style:{display:"flex","align-items":"center"}},qt={class:"deviceDetailHead"},Ht={style:{"font-size":"14px",color:"rgba(0, 0, 0, 0.85)"}},Qt=["src"],Yt={style:{padding:"24px",height:"100%"}},Zt=nt({__name:"index",setup(te){const H=lt(),{showThreshold:Q}=ft(),Y=st(),B=Gt(),t=Dt(),k=new Map;k.set("online","success"),k.set("offline","error"),k.set("notActive","warning");const S=q(),D=[{key:"Info",tab:"实例信息"},{key:"Running",tab:"运行状态"},{key:"Metadata",tab:"物模型"},{key:"Function",tab:"设备功能"},{key:"Log",tab:"日志管理"},{key:"Shadow",tab:"设备影子"}],n=q([...D]),Z={Info:It,Metadata:Ft,Running:Kt,ChildDevice:$t,Diagnose:jt,Function:Bt,Modbus:Tt,OPCUA:Lt,EdgeMap:Ut,Parsing:Et,Log:Ot,MetadataMap:Rt,GateWay:Nt,AlarmRecord:Vt,CardManagement:zt,Firmware:Wt,Shadow:Jt},I=_t(),T=e=>{S.value=wt(`instance-editor-info-status-${e}`,"/dashboard/device/status/change/realTime",{deviceId:e}).subscribe(o=>{var r,m,p;((m=(r=o.payload)==null?void 0:r.value)==null?void 0:m.type)!==((p=t.current)==null?void 0:p.state.value)&&t.refresh(e)})},L=()=>{var o,r,m,p,l,P,C,_,M,x,A,c,d,v,y;const e=n.value.map(i=>i.key);I.hasPermission("rule-engine/Alarm/Log:view")&&j&&Q&&n.value.push({key:"AlarmRecord",tab:"预处理数据"}),I.hasPermission("iot-card/CardManagement:view")&&j&&n.value.push({key:"CardManagement",tab:"物联网卡"}),I.hasPermission("device/Firmware:view")&&((r=(o=t.current)==null?void 0:o.features)!=null&&r.find(i=>(i==null?void 0:i.id)==="supportFirmware"))&&j&&n.value.push({key:"Firmware",tab:"远程升级"}),(m=t.current)!=null&&m.protocol&&!["modbus-tcp","opc-ua"].includes((p=t.current)==null?void 0:p.protocol)&&!e.includes("Diagnose")&&n.value.push({key:"Diagnose",tab:"设备诊断"}),(P=(l=t.current)==null?void 0:l.features)!=null&&P.find(i=>(i==null?void 0:i.id)==="transparentCodec")&&!e.includes("Parsing")&&n.value.push({key:"Parsing",tab:"数据解析"}),((C=t.current)==null?void 0:C.protocol)==="modbus-tcp"&&!e.includes("Modbus")&&n.value.push({key:"Modbus",tab:"数采映射"}),((_=t.current)==null?void 0:_.protocol)==="opc-ua"&&!e.includes("OPCUA")&&n.value.push({key:"OPCUA",tab:"数采映射"}),((M=t.current)==null?void 0:M.protocol)==="collector-gateway"&&!e.includes("GateWay")&&n.value.push({key:"GateWay",tab:"数采映射"}),((A=(x=t.current)==null?void 0:x.deviceType)==null?void 0:A.value)==="gateway"&&!e.includes("ChildDevice")&&n.value.push({key:"ChildDevice",tab:"子设备"}),((c=t.current)==null?void 0:c.accessProvider)==="edge-child-device"&&((d=t.current)!=null&&d.parentId)&&!e.includes("EdgeMap")&&n.value.push({key:"EdgeMap",tab:"边缘端映射"}),(y=(v=t.current)==null?void 0:v.features)!=null&&y.find(i=>(i==null?void 0:i.id)==="diffMetadataSameProduct")&&!e.includes("MetadataMap")&&n.value.push({key:"MetadataMap",tab:"物模型映射"})},tt=async e=>{await t.refresh(String(e)),T(String(e)),n.value=[...D],L(),t.tabActiveKey="Info"};pt(e=>{var o,r;((o=e.params)==null?void 0:o.id)!==t.current.id&&e.name==="device/Instance/Detail"&&tt((r=e.params)==null?void 0:r.id)});const et=async()=>{var o;const e=(o=Y.params)==null?void 0:o.id;e&&(await t.refresh(String(e)),T(String(e)),n.value=[...D],L()),t.tabActiveKey=B.params.value.tab||"Info"},U=e=>{t.tabActiveKey==="Metadata"?yt.emit("MetadataTabs",()=>{t.tabActiveKey=e}):t.tabActiveKey=e},ot=()=>{var e,o;if((e=t.current)!=null&&e.id){const r=gt((o=t.current)==null?void 0:o.id);return r.then(m=>{var p;m.status===200&&($("操作成功！"),t.refresh((p=t.current)==null?void 0:p.id))}),r}},rt=()=>{var e,o;if((e=t.current)!=null&&e.id){const r=ht((o=t.current)==null?void 0:o.id);return r.then(m=>{var p;m.status===200&&($("操作成功！"),t.refresh((p=t.current)==null?void 0:p.id))}),r}},it=async()=>{var e,o;(e=t.current)!=null&&e.id&&(await t.refresh((o=t.current)==null?void 0:o.id),$("操作成功"))},at=()=>{var e;H.jumpPage("device/Product/Detail",{id:(e=t.current)==null?void 0:e.productId})};return mt(()=>{et()}),ct(()=>{t.current={},S.value&&S.value.unsubscribe()}),(e,o)=>{const r=bt,m=kt,p=Pt,l=Ct,P=F("AIcon"),C=Mt,_=xt,M=At,x=F("FullPage"),A=F("page-container");return g(),h(A,{tabList:a(n),showBack:!0,tabActiveKey:a(t).tabActiveKey,onTabChange:U},{title:s(()=>{var c;return[b("div",Xt,[u(r,{title:(c=a(t).current)==null?void 0:c.name},{default:s(()=>{var d;return[b("div",qt,w((d=a(t).current)==null?void 0:d.name),1)]}),_:1},8,["title"]),u(m,{type:"vertical"}),u(C,null,{default:s(()=>{var d,v,y,i,E,N,O,V,W,J,z,G,X;return[b("span",Ht,[f(" 状态： "),u(p,{status:a(k).get((v=(d=a(t).current)==null?void 0:d.state)==null?void 0:v.value)},null,8,["status"]),f(" "+w((i=(y=a(t).current)==null?void 0:y.state)==null?void 0:i.text),1)]),((N=(E=a(t).current)==null?void 0:E.state)==null?void 0:N.value)==="notActive"?(g(),h(l,{key:0,type:"link",style:{"margin-top":"-5px",padding:"0 20px"},popConfirm:{title:"确认启用设备",onConfirm:ot},hasPermission:"device/Instance:action"},{default:s(()=>[f(" 启用设备 ")]),_:1},8,["popConfirm"])):R("",!0),((V=(O=a(t).current)==null?void 0:O.state)==null?void 0:V.value)==="online"?(g(),h(l,{key:1,type:"link",style:{"margin-top":"-5px",padding:"0 20px"},popConfirm:{title:"确认断开连接？",onConfirm:rt},hasPermission:"device/Instance:action"},{default:s(()=>[f(" 断开连接 ")]),_:1},8,["popConfirm"])):R("",!0),((W=a(t).current)==null?void 0:W.accessProvider)==="child-device"&&((z=(J=a(t).current)==null?void 0:J.state)==null?void 0:z.value)==="offline"?(g(),h(r,{key:2,title:(X=(G=a(t).current)==null?void 0:G.features)!=null&&X.find(K=>(K==null?void 0:K.id)==="selfManageState")?"该设备的在线状态与父设备(网关设备)保持一致":"该设备在线状态由设备自身运行状态决定，不继承父设备（网关设备）的在线状态"},{default:s(()=>[u(P,{type:"QuestionCircleOutlined",style:{"font-size":"14px"}})]),_:1},8,["title"])):R("",!0)]}),_:1})])]}),content:s(()=>[u(M,{size:"small",column:4},{default:s(()=>[u(_,{label:"ID"},{default:s(()=>{var c;return[f(w((c=a(t).current)==null?void 0:c.id),1)]}),_:1}),u(_,{label:"所属产品"},{default:s(()=>[u(l,{type:"link",style:{"margin-top":"-5px",padding:"0"},onClick:at,hasPermission:"device/Product:view"},{default:s(()=>{var c;return[f(w((c=a(t).current)==null?void 0:c.productName),1)]}),_:1})]),_:1})]),_:1})]),extra:s(()=>[b("img",{onClick:it,src:a(vt)("/device/button.png"),style:{"margin-right":"20px",cursor:"pointer"}},null,8,Qt)]),default:s(()=>[u(x,null,{default:s(()=>[b("div",Yt,[(g(),h(ut(Z[a(t).tabActiveKey]),dt({type:"device"},{onOnJump:U}),null,16))])]),_:1})]),_:1},8,["tabList","tabActiveKey"])}}});const ri=St(Zt,[["__scopeId","data-v-e50e92fe"]]);export{ri as default};
