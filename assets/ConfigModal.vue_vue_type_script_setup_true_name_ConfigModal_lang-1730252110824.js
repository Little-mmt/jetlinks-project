import{F as j,e_ as I,e$ as U,f0 as R,f1 as N,f2 as S,f3 as B,f4 as P,f5 as q,f6 as F,aC as T}from"./index-1730252110824.js";import{_ as A}from"./ValueObject.vue_vue_type_script_setup_true_name_ValueObject_lang-1730252110824.js";import J from"./DataTypeObjectChild-1730252110824.js";import{_ as L}from"./OtherConfigInfo.vue_vue_type_script_setup_true_name_OtherConfigInfo_lang-1730252110824.js";import{c as M,T as D,h as E}from"./columns-1730252110824.js";import u from"./ModelButton-1730252110824.js";import{d as h,k as _,w as Z,u as e,U as i,V as p,X as l,f as r,E as z,$ as G,G as c,Z as K}from"./vue-1730252110824.js";const X={key:9},H=h({name:"ConfigModal"}),oe=h({...H,props:{value:{type:Object,default:()=>({})},valueKey:{type:String,default:"valueType"},showOther:{type:Boolean,default:!0}},emits:["update:value"],setup(v,{emit:x}){var g;const f=v,C=j.useInjectFormItemContext(),k=()=>({id:void 0,name:void 0,valueType:{type:void 0}});_([]);const s=_((g=f.value)==null?void 0:g.type),{unitOptions:y}=M(s),n=_(f.value),O=[{title:"参数标识",dataIndex:"id",type:"text",width:100,placement:"Left",form:{required:!0,rules:[{callback(o,t,a){if(t){const d=o.field.split("."),b=Number(d[1]);return a.some((w,$)=>w.id===t&&b!==$)?Promise.reject("该标识已存在"):Promise.resolve()}return Promise.reject("请输入标识")}},{max:64,message:"最多可输入64个字符"},{pattern:/^[a-zA-Z0-9_\-]+$/,message:"标识只能由数字、字母、下划线、中划线组成"}]}},{title:"参数名称",dataIndex:"name",type:"text",width:100,form:{required:!0,rules:[{required:!0,message:"请输入参数名称"},{max:64,message:"最多可输入64个字符"}]}},{title:"数据类型",type:"components",dataIndex:"valueType",components:{name:A},form:{required:!0,rules:[{validator(o,t){return t!=null&&t.type?Promise.resolve():Promise.reject("请选择数据类型")}}]},control(o,t){var a;return o.valueType.type!==((a=t==null?void 0:t.valueType)==null?void 0:a.type)},width:100},{title:"其他配置",type:"components",dataIndex:"config",components:{name:J},width:100,control(o,t){if(o&&!t)return!0;if(o&&t){const a=T(o.valueType,["type"]),d=T(t.valueType,["type"]);return JSON.stringify(a)!==JSON.stringify(d)}return!1}},{title:"操作",dataIndex:"action",width:60}],m=o=>{const t=E(s.value,o);x("update:value",{type:s.value,...t}),C.onFieldChange()};return Z(()=>JSON.stringify(f.value),()=>{var o;console.log(f.value),s.value=(o=f.value)==null?void 0:o.type,n.value=f.value}),(o,t)=>e(s)==="array"?(i(),p(e(I),{key:0,value:e(n).elementType,"onUpdate:value":t[0]||(t[0]=a=>e(n).elementType=a),unitOptions:e(y),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["value","unitOptions"])):e(s)==="object"&&v.showOther?(i(),p(e(U),{key:1,value:e(n).properties,placement:"topRight",onAdd:k,columns:O,onConfirm:m},{valueType:l(({data:a})=>{var d;return[z(G(e(D)[(d=a.record.valueType)==null?void 0:d.type]),1)]}),config:l(({data:a})=>[r(L,{value:a.record.valueType},null,8,["value"])]),default:l(()=>[r(u)]),_:1},8,["value"])):e(s)==="enum"?(i(),p(e(R),{key:2,value:e(n),"onUpdate:value":t[1]||(t[1]=a=>c(n)?n.value=a:null),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["value"])):e(s)==="boolean"?(i(),p(e(N),{key:3,value:e(n),"onUpdate:value":t[2]||(t[2]=a=>c(n)?n.value=a:null),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["value"])):["float","double"].includes(e(s))?(i(),p(e(S),{key:4,options:e(y),showUnit:!1,value:e(n),"onUpdate:value":t[3]||(t[3]=a=>c(n)?n.value=a:null),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["options","value"])):["int","long"].includes(e(s))&&v.showOther?(i(),p(e(B),{key:5,options:e(y),value:e(n).unit,"onUpdate:value":t[4]||(t[4]=a=>e(n).unit=a),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["options","value"])):e(s)==="file"?(i(),p(e(P),{key:6,value:e(n).bodyType,"onUpdate:value":t[5]||(t[5]=a=>e(n).bodyType=a),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["value"])):e(s)==="date"?(i(),p(e(q),{key:7,value:e(n).format,"onUpdate:value":t[6]||(t[6]=a=>e(n).format=a),placement:"topRight",onConfirm:m},{default:l(()=>[r(u)]),_:1},8,["value"])):["string","password"].includes(e(s))?(i(),p(e(F),{key:8,value:e(n).maxLength,"onUpdate:value":t[7]||(t[7]=a=>e(n).maxLength=a),placement:"topRight"},{default:l(()=>[r(u)]),_:1},8,["value"])):(i(),K("span",X," 无 "))}});export{oe as _};
