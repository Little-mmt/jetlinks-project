import{au as Y,d3 as s,ds as j,e as w,a3 as O,aa as H,g as V}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{C as $}from"./config-17302521108242.js";import{_ as D}from"./Record.vue_vue_type_script_setup_true_lang-1730252110824.js";import{d as J,e as N,w as B,k as E,ab as f,U as _,V as y,X as a,f as o,u as l,E as M,$ as z,Y as A,a4 as q,n as i}from"./vue-1730252110824.js";import"./vue-json-viewer-1730252110824.js";import"./template-1730252110824.js";const L=J({__name:"index",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}},emits:["update:visible","cancel"],setup(n,{emit:c}){const x=n,v=N({get:()=>x.visible,set:e=>c("update:visible",e)});B(()=>v.value,e=>{e&&d({terms:[]})});const r=[{title:"ID",dataIndex:"id",key:"id",search:{type:"string"}},{title:"发送时间",dataIndex:"notifyTime",key:"notifyTime",scopedSlots:!0,search:{type:"date",handleValue:e=>e}},{title:"状态",dataIndex:"state",key:"state",scopedSlots:!0,search:{type:"select",options:[{label:"成功",value:"success"},{label:"失败",value:"error"}],handleValue:e=>e}},{title:"操作",key:"action",scopedSlots:!0}],p=E({}),d=e=>{p.value=e},b=e=>{s.info({title:"错误信息",content:i("p",{style:{maxHeight:"300px",overflowY:"auto"}},JSON.stringify(e))})},g=e=>{Object.keys(e.context).length==0?s.info({title:"详情信息",content:i("p",{style:{maxHeight:"300px",overflowY:"auto"}},"模板中不存在变量")}):s.info({title:"详情信息",content:i(D,{data:e,style:{maxHeight:"300px",overflowY:"auto"}})})};return(e,m)=>{const h=f("pro-search"),k=j,u=f("AIcon"),C=w,S=O,I=H;return _(),y(I,{visible:"",title:"通知记录",footer:null,width:"70%",onCancel:m[0]||(m[0]=t=>c("cancel"))},{default:a(()=>[o(h,{type:"simple",columns:r,onSearch:d}),o(S,{ref:"logRef",model:"table",columns:r,request:t=>l($).getHistory(t,n.data.id),defaultParams:{pageSize:5,sorts:[{name:"notifyTime",order:"desc"}],terms:[{column:"notifyType$IN",value:n.data.type}]},params:l(p),pagination:{pageSizeOptions:["5","10","20","50","100"]}},{notifyTime:a(t=>[M(z(l(Y)(t.notifyTime).format("YYYY-MM-DD HH:mm:ss")),1)]),state:a(t=>[o(C,null,{default:a(()=>[o(k,{status:t.state.value,text:t.state.text},null,8,["status","text"]),t.state.value==="error"?(_(),y(u,{key:0,type:"ExclamationCircleOutlined",style:{color:"#1d39c4",cursor:"pointer"},onClick:T=>b(t.errorStack)},null,8,["onClick"])):A("",!0)]),_:2},1024)]),action:a(t=>[o(u,{type:"ExclamationCircleOutlined",class:q(Object.keys(t.context).length==0?"disableIcon":"Icon"),onClick:T=>g(t)},null,8,["class","onClick"])]),_:1},8,["request","defaultParams","params"])]),_:1})}}});const ae=V(L,[["__scopeId","data-v-3bb25a7c"]]);export{ae as default};
