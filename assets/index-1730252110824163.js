import{d as W,ad as Y,ac as Z,k as c,o as ee,ab as A,U as le,V as ae,X as a,f as e,u as s,E as p,_ as n,af as te,ag as se}from"./vue-1730252110824.js";import{h as j,o as oe,aH as ne,I as ue,v as re,a0 as de,aJ as ie,aK as pe,$ as _e,a6 as me,a7 as ve,a1 as ce,w as fe,d as Ie,F as ge,dv as Pe,du as be,aI as he,g as Se}from"./index-1730252110824.js";import"./index-1730252110824288.js";import"./index-1730252110824298.js";import"./index-1730252110824283.js";import"./index-1730252110824279.js";import{c as P}from"./cascade-1730252110824.js";import{a as we}from"./regular-1730252110824.js";const r=I=>(te("data-v-cdbdd392"),I=I(),se(),I),xe={class:"doc"},ye=r(()=>n("h1",null,"1.概述",-1)),Ue=r(()=>n("div",null," 配置国标级联，平台可以将已经接入到自身的摄像头共享给第三方调用播放。 ",-1)),je=r(()=>n("h1",null,"2.配置说明",-1)),qe=r(()=>n("div",null," 以下配置说明以将本平台数据级联到LiveGBS平台为例。 ",-1)),De=r(()=>n("h2",null,"1、上级SIP ID",-1)),Ce=r(()=>n("div",null,[p("请填写第三方平台中配置的"),n("b",null,"SIP ID"),p("。")],-1)),Ne={class:"image"},Le=r(()=>n("h2",null,"2、上级SIP 域",-1)),ke=r(()=>n("div",null,[p("请填写第三方平台中配置的"),n("b",null,"SIP ID域"),p("。")],-1)),Ae={class:"image"},Ee=r(()=>n("h2",null,"3、上级SIP 地址",-1)),Te=r(()=>n("div",null,[p("请填写第三方平台中配置的"),n("b",null,"SIP ID地址"),p("。")],-1)),Be={class:"image"},He=r(()=>n("h2",null,"4、本地SIP ID",-1)),Je=r(()=>n("div",null,[p(" 请填写本地的"),n("b",null,"SIP ID地址"),p("。 地址由中心编码(8位)、行业编码(2位)、类型编码(3位)和序号(7位)四个码段共20位十 进制数字字符构成。详细规则请参见《GB/T28181-2016》中附录D部分。 ")],-1)),$e=r(()=>n("h2",null,"5、SIP本地地址",-1)),Re=r(()=>n("div",null,[p(" 请选择"),n("b",null,"指定的网卡和端口"),p("，如有疑问请联系系统运维人员。 ")],-1)),Ve=r(()=>n("h2",null,"6、用户",-1)),Fe=r(()=>n("div",null,[p(" 部分平台有基于用户和接入密码的特殊认证。通常情况下,请填写"),n("b",null,"本地SIP ID"),p("值。 ")],-1)),Ge=r(()=>n("h2",null,"7、接入密码",-1)),Oe=r(()=>n("div",null," 需与上级平台设置的接入密码一致，用于身份认证。 ",-1)),Me=r(()=>n("h2",null,"8、厂商/型号/版本号",-1)),Qe=r(()=>n("div",null," 本平台将以“设备”的身份级联到上级平台，请设置本平台在上级平台中显示的厂商、型号、版本号。 ",-1)),Ke=r(()=>n("h2",null,"9、心跳周期",-1)),Xe=r(()=>n("div",null," 需与上级平台设置的心跳周期保持一致，通常默认60秒。 ",-1)),ze=r(()=>n("h2",null,"10、注册间隔",-1)),We=r(()=>n("div",null," 若SIP代理通过注册方式校时,其注册间隔时间宜设置为小于 SIP代理与 SIP服务器出现1s误 差所经过的运行时间。 ",-1)),Ye=W({__name:"index",setup(I){const E=Y(),b=Z(),t=c({id:b.query.id||void 0,cascadeName:void 0,proxyStream:!1,clusterNodeId:void 0,name:void 0,sipId:void 0,domain:void 0,remoteAddress:void 0,remotePort:void 0,localSipId:void 0,host:void 0,port:void 0,publicHost:void 0,publicPort:void 0,transport:"UDP",user:void 0,password:void 0,manufacturer:void 0,model:void 0,firmware:void 0,keepaliveInterval:"60",registerInterval:"3600"}),q=c([]),T=async()=>{const{result:d}=await P.clusters();q.value=d.map(l=>({label:l.name,value:l.id}))},h=c([]),B=async()=>{const{result:d}=await P.all();h.value=d.map(l=>({label:l.host,value:l.host,...l})),w()},H=()=>{t.value.host=void 0,t.value.port=void 0,w()},S=c([]),w=()=>{var d,l;if(!t.value.host){S.value=[];return}S.value=(l=(d=h.value.find(v=>v.host===t.value.host))==null?void 0:d.ports[t.value.transport||""])==null?void 0:l.map(v=>({label:v,value:v}))},J=async()=>{if(!b.query.id)return;const d=await P.detail(b.query.id),{id:l,name:v,proxyStream:_,sipConfigs:i,...u}=d.result;Object.keys(t.value).forEach(m=>{m==="id"?t.value[m]=l:m==="cascadeName"?t.value[m]=v:m==="proxyStream"?t.value[m]=_:t.value[m]=i[0][m]})},$=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\.|$)){4}$/,R=(d,l)=>D(l,t.value.remotePort),V=(d,l)=>D(l,t.value.publicPort),D=(d,l)=>{if(d)if(d){if(d&&!$.test(d)&&!we.test(d))return Promise.reject(new Error("请输入正确的IP地址"));if(l){if(l&&Number(l)<1||Number(l)>65535)return Promise.reject(new Error("端口请输入1~65535之间的正整数"))}else return Promise.reject(new Error("请输入端口"))}else return Promise.reject(new Error("请输入IP 地址"));else return Promise.resolve();return Promise.resolve()},F=(d,l)=>{if(l)if(l){if(!t.value.port)return Promise.reject(new Error("请选择端口"))}else return Promise.reject(new Error("请选择IP地址"));else return Promise.resolve();return Promise.resolve()},C=c(),x=c(!1),G=()=>{C.value.validate().then(()=>{const{id:d,cascadeName:l,proxyStream:v,..._}=t.value,i={id:d,name:l,proxyStream:v,sipConfigs:[{..._}]};x.value=!0,P[d?"update":"save"](i).then(()=>{oe("操作成功"),E.back()}).finally(()=>{x.value=!1})}).catch(d=>{console.log("err: ",d)})};return ee(async()=>{await J(),T(),B()}),(d,l)=>{const v=ne,_=ue,i=re,u=de,m=ie,N=pe,L=A("AIcon"),k=_e,y=me,g=ve,f=ce,O=fe,M=Ie,Q=ge,K=Pe,U=be,X=he,z=A("page-container");return le(),ae(z,null,{default:a(()=>[e(X,null,{default:a(()=>[e(f,{gutter:24},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(Q,{ref_key:"formRef",ref:C,layout:"vertical",model:s(t)},{default:a(()=>[e(f,{gutter:24},{default:a(()=>[e(v,{data:"基本信息"}),e(u,{span:12},{default:a(()=>[e(i,{label:"名称",name:"cascadeName",rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).cascadeName,"onUpdate:value":l[0]||(l[0]=o=>s(t).cascadeName=o),placeholder:"请输入名称"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"代理视频流",name:"proxyStream",rules:[{required:!0,message:"请选择代理视频流"}]},{default:a(()=>[e(N,{"button-style":"solid",value:s(t).proxyStream,"onUpdate:value":l[1]||(l[1]=o=>s(t).proxyStream=o)},{default:a(()=>[e(m,{value:!0},{default:a(()=>[p(" 启用 ")]),_:1}),e(m,{value:!1},{default:a(()=>[p(" 禁用 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(v,{data:"信令服务配置"}),e(u,{span:12},{default:a(()=>[e(i,{name:"clusterNodeId",rules:[{required:!0,message:"请选择集群节点"}]},{label:a(()=>[n("span",null,[p(" 集群节点 "),e(k,{title:"使用此集群节点级联到上级平台"},{default:a(()=>[e(L,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:a(()=>[e(y,{value:s(t).clusterNodeId,"onUpdate:value":l[2]||(l[2]=o=>s(t).clusterNodeId=o),placeholder:"请选择集群节点",options:s(q)},null,8,["value","options"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"信令名称",name:"name",rules:[{required:!0,message:"请输入信令名称"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).name,"onUpdate:value":l[3]||(l[3]=o=>s(t).name=o),placeholder:"请输入信令名称"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:24},{default:a(()=>[e(i,{label:"上级SIP ID",name:"sipId",rules:[{required:!0,message:"请输入上级SIP ID"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).sipId,"onUpdate:value":l[4]||(l[4]=o=>s(t).sipId=o),placeholder:"请输入上级SIP ID"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"上级SIP域",name:"domain",rules:[{required:!0,message:"请输入上级平台SIP域"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).domain,"onUpdate:value":l[5]||(l[5]=o=>s(t).domain=o),placeholder:"请输入上级平台SIP域"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"上级SIP 地址",name:"remoteAddress",rules:[{required:!0,message:"请输入上级SIP 地址"},{validator:R}]},{default:a(()=>[e(f,{gutter:10},{default:a(()=>[e(u,{span:14},{default:a(()=>[e(_,{value:s(t).remoteAddress,"onUpdate:value":l[6]||(l[6]=o=>s(t).remoteAddress=o),placeholder:"请输入IP地址"},null,8,["value"])]),_:1}),e(u,{span:10},{default:a(()=>[e(g,{min:1,max:65535,value:s(t).remotePort,"onUpdate:value":l[7]||(l[7]=o=>s(t).remotePort=o),placeholder:"请输入端口",style:{width:"100%"},precision:0},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["rules"])]),_:1}),e(u,{span:24},{default:a(()=>[e(i,{label:"本地SIP ID",name:"localSipId",rules:[{required:!0,message:"请输入网关侧的SIP ID"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).localSipId,"onUpdate:value":l[8]||(l[8]=o=>s(t).localSipId=o),placeholder:"网关侧的SIP ID"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{name:"host",rules:[{required:!0,message:"请选择SIP本地地址"},{validator:F}]},{label:a(()=>[n("span",null,[p(" SIP本地地址 "),e(k,{title:"使用指定的网卡和端口进行请求"},{default:a(()=>[e(L,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:a(()=>[e(f,{gutter:10},{default:a(()=>[e(u,{span:14},{default:a(()=>[e(y,{value:s(t).host,"onUpdate:value":l[9]||(l[9]=o=>s(t).host=o),placeholder:"请选择IP地址",options:s(h),onChange:w,showSearch:""},null,8,["value","options"])]),_:1}),e(u,{span:10},{default:a(()=>[e(y,{value:s(t).port,"onUpdate:value":l[10]||(l[10]=o=>s(t).port=o),placeholder:"请选择端口",options:s(S)},null,8,["value","options"])]),_:1})]),_:1})]),_:1},8,["rules"])]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"SIP远程地址",name:"publicHost",rules:[{required:!0,message:"请输入SIP远程地址"},{validator:V}]},{default:a(()=>[e(f,{gutter:10},{default:a(()=>[e(u,{span:14},{default:a(()=>[e(_,{value:s(t).publicHost,"onUpdate:value":l[11]||(l[11]=o=>s(t).publicHost=o),placeholder:"请输入IP地址"},null,8,["value"])]),_:1}),e(u,{span:10},{default:a(()=>[e(g,{min:1,max:65535,value:s(t).publicPort,"onUpdate:value":l[12]||(l[12]=o=>s(t).publicPort=o),placeholder:"请输入端口",style:{width:"100%"},precision:0},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["rules"])]),_:1}),e(u,{span:24},{default:a(()=>[e(i,{label:"传输协议",name:"transport",rules:[{required:!0,message:"请选择传输协议"}]},{default:a(()=>[e(N,{"button-style":"solid",value:s(t).transport,"onUpdate:value":l[13]||(l[13]=o=>s(t).transport=o),onChange:H},{default:a(()=>[e(m,{value:"UDP"},{default:a(()=>[p(" UDP ")]),_:1}),e(m,{value:"TCP"},{default:a(()=>[p(" TCP ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"用户",name:"user",rules:[{required:!0,message:"请输入用户"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).user,"onUpdate:value":l[14]||(l[14]=o=>s(t).user=o),placeholder:"请输入用户"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"接入密码",name:"password",rules:[{required:!0,message:"请输入接入密码"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(O,{value:s(t).password,"onUpdate:value":l[15]||(l[15]=o=>s(t).password=o),placeholder:"请输入接入密码"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"厂商",name:"manufacturer",rules:[{required:!0,message:"请输入厂商"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).manufacturer,"onUpdate:value":l[16]||(l[16]=o=>s(t).manufacturer=o),placeholder:"请输入厂商"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"型号",name:"model",rules:[{required:!0,message:"请输入型号"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).model,"onUpdate:value":l[17]||(l[17]=o=>s(t).model=o),placeholder:"请输入型号"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"版本号",name:"firmware",rules:[{required:!0,message:"请输入版本号"},{max:64,message:"最多可输入64个字符"}]},{default:a(()=>[e(_,{value:s(t).firmware,"onUpdate:value":l[18]||(l[18]=o=>s(t).firmware=o),placeholder:"请输入版本号"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"心跳周期（秒）",name:"keepaliveInterval",rules:[{required:!0,message:"请输入心跳周期"},{pattern:/^[1-9]\d*$/,message:"请输入1~10000的整数"}]},{default:a(()=>[e(g,{min:1,max:1e4,value:s(t).keepaliveInterval,"onUpdate:value":l[19]||(l[19]=o=>s(t).keepaliveInterval=o),placeholder:"请输入心跳周期",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(i,{label:"注册间隔（秒）",name:"registerInterval",rules:[{required:!0,message:"请输入注册间隔"},{pattern:/^[1-9]\d*$/,message:"请输入1~10000的整数"}]},{default:a(()=>[e(g,{min:1,max:1e4,value:s(t).registerInterval,"onUpdate:value":l[20]||(l[20]=o=>s(t).registerInterval=o),placeholder:"请输入注册间隔",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(M,{type:"primary",onClick:G,loading:s(x)},{default:a(()=>[p(" 保存 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),e(u,{span:12},{default:a(()=>[n("div",xe,[ye,Ue,n("div",null,[e(K,{message:"注：该配置只用于将本平台向上级联至第三方平台，如需第三方平台向上级联至本平台，请在“视频设备”页面新增设备时选择“GB/T28181”接入方式。",type:"info","show-icon":""})]),je,qe,De,Ce,n("div",Ne,[e(U,{width:"100%",src:s(j)("/northbound/doc2.png")},null,8,["src"])]),Le,ke,n("div",Ae,[e(U,{width:"100%",src:s(j)("/northbound/doc1.png")},null,8,["src"])]),Ee,Te,n("div",Be,[e(U,{width:"100%",src:s(j)("/northbound/doc3.png")},null,8,["src"])]),He,Je,$e,Re,Ve,Fe,Ge,Oe,Me,Qe,Ke,Xe,ze,We])]),_:1})]),_:1})]),_:1})]),_:1})}}});const ul=Se(Ye,[["__scopeId","data-v-cdbdd392"]]);export{ul as default};
