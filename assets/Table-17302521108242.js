import{d as F,k as j,r as A,w as P,ab as x,U as _,V as g,X as n,u as d,f as s,E as v,$ as C,Z as R,F as J,a1 as Z,Y as H,v as D,A as B,_ as X}from"./vue-1730252110824.js";import{I as Y,v as z,aD as G,a6 as K,C as Q,a7 as W,Z as ee,af as ae,F as te,g as oe}from"./index-1730252110824.js";import"./index-1730252110824280.js";import{g as le}from"./collector-1730252110824.js";import{B as ne,r as ce}from"./data-17302521108242.js";import{_ as se}from"./PropertyId.vue_vue_type_script_setup_true_name_propertyId_lang-1730252110824.js";import{E as re}from"./index-1730252110824294.js";import"./index-1730252110824295.js";import"./index-1730252110824293.js";import"./validate-1730252110824.js";import"./regular-1730252110824.js";import"./index-1730252110824296.js";import"./context-1730252110824.js";import"./columns-1730252110824.js";import"./data-17302521108243.js";import"./sortBy-1730252110824.js";const ue={style:{color:"red"}},ie=F({__name:"Table",props:{data:{type:Array,default:()=>[]},collectorData:{type:Object,default:()=>{}}},emits:["change"],setup(T,{expose:M,emit:L}){const I=T,S=j(),w=["accessModes","interval","features"],i=A({dataSource:[]}),V=(l,o)=>new Promise(async(r,c)=>{if(o)return String(o).length>64?c("最多可输入64个字符"):r("");r("")}),U=(l,o)=>o.label.toLowerCase().indexOf(l.toLowerCase())>=0,N=(l,o)=>{L("change",l,o)},p=(l,o)=>{const{dataSource:r}=i;return o==="interval"?r[l].configuration[o]:r[l][o]},h=(l,o)=>{const{dataSource:r}=i,c=p(l,o);for(let f=l+1;f<r.length;f++){const m=p(f,o);if(!m.check)return;m.value=c.value}},y=async(l,o)=>{setTimeout(()=>{let r=0;const{dataSource:c}=i;if(!p(l,o).check)return;for(let u=l;u>=0;u--)if(!p(u,o).check){r=u;break}const m=p(r,o);for(let u=r;u<c.length-1;u++){const k=p(u+1,o);if(!k.check)return;k.value=m.value}},0)},b=j([]);return(async()=>{const l=await le();l.success&&(b.value=l.result)})(),M({validate:()=>new Promise((l,o)=>{S.value.validate().then(()=>{l(i.dataSource)}).catch(r=>{o(r)})})}),P(()=>I.data.length,(l,o)=>{const r=I.data;i.dataSource=r,console.log(l,o),o!==0&&o<l?w.forEach(c=>{l===2?h(0,c):y(l-1,c)}):o===0&&l>1&&w.forEach(c=>{h(0,c)})}),(l,o)=>{const r=Y,c=z,f=G,m=K,u=Q,k=W,$=x("AIcon"),E=ee,q=ae,O=te;return _(),g(O,{class:"table",ref_key:"formTableRef",ref:S,model:d(i)},{default:n(()=>[d(i).dataSource.length!==0?(_(),g(d(re),{key:0,dataSource:d(i).dataSource,columns:d(ne),height:580,cellHeight:80,disableMenu:!1,pagination:!1,serial:!1},{name:n(({record:e,index:a})=>[s(c,{name:["dataSource",a,"name"],rules:[{required:!0,message:"请输入"},{validator:V,trigger:"change"}]},{default:n(()=>[s(r,{value:e.name,"onUpdate:value":t=>e.name=t,placeholder:"请输入",style:{width:"80%"},allowClear:""},null,8,["value","onUpdate:value"])]),_:2},1032,["name","rules"])]),type:n(({record:e})=>[s(c,null,{default:n(()=>{var a;return[v(C((a=e.objectId)==null?void 0:a.type),1)]}),_:2},1024)]),instanceNumber:n(({record:e})=>[s(c,null,{default:n(()=>{var a;return[v(C((a=e.objectId)==null?void 0:a.instanceNumber),1)]}),_:2},1024)]),propertyId:n(({record:e,index:a})=>[s(c,{name:["dataSource",a,"propertyId"],rules:{required:!0,message:"请选择"}},{default:n(()=>[s(se,{value:e.propertyId,"onUpdate:value":t=>e.propertyId=t,valueTypeList:d(b),collectorId:T.collectorData.collectorId,objectId:e.objectId,checkedList:d(i).dataSource,index:a},null,8,["value","onUpdate:value","valueTypeList","collectorId","objectId","checkedList","index"])]),_:2},1032,["name"])]),valueType:n(({record:e,index:a})=>[s(c,{name:["dataSource",a,"valueType"],rules:{required:!0,message:"请选择"}},{default:n(()=>[s(m,{value:e.valueType,"onUpdate:value":t=>e.valueType=t,style:{width:"80%"},placeholder:"请选择"},{default:n(()=>[(_(!0),R(J,null,Z(d(b),t=>(_(),g(f,{key:t,value:t},{default:n(()=>[v(C(t),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])]),accessModes:n(({record:e,index:a})=>[s(c,{class:"form-item",name:["dataSource",a,"accessModes","value"],rules:[{required:!0,message:"请选择"}]},{default:n(()=>[s(m,{style:{width:"72%"},value:e.accessModes.value,"onUpdate:value":t=>e.accessModes.value=t,placeholder:"请选择",allowClear:"",mode:"multiple","filter-option":U,options:[{label:"读",value:"read"},{label:"写",value:"write"},{label:"订阅",value:"subscribe"}],disabled:a!==0&&e.accessModes.check,onChange:t=>h(a,"accessModes")},null,8,["value","onUpdate:value","disabled","onChange"]),a!==0?(_(),g(u,{key:0,style:{"margin-left":"5px"},checked:e.accessModes.check,"onUpdate:checked":t=>e.accessModes.check=t,onClick:t=>y(a,"accessModes")},{default:n(()=>[v("同上")]),_:2},1032,["checked","onUpdate:checked","onClick"])):H("",!0)]),_:2},1032,["name"])]),interval:n(({record:e,index:a})=>[s(c,{class:"form-item",name:["dataSource",a,"configuration","interval","value"],rules:[{required:!0,message:"请输入"},{pattern:d(ce),message:"请输入0或者正整数"}]},{default:n(()=>[s(k,{style:{width:"60%"},value:e.configuration.interval.value,"onUpdate:value":t=>e.configuration.interval.value=t,placeholder:"请输入",allowClear:"","addon-after":"ms",max:2147483647,min:0,disabled:a!==0&&e.configuration.interval.check,onBlur:t=>h(a,"interval")},null,8,["value","onUpdate:value","disabled","onBlur"]),D(s(u,{style:{"margin-left":"5px","margin-top":"5px"},checked:e.configuration.interval.check,"onUpdate:checked":t=>e.configuration.interval.check=t,onClick:t=>y(a,"interval")},{default:n(()=>[v("同上")]),_:2},1032,["checked","onUpdate:checked","onClick"]),[[B,a!==0]])]),_:2},1032,["name","rules"])]),features:n(({record:e,index:a})=>[s(c,{class:"form-item",name:["dataSource",a,"features","value"],rules:[{required:!0,message:"请选择"}]},{default:n(()=>[s(m,{style:{width:"45%"},value:e.features.value,"onUpdate:value":t=>e.features.value=t,placeholder:"请选择",allowClear:"","filter-option":U,options:[{label:"是",value:!0},{label:"否",value:!1}],disabled:a!==0&&e.features.check,onChange:t=>h(a,"features")},null,8,["value","onUpdate:value","disabled","onChange"]),D(s(u,{style:{"margin-left":"5px"},checked:e.features.check,"onUpdate:checked":t=>e.features.check=t,onClick:t=>y(a,"features")},{default:n(()=>[v("同上")]),_:2},1032,["checked","onUpdate:checked","onClick"]),[[B,a!==0]])]),_:2},1032,["name"])]),action:n(({record:e,index:a})=>[s(E,{type:"text",tooltip:{title:"删除"},popConfirm:{title:"确认删除？",onConfirm:()=>N(e.nodeId,a)}},{default:n(()=>[X("a",ue,[s($,{type:"DeleteOutlined"})])]),_:2},1032,["popConfirm"])]),_:1},8,["dataSource","columns"])):(_(),g(q,{key:1,style:{"margin-top":"10%"}}))]),_:1},8,["model"])}}});const De=oe(ie,[["__scopeId","data-v-d7d477f3"]]);export{De as default};
