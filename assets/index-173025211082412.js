import{d as N,Z as K,aa as w,g as P}from"./index-1730252110824.js";import{a as S}from"./collector-1730252110824.js";import V from"./Table-17302521108242.js";import L from"./Tree-17302521108242.js";import{d as M,k as l,U as $,V as J,X as r,f as d,E as k,u as o,_ as O}from"./vue-1730252110824.js";import"./index-1730252110824280.js";import"./data-17302521108242.js";import"./validate-1730252110824.js";import"./regular-1730252110824.js";import"./PropertyId.vue_vue_type_script_setup_true_name_propertyId_lang-1730252110824.js";import"./index-1730252110824294.js";import"./index-1730252110824296.js";import"./context-1730252110824.js";import"./columns-1730252110824.js";import"./data-17302521108243.js";import"./index-1730252110824293.js";import"./index-1730252110824295.js";import"./sortBy-1730252110824.js";import"./index-1730252110824281.js";const R={class:"content"},E=M({__name:"index",props:{data:{type:Array,default:()=>[]}},emits:["change"],setup(I,{emit:u}){const i=I,m=l(i.data),p=l(!1),_=l(),t=l([]),x=l(),B=async()=>{var s;const a=await((s=_.value)==null?void 0:s.validate().catch(()=>{}));if(!a)return;const c=a.map(e=>{var v,y,b,h,g,C;return{name:e.name,provider:"BACNetIp",collectorId:(v=i.data)==null?void 0:v.id,collectorName:(y=i.data)==null?void 0:y.name,pointKey:e.id,configuration:{interval:(h=(b=e.configuration)==null?void 0:b.interval)==null?void 0:h.value,valueType:e.valueType,propertyId:e.propertyId,objectId:e.objectId},pointKey:`${e.objectId.type}:${e.objectId.instanceNumber}:${e.propertyId}`,features:(g=e.features)!=null&&g.value?["changedOnly"]:[],accessModes:((C=e.accessModes)==null?void 0:C.value)||[]}});p.value=!0;const n=await S([...c]).catch(()=>{});u("change",(n==null?void 0:n.status)===200),p.value=!1},f=()=>{u("change",!1)},T=a=>{t.value.push(a)},A=a=>{t.value=a},D=()=>{console.log("cancelALl"),t.value=[]},j=(a,c)=>{t.value.splice(c,1)};return(a,c)=>{const n=N,s=K,e=w;return $(),J(e,{title:"扫描",visible:!0,width:"95%",maskClosable:!1,onCancel:f},{footer:r(()=>[d(n,{key:"back",onClick:f},{default:r(()=>[k("取消")]),_:1}),d(s,{key:"submit",type:"primary",loading:o(p),onClick:B,style:{"margin-left":"8px"},hasPermission:"DataCollect/Collector:update"},{default:r(()=>[k(" 确认 ")]),_:1},8,["loading"])]),default:r(()=>[O("div",R,[d(L,{data:o(m),tableData:o(t),class:"tree",onChange:T,onAddAll:A,onCancelAll:D,unSelectKeys:o(x)},null,8,["data","tableData","unSelectKeys"]),d(V,{data:o(t),collectorData:o(m),class:"table",onChange:j,ref_key:"formTableRef",ref:_},null,8,["data","collectorData"])])]),_:1})}}});const re=P(E,[["__scopeId","data-v-b4d97716"]]);export{re as default};
