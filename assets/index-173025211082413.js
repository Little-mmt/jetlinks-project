import{a4 as M,b4 as P,aD as L,a6 as S,v as $,a8 as R,$ as Z,a7 as z,aE as G,C as Q,aG as X,F as Y,d as q,Z as H,aa as K,g as W}from"./index-1730252110824.js";import"./index-1730252110824280.js";import"./index-1730252110824290.js";import{g as ee,a as ae}from"./collector-1730252110824.js";import{r as te}from"./data-17302521108242.js";import{d as oe,k as f,w as se,e as ne,ab as le,U as i,V as m,X as t,f as s,E as _,u as o,_ as w,$ as x,Z as ce,F as ue,a1 as re,Y as N}from"./vue-1730252110824.js";import"./validate-1730252110824.js";import"./regular-1730252110824.js";const pe={class:"sizeText"},ie=oe({__name:"index",props:{data:{type:Array,default:()=>[]},provider:{type:String,default:""}},emits:["change"],setup(v,{emit:g}){const y=v,h=f(!1),I=f(),e=f({accessModes:[],interval:void 0,features:[],valueType:void 0,pushControl:!1}),T=f([]),O=async()=>{const a=await ee();a.success&&(T.value=a.result)},U=async()=>{const a=M(e.value),{accessModes:n,features:b,interval:r,valueType:u,pushControl:C}=a;if(n.length!==0||C||Number(r)===0||!!r||!!u){const d=M(y.data);d.forEach(l=>{n.length!==0?l.accessModes=a.accessModes:P(l.accessModes)&&(l.accessModes=l.accessModes.map(k=>k.value)),b.length!==0?l.features=a.features:l.features=[],(r||Number(r)===0)&&(l.interval=a.interval,l.configuration={...l.configuration,interval:a.interval}),a.valueType&&(l.configuration={...l.configuration,valueType:a.valueType})}),h.value=!0;const p=await ae(d).catch(()=>{});g("change",(p==null?void 0:p.status)===200),h.value=!1}else g("change",!0)},j=()=>{g("change",!1)};se(()=>y.provider,()=>{y.provider==="BACNetIp"&&O()},{immediate:!0});const V=ne(()=>{const a=[];return e.value.accessModes.length&&a.push("访问类型"),e.value.interval&&a.push("采集频率"),e.value.features.length&&a.push("只推送变化的数据"),e.value.type&&a.push("数据类型"),e.value.valueType&&a.push("值类型"),a});return(a,n)=>{const b=L,r=S,u=$,C=R,B=le("AIcon"),d=Z,p=z,l=G,k=Q,A=X,D=Y,E=q,F=H,J=K;return i(),m(J,{title:"批量编辑",visible:!0,width:"700px",onCancel:j,destroyOnClose:!0},{footer:t(()=>[s(E,{key:"back",onClick:j},{default:t(()=>[_("取消")]),_:1}),s(F,{key:"submit",type:"primary",loading:o(h),onClick:U,style:{"margin-left":"8px"},hasPermission:"DataCollect/Collector:update"},{default:t(()=>[_(" 确认 ")]),_:1},8,["loading"])]),default:t(()=>[w("div",pe," 将批量修改 "+x(v.data.length)+" 条数据的【"+x(o(V).join(","))+"】 ",1),s(D,{class:"form",layout:"vertical",model:o(e),name:"basic",autocomplete:"off",ref_key:"formRef",ref:I},{default:t(()=>[v.provider==="BACNetIp"?(i(),m(u,{key:0,label:"值类型"},{default:t(()=>[s(r,{value:o(e).valueType,"onUpdate:value":n[0]||(n[0]=c=>o(e).valueType=c),allowClear:"",placeholder:"请选择值类型"},{default:t(()=>[(i(!0),ce(ue,null,re(o(T),c=>(i(),m(b,{key:c,value:c},{default:t(()=>[_(x(c),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):N("",!0),s(u,{label:"访问类型",name:"accessModes"},{default:t(()=>[s(C,{multiple:"",showImage:!1,value:o(e).accessModes,"onUpdate:value":n[1]||(n[1]=c=>o(e).accessModes=c),options:[{label:"读",value:"read"},{label:"写",value:"write"},{label:"订阅",value:"subscribe"}]},null,8,["value"])]),_:1}),s(u,{name:["interval"],rules:[{pattern:o(te),message:"请输入0或者正整数"}]},{label:t(()=>[w("span",null,[_(" 采集频率 "),s(d,{title:"采集频率为0时不执行轮询任务"},{default:t(()=>[s(B,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:t(()=>[s(p,{style:{width:"100%"},placeholder:"请输入采集频率",value:o(e).interval,"onUpdate:value":n[2]||(n[2]=c=>o(e).interval=c),"addon-after":"ms",max:2147483648,min:0,precision:0},null,8,["value"])]),_:1},8,["rules"]),s(u,{label:"推送控制"},{default:t(()=>[s(l,{checked:o(e).pushControl,"onUpdate:checked":n[3]||(n[3]=c=>o(e).pushControl=c)},null,8,["checked"])]),_:1}),o(e).pushControl?(i(),m(u,{key:1,name:["features"]},{default:t(()=>[s(A,{value:o(e).features,"onUpdate:value":n[4]||(n[4]=c=>o(e).features=c)},{default:t(()=>[s(k,{value:"changedOnly",name:"type"},{default:t(()=>[_("只推送变化的数据")]),_:1})]),_:1},8,["value"])]),_:1})):N("",!0)]),_:1},8,["model"])]),_:1})}}});const be=W(ie,[["__scopeId","data-v-b59ab84e"]]);export{be as default};
