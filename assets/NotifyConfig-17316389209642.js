import{Z as M,a0 as $,a1 as q,a2 as O,a3 as j,g as F}from"./index-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import{C as H}from"./config-17316389209642.js";import{M as K,N as V}from"./const-17316389209642.js";import{n as S}from"./data-17316389209647.js";import{d as W,k as _,w as Z,ab as u,U as z,Z as G,_ as c,f as o,X as s,E as m,W as L,u as f,R as U,$ as y,F as X,af as Y,ag as P}from"./vue-1731638920964.js";const w=d=>(Y("data-v-39f1d059"),d=d(),P(),d),Q={class:"header"},ee={class:"alert"},te={style:{"max-height":"400px","overflow-y":"auto"}},oe=["src"],ae={style:{"font-size":"16px","font-weight":"600"}},ne=w(()=>c("div",{class:"card-item-content-text"}," 通知方式 ",-1)),se=w(()=>c("div",{class:"card-item-content-text"},"说明",-1)),ie=W({__name:"NotifyConfig",props:{notifyType:{type:String,default:""},value:{type:String,default:""}},emits:["update:value","change"],setup(d,{emit:r}){const l=d,x=(e,t)=>{var n;return(n=K[e].find(p=>p.value===t))==null?void 0:n.logo},b=e=>{var t;return(t=V.find(n=>n.value===e))==null?void 0:t.label},v=_({}),a=_([]),g=_(),h=[{title:"名称",dataIndex:"name",key:"name",search:{type:"string"}},{title:"ID",dataIndex:"id",key:"id",search:{type:"string"}},{title:"说明",dataIndex:"description",key:"description",search:{type:"string"}}],k=e=>H.list({...e,terms:[...e==null?void 0:e.terms,{terms:[{termType:"eq",column:"type",value:S.get(l.notifyType)},{termType:"not",column:"provider",type:"and",value:"dingTalkRobotWebHook"}]}],sorts:[{name:"id",value:l.value},{name:"createTime",order:"desc"}]}),I=e=>{v.value=e},R=e=>{a.value=[...e]},N=e=>{a.value.includes(e.id)?(a.value=[],r("update:value",void 0),r("change",{provider:void 0,value:void 0})):(a.value=[e.id],r("update:value",e.id),r("change",{provider:e==null?void 0:e.provider,value:e.id}))},E=()=>{const e=window.open(`${origin}/#/iot/notice/Config/detail/:id?notifyType=${S.get(l.notifyType)}`);e.onTabSaveSuccess=t=>{var n;a.value=[t.id],r("update:value",t.id),r("change",{provider:t==null?void 0:t.provider,value:t.id}),(n=g.value)==null||n.reload()}};return Z(()=>l.value,e=>{e?a.value=[e]:a.value=[]},{deep:!0,immediate:!0}),(e,t)=>{const n=u("pro-search"),p=M,B=u("AIcon"),C=u("Ellipsis"),T=$,A=q,D=O,J=j;return z(),G(X,null,[c("div",Q,[o(n,{columns:h,type:"simple",target:"action-notice-config",onSearch:I,class:"action-search",style:{"padding-bottom":"0"}}),o(p,{onClick:E,type:"primary",hasPermission:["notice/Config:add"]},{default:s(()=>[m(" 新增 ")]),_:1})]),c("div",ee,[o(B,{type:"InfoCircleOutlined"}),m(" 钉钉群机器人类型的配置在当前页面将被过滤 ")]),c("div",te,[o(J,{columns:h,request:k,model:"CARD",bodyStyle:{padding:0},ref_key:"tableRef",ref:g,alertRender:!1,params:f(v),gridColumn:3,rowSelection:{selectedRowKeys:f(a),onChange:R}},{card:s(i=>[o(D,L({showStatus:!1,value:i,showTool:!1,actions:[]},i,{onClick:N,active:f(a).includes(i.id)}),{img:s(()=>[U(e.$slots,"img",{},()=>[c("img",{src:x(i.type,i.provider),class:"notify-logo"},null,8,oe)],!0)]),content:s(()=>[o(C,{style:{width:"calc(100% - 100px)"}},{default:s(()=>[c("span",ae,y(i.name),1)]),_:2},1024),o(A,null,{default:s(()=>[o(T,{span:12},{default:s(()=>[ne,c("div",null,y(b(i.type)),1)]),_:2},1024),o(T,{span:12},{default:s(()=>[se,o(C,null,{default:s(()=>[m(y(i.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1040,["value","active"])]),_:3},8,["params","rowSelection"])])],64)}}});const ge=F(ie,[["__scopeId","data-v-39f1d059"]]);export{ge as default};
