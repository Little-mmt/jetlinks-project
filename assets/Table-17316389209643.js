import{au as V,eM as P,d as R,e as U,aT as F,a9 as q,I as K,aa as X,g as Z}from"./index-1731638920964.js";import"./index-1731638920964282.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import{u as G}from"./instance-1731638920964.js";import{V as Q,g as W}from"./ValueRender-1731638920964.js";import{J as ee}from"./vue-json-viewer-1731638920964.js";import{d as te,k as g,e as j,w as ae,ab as oe,U as u,Z as D,_ as Y,f as y,X as _,F as z,E as ne,$ as se,u as a,Y as k,V as p,af as le,ag as ie}from"./vue-1731638920964.js";import"./ValueDetail.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./index-1731638920964298.js";import"./index-1731638920964289.js";const ue=l=>(le("data-v-741755a8"),l=l(),ie(),l),pe=ue(()=>Y("div",null,"自定义属性",-1)),de=te({__name:"Table",props:{data:{type:Object,default:()=>{}},time:{type:Array,default:()=>[]}},setup(l){const o=l,w=G(),d=g({pageIndex:0,pageSize:12,data:[],total:0}),v=g({}),f=g(!1),$=j(()=>{var e,n,r;const t=[{title:"时间",dataIndex:"timestamp",key:"timestamp",ellipsis:!0},{title:((e=o.data)==null?void 0:e.name)||"",dataIndex:"value",key:"value",ellipsis:!0}];return((r=(n=o.data)==null?void 0:n.valueType)==null?void 0:r.type)!="geoPoint"&&t.push({title:"操作",dataIndex:"action",key:"action"}),t}),B=j(()=>{var t,e,n;return((t=o.data.valueType)==null?void 0:t.type)==="file"&&((n=(e=o.data)==null?void 0:e.valueType)==null?void 0:n.bodyType)==="Binary(二进制)"}),L=t=>{f.value=!0,v.value=t},S=async t=>{const e=await P(w.current.id,o.data.id,{...t,sorts:[{name:"timestamp",order:"desc"}],terms:[{terms:[{column:"timestamp",termType:"btw",value:o.time}]}]});e.status===200&&(d.value=e.result)};ae(()=>[o.data.id,o.time],([t])=>{var e;t&&((e=o.time)!=null&&e.length)&&S({pageSize:12,pageIndex:0})},{deep:!0,immediate:!0});const M=t=>{S({pageSize:t.pageSize,pageIndex:Number(t.current)-1||0})},N=t=>{const e=document.createElement("a");e.download=`${w.current.name}-${o.data.name}${V(new Date().getTime()).format("YYYY-MM-DD-HH-mm-ss")}.txt`,e.style.display="none";const n=new Blob([t.value]);e.href=URL.createObjectURL(n),document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(t,e)=>{var T,I,x,h;const n=oe("AIcon"),r=R,O=U,J=F,H=q,A=K,E=X;return u(),D(z,null,[Y("div",null,[y(J,{columns:a($),size:"small",rowKey:"id",dataSource:(T=a(d))==null?void 0:T.data,onChange:M,pagination:{current:(((I=a(d))==null?void 0:I.pageIndex)||0)+1,pageSize:((x=a(d))==null?void 0:x.pageSize)||12,showSizeChanger:!0,showLessItems:!0,total:((h=a(d))==null?void 0:h.total)||0,pageSizeOptions:["12","24","48","96"]}},{bodyCell:_(({column:i,record:s})=>[i.key==="timestamp"?(u(),D(z,{key:0},[ne(se(a(V)(s.timestamp).format("YYYY-MM-DD HH:mm:ss")),1)],64)):k("",!0),i.key==="value"?(u(),p(Q,{key:1,type:"table",data:o.data,value:{...s}},null,8,["data","value"])):i.key==="action"?(u(),p(O,{key:2},{default:_(()=>{var m,c;return[a(B)||!a(W)(s==null?void 0:s.value)&&((c=(m=l.data)==null?void 0:m.valueType)==null?void 0:c.bodyType)==="base64"?(u(),p(r,{key:0,type:"link",onClick:b=>N(s)},{default:_(()=>[y(n,{type:"DownloadOutlined"})]),_:2},1032,["onClick"])):k("",!0),y(r,{type:"link",onClick:b=>L(s)},{default:_(()=>[y(n,{type:"SearchOutlined"})]),_:2},1032,["onClick"])]}),_:2},1024)):k("",!0)]),_:1},8,["columns","dataSource","pagination"])]),y(E,{title:"详情",visible:a(f),onOk:e[0]||(e[0]=i=>f.value=!1),onCancel:e[1]||(e[1]=i=>f.value=!1)},{default:_(()=>{var i,s,m,c,b,C;return[pe,((s=(i=l.data)==null?void 0:i.valueType)==null?void 0:s.type)==="object"||((c=(m=l.data)==null?void 0:m.valueType)==null?void 0:c.type)==="array"?(u(),p(a(ee),{key:0,"expand-depth":5,value:a(v).formatValue},null,8,["value"])):((C=(b=l.data)==null?void 0:b.valueType)==null?void 0:C.type)==="file"?(u(),p(H,{key:1,value:a(v).formatValue,row:3},null,8,["value"])):(u(),p(A,{key:2,disabled:"",value:a(v).formatValue},null,8,["value"]))]}),_:1},8,["visible"])],64)}}});const Te=Z(de,[["__scopeId","data-v-741755a8"]]);export{Te as default};
