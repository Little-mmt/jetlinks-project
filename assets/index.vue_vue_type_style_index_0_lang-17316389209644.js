import{c as R,p as I,d as C,ac as S,k as b,w as j,o as q,ab as M,U as i,Z as g,_ as u,u as a,V as h,G as Y,f as p,E as f,$ as w,X as x,Y as Z}from"./vue-1731638920964.js";import{o as B,aE as $,ds as G,Z as K,d9 as O,cY as X}from"./index-1731638920964.js";import"./index-1731638920964306.js";import z from"./index-1731638920964157.js";import{u as F}from"./useRequest-1731638920964.js";import{d as H}from"./auto-1731638920964.js";const D=Symbol("auto-video-detail"),J=()=>R(D),pe=_=>{I(D,_)},L={class:"rule-item"},Q=u("span",null,"计划状态：",-1),W={key:1},ee={class:"rule-item"},te=u("div",null,[f(" 保存周期（天）"),u("span",{style:{color:"red","margin-right":"10px"}},"*")],-1),se={key:1},ae=u("div",{class:"retentionCycleTip"}," 超出保存周期的录像文件将被自动删除 ",-1),oe={style:{"margin-bottom":"24px"}},ne=C({name:"Rule"}),_e=C({...ne,props:{first:{type:Boolean,default:!0}},setup(_){const E=_,P=S(),n=b(),t=J(),d=b(),{run:V,loading:T}=F(H,{immediate:!1,onSuccess(){B("操作成功"),n.value=!1}}),U=s=>{const e=[];return s.forEach(l=>{l.times.length!==0&&l.times.forEach(o=>{o!=null&&o.from&&e.push(o)})}),e},A=()=>{var o;const s=U((o=t.value)==null?void 0:o.others.times),e=s.map(c=>c.when[0]),l={trigger:t.value.others.trigger,mod:"once"};if(t.value.others.trigger==="week"?(l.when=e,t.value.others.durations=s):(l.scheduleTags=e,t.value.others.durations=s.map(c=>{const{when:m,...v}=c;return{...v,scheduleTags:m}})),t.value.state.value=d.value,t.value.schedules=[l],!t.value.saveDays){B("请输入保存周期","error");return}V(t.value)};return j(()=>{var s,e;return(e=(s=t.value)==null?void 0:s.state)==null?void 0:e.value},()=>{var s,e;d.value=(e=(s=t.value)==null?void 0:s.state)==null?void 0:e.value},{immediate:!0}),q(()=>{var s;E.first?n.value=((s=P.query)==null?void 0:s.type)==="edit":n.value=!1}),(s,e)=>{var y,k;const l=$,o=G,c=M("AIcon"),m=K,v=O,N=X;return i(),g("div",null,[u("div",L,[Q,a(n)?(i(),h(l,{key:0,checked:a(d),"onUpdate:checked":e[0]||(e[0]=r=>Y(d)?d.value=r:null),checkedValue:"enabled","un-checked-value":"disabled"},null,8,["checked"])):(i(),g("div",W,[p(o,{status:((y=a(t).state)==null?void 0:y.value)==="enabled"?"success":"error"},null,8,["status"]),f(" "+w(((k=a(t).state)==null?void 0:k.value)==="enabled"?"正常":"禁用")+" ",1),p(m,{type:"link",hasPermission:"device/Instance:action",onClick:e[1]||(e[1]=r=>n.value=!0)},{default:x(()=>[p(c,{type:"EditOutlined"})]),_:1})]))]),u("div",ee,[te,a(n)?(i(),h(v,{key:0,precision:0,min:1,max:99999,placeholder:"请输入录像文件保存天数",style:{width:"200px"},value:a(t).saveDays,"onUpdate:value":e[2]||(e[2]=r=>a(t).saveDays=r)},null,8,["value"])):(i(),g("div",se,w(a(t).saveDays),1)),ae]),u("div",oe,[p(z,{value:a(t).others.times,"onUpdate:value":e[3]||(e[3]=r=>a(t).others.times=r),trigger:a(t).others.trigger,"onUpdate:trigger":e[4]||(e[4]=r=>a(t).others.trigger=r),disabled:!a(n)},null,8,["value","trigger","disabled"])]),a(n)?(i(),h(N,{key:0,type:"primary",loading:a(T),onClick:A},{default:x(()=>[f("保存")]),_:1},8,["loading"])):Z("",!0)])}}});export{_e as _,pe as u};
