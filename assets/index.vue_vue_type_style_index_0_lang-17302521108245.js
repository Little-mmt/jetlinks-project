import{o as b,aE as A,ds as I,Z as M,d9 as R,cY as S}from"./index-1730252110824.js";import"./index-1730252110824306.js";import Y from"./index-1730252110824157.js";import{d as w,ac as Z,k as x,c as $,w as j,o as q,ab as O,U as d,Z as _,_ as r,V as m,f as p,u as n,E as h,$ as B,X as C,Y as X}from"./vue-1730252110824.js";import{d as z}from"./auto-1730252110824.js";const F={class:"rule-item"},G=r("span",null,"计划状态：",-1),H={key:1},J={class:"rule-item"},K=r("div",null,[h("保存周期（天）"),r("span",{style:{color:"red"}},"*")],-1),L={key:1,style:{"margin-left":"10px"}},Q=r("div",{class:"retentionCycleTip"}," 超出保存周期的抓拍文件将被自动删除 ",-1),W=w({name:"Rule"}),oe=w({...W,props:{first:{type:Boolean,default:!0}},setup(V){const E=V,D=Z(),o=x(),t=$("detail"),c=x(),U=s=>{const e=[];return s.forEach(a=>{a.times.length!==0&&a.times.forEach(l=>{var i;((i=l==null?void 0:l.period)==null?void 0:i.from)!==""&&e.push(l)})}),e},N=async()=>{var a;const s=U((a=t.value)==null?void 0:a.others.times);if(t.value.state.value=c.value,t.value.others.trigger==="week"?t.value.schedules=s:t.value.schedules=s.map(l=>{const{when:i,...v}=l;return{...v,scheduleTags:i}}),!t.value.saveDays){b("请输入保存周期","error");return}(await z(t.value)).success&&(b("操作成功"),o.value=!1)};return j(()=>{var s,e;return(e=(s=t.value)==null?void 0:s.state)==null?void 0:e.value},s=>{var e,a;c.value=(a=(e=t.value)==null?void 0:e.state)==null?void 0:a.value},{immediate:!0}),q(()=>{var s;E.first?o.value=((s=D.query)==null?void 0:s.type)==="edit":o.value=!1}),(s,e)=>{var y,f,g,k;const a=A,l=I,i=O("AIcon"),v=M,P=R,T=S;return d(),_("div",null,[r("div",F,[G,o.value?(d(),m(a,{key:0,checked:c.value,"onUpdate:checked":e[0]||(e[0]=u=>c.value=u),checkedValue:"enabled",unCheckedValue:"disabled"},null,8,["checked"])):(d(),_("div",H,[p(l,{status:((f=(y=n(t))==null?void 0:y.state)==null?void 0:f.value)==="enabled"?"success":"error"},null,8,["status"]),h(" "+B(((k=(g=n(t))==null?void 0:g.state)==null?void 0:k.value)==="enabled"?"正常":"禁用")+" ",1),p(v,{type:"link",hasPermission:!0,onClick:e[1]||(e[1]=u=>o.value=!0)},{default:C(()=>[p(i,{type:"EditOutlined"})]),_:1})]))]),r("div",J,[K,o.value?(d(),m(P,{key:0,precision:0,min:1,max:99999,placeholder:"请输入抓拍文件保存天数",value:n(t).saveDays,"onUpdate:value":e[2]||(e[2]=u=>n(t).saveDays=u),style:{width:"200px"}},null,8,["value"])):(d(),_("div",L,B(n(t).saveDays),1)),Q]),r("div",null,[p(Y,{value:n(t).others.times,"onUpdate:value":e[3]||(e[3]=u=>n(t).others.times=u),trigger:n(t).others.trigger,"onUpdate:trigger":e[4]||(e[4]=u=>n(t).others.trigger=u),type:"timing",disabled:!o.value},null,8,["value","trigger","disabled"])]),o.value?(d(),m(T,{key:0,style:{"margin-top":"20px"},type:"primary",onClick:N},{default:C(()=>[h("保存")]),_:1})):X("",!0)])}}});export{oe as _};
