import{i as T,dk as x,a6 as U,g as C}from"./index-1730252110824.js";import{s as N}from"./dashboard-1730252110824.js";import r from"./TopEchartsItemNode-1730252110824.js";import{m as j}from"./map-17302521108242.js";import{d as h,k as u,o as k,b as M,w as V,U as g,Z as G,_ as l,u as e,V as I,Y as w,f as c}from"./vue-1730252110824.js";import"./index-1730252110824297.js";import"./tool-1730252110824.js";const B={class:"dash-board"},F={class:"dash-board-items"},H={class:"dash-board-item"},$={class:"dash-board-item"},E={class:"dash-board-item"},J={class:"dash-board-item"},S=h({name:"TopCard"}),D=h({...S,emits:["serviceChange"],setup(O,{emit:b}){const m=u(),i=u([]),t=u({cpu:0,jvm:0,jvmTotal:0,usage:0,usageTotal:0,systemUsage:0,systemUsageTotal:0}),d=u(),f=a=>{m.value=a},_=()=>{d.value&&d.value.unsubscribe()},p=()=>{const a="operations-statistics-system-info-realTime",n="/dashboard/systemMonitor/stats/info/realTime";_(),d.value=x(a,n,{type:"all",serverNodeId:m.value,interval:"1s",agg:"avg"}).pipe(j(s=>s.payload)).subscribe(s=>{const{value:{cpu:y,memory:o,disk:v}}=s;t.value={cpu:y.systemUsage,jvm:Number((o.jvmHeapUsage/100*(o.jvmHeapTotal/1024)).toFixed(1)),jvmTotal:Math.ceil(o.jvmHeapTotal/1024),usage:Number((v.total/1024*(v.usage/100)).toFixed(1)),usageTotal:Math.ceil(v.total/1024),systemUsage:Number((o.systemTotal/1024*(o.systemUsage/100)).toFixed(1)),systemUsageTotal:Math.ceil(o.systemTotal/1024)}})};return k(()=>{console.log("isNoCommunity"),T?N().then(a=>{var n;a.success&&(i.value=a.result.map(s=>({label:s.name,value:s.id})),i.value.length&&(m.value=(n=i.value[0])==null?void 0:n.value))}):p()}),M(()=>{_()}),V(()=>m.value,a=>{a&&p(),b("serviceChange",a)}),(a,n)=>{const s=U;return g(),G("div",null,[l("div",B,[e(i).length>1?(g(),I(s,{key:0,options:e(i),value:e(m),style:{width:"300px","margin-bottom":"20px"},onChange:f},null,8,["options","value"])):w("",!0),l("div",F,[l("div",H,[c(r,{value:e(t).cpu,title:"CPU使用率"},null,8,["value"])]),l("div",$,[c(r,{bottom:`总JVM内存 ${e(t).jvmTotal}G`,max:e(t).jvmTotal,value:e(t).jvm,formatter:"G",title:"JVM内存"},null,8,["bottom","max","value"])]),l("div",E,[c(r,{bottom:`总磁盘大小 ${e(t).usageTotal}G`,max:e(t).usageTotal,value:e(t).usage,formatter:"G",title:"磁盘占用"},null,8,["bottom","max","value"])]),l("div",J,[c(r,{bottom:`系统内存 ${e(t).systemUsageTotal}G`,max:e(t).systemUsageTotal,value:e(t).systemUsage,formatter:"G",title:"系统内存"},null,8,["bottom","max","value"])])])])])}}});const A=C(D,[["__scopeId","data-v-091c5514"]]);export{A as default};
