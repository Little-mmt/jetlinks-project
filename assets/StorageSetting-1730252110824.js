import{f7 as B,aC as U,dw as F,aT as L,K as N}from"./index-1730252110824.js";import"./index-1730252110824276.js";import"./index-1730252110824282.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import{u as K}from"./product-17302521108245.js";import{u as M}from"./instance-1730252110824.js";import{b as O,e as $}from"./product-17302521108244.js";import{d as C,c as z,k as f,w as P,U as m,Z as h,a1 as R,V as w,X as V,f as X,u as l,F as b,E as Y,$ as Z,Y as q}from"./vue-1730252110824.js";import"./encodeQuery-1730252110824.js";const A=C({name:"StorageSetting"}),ie=C({...A,props:{type:{type:String,default:void 0},record:{type:Object,default:void 0},visible:{type:Boolean,default:!1}},setup(T,{expose:I}){var _;const p=T,S=K(),k=M(),D=z(B),y=f([]),a=f((_=p.record)==null?void 0:_.expands),E=f([{title:"参数名称",dataIndex:"name",width:150,ellipsis:!0},{title:"输入类型",dataIndex:"type",width:150},{title:"值",dataIndex:"value"}]),j=async()=>{var i;const{type:o,record:e}=p,r=o==="product"?(i=S.current)==null?void 0:i.id:k.current.id;if(console.log(e.id,r,e.valueType),!e.id||!r||!e.valueType.type)return;const u={deviceId:r,metadata:{id:e.id,type:"property",dataType:e.valueType.type}},n=o==="product"?await O(u):await $(u);n.status===200&&(y.value=n.result,n.result.length&&!a.value&&n.result.forEach(d=>{d.properties&&d.properties.forEach(c=>{a.value[c.property]=void 0})}))};return P(()=>p.visible,()=>{var o;p.visible&&(a.value=U((o=p.record)==null?void 0:o.expands,["source","type","metrics"]),j())},{immediate:!0}),I({getData:()=>a.value}),(o,e)=>{const r=F,u=L,n=N;return m(!0),h(b,null,R(l(y),(i,d)=>(m(),w(n,{key:"store_"+d,header:i.name},{default:V(()=>[X(u,{columns:l(E),"data-source":i.properties,pagination:!1,rowKey:"id"},{bodyCell:V(({column:c,record:t,index:H})=>{var v,g,x;return[c.dataIndex==="type"?(m(),h(b,{key:0},[Y(Z((v=t.type)==null?void 0:v.name),1)],64)):c.dataIndex==="value"?(m(),w(r,{key:1,modelValue:l(a).value[t.property],"onUpdate:modelValue":s=>l(a).value[t.property]=s,itemType:(g=t.type)==null?void 0:g.type,options:(((x=t==null?void 0:t.type)==null?void 0:x.elements)||[]).map(s=>({label:s.text,value:s.value})),style:{width:"100%","z-index":"1071"},"get-popup-container":s=>l(D)||s},null,8,["modelValue","onUpdate:modelValue","itemType","options","get-popup-container"])):q("",!0)]}),_:2},1032,["columns","data-source"])]),_:2},1032,["header"]))),128)}}});export{ie as default};
