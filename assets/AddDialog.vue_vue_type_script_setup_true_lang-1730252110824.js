import{d as x,ac as R,k as i,o as S,U as k,V as q,X as u,f as t,u as o}from"./vue-1730252110824.js";import{X as M,a4 as O,o as _,I as U,v as B,a6 as C,a9 as D,F,aa as G}from"./index-1730252110824.js";import{f as V,h as X,q as A}from"./role-1730252110824.js";const P=x({__name:"AddDialog",props:{visible:{type:Boolean,default:!1},groupId:{type:String,default:""},modalType:{type:String,default:"add"},current:{type:Object,default:{}}},emits:["update:visible","refresh"],setup(m,{emit:r}){const d=m,v=R(),{jumpPage:g}=M(),s=i(!1),a=i({name:"",groupId:"",description:""}),c=i(),f=i([]),y=async()=>{var l;s.value=!0,(l=c.value)==null||l.validate().then(()=>{d.modalType==="add"?V(a.value).then(e=>{e.status===200&&(_("操作成功"),r("update:visible",!1),v.query.save?window.onTabSaveSuccess&&(window.onTabSaveSuccess(e.result.id),setTimeout(()=>window.close(),300)):g("system/Role/Detail",{id:e.result.id}))}).catch(()=>s.value=!1):X(a.value).then(e=>{e.status===200&&(_("操作成功"),r("refresh"),r("update:visible",!1))}).catch(()=>s.value=!1)}).catch(()=>s.value=!1)},b=()=>{A({sorts:[{name:"createTime",order:"desc"}]}).then(l=>{l.status===200&&(f.value=l.result.map(e=>({label:e.name,value:e.id})))})};return S(()=>{b(),a.value.groupId=d.groupId,d.modalType==="edit"&&(a.value=O(d.current))}),(l,e)=>{const w=U,p=B,h=C,I=D,j=F,T=G;return k(),q(T,{visible:"",title:m.modalType==="add"?"新增":"编辑",width:"670px",onCancel:e[3]||(e[3]=n=>r("update:visible",!1)),onOk:y,"confirm-loading":o(s)},{default:u(()=>[t(j,{ref_key:"formRef",ref:c,model:o(a),layout:"vertical"},{default:u(()=>[t(p,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多可输入64个字符"}]},{default:u(()=>[t(w,{value:o(a).name,"onUpdate:value":e[0]||(e[0]=n=>o(a).name=n),placeholder:"请输入角色名称","allow-clear":""},null,8,["value"])]),_:1}),t(p,{name:"groupId",label:"分组",rules:[{required:!0,message:"请选择分组"}]},{default:u(()=>[t(h,{value:o(a).groupId,"onUpdate:value":e[1]||(e[1]=n=>o(a).groupId=n),placeholder:"请选择分组",options:o(f)},null,8,["value","options"])]),_:1}),t(p,{name:"name",label:"说明"},{default:u(()=>[t(I,{value:o(a).description,"onUpdate:value":e[2]||(e[2]=n=>o(a).description=n),placeholder:"请输入说明","allow-clear":"",maxlength:200,"show-count":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirm-loading"])}}});export{P as _};
