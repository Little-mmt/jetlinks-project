import{ft as S,fo as E,e8 as V,$ as D,d as O,aa as T}from"./index-1730252110824.js";import{d as A,k as l,e as I,w as L,ab as P,U as r,V as k,X as v,u as i,E as b,Y as C,_ as y,Z as x,$ as f,f as g}from"./vue-1730252110824.js";const $={style:{margin:"10px 0px 20px 0px","padding-right":"10px"}},F={key:0},M={key:1},Q={key:0},Y=A({__name:"index",props:{api:{type:String,default:""},type:{type:String,default:""},data:{type:Object,default:()=>[]}},emits:["close","save"],setup(o,{emit:h}){const m=o,s=l(0),u=l(0),n=l(!0),p=l(0),N=l({}),j=()=>{h("close"),h("save")},w=I(()=>u.value?((p.value+s.value)/u.value*100).toFixed(2):0),B=c=>{n.value=!0;let e=0,d=0;const t=new E.EventSourcePolyfill(c);N.value=t,t.onmessage=_=>{const a=JSON.parse(_.data);switch(m.type){case"active":a.success?(e+=a.total,s.value=e):(d+=a.total,p.value=d);break;case"sync":e+=a,s.value=e;break}s.value+p.value>=u.value&&setTimeout(()=>{t.close(),n.value=!1},500)},t.onerror=()=>{t.close(),n.value=!1},t.onopen=()=>{}};return L(()=>m.api,c=>{c&&S(m.data).then(e=>{e.status===200&&(u.value=e.result,B(c))})},{deep:!0,immediate:!0}),(c,e)=>{const d=V,t=P("AIcon"),_=D,a=O,J=T;return r(),k(J,{maskClosable:!1,width:"800px",visible:!0,title:o.type==="active"?"启用":"同步",closable:!1},{footer:v(()=>[i(n)?C("",!0):(r(),k(a,{key:0,type:"primary",onClick:j},{default:v(()=>[b("完成")]),_:1}))]),default:v(()=>[y("div",$,[i(n)?(r(),x("div",F,[y("div",null,f(o.type==="active"?"正在启用全部设备":"正在同步设备状态"),1),g(d,{percent:i(w)},null,8,["percent"])])):(r(),x("div",M,[y("p",null,f(o.type==="active"?"启用":"同步")+"成功："+f(i(s))+"条",1),o.type==="active"?(r(),x("p",Q,[b("启用失败："+f(i(p))+"条",1),g(_,{title:"实例信息页面中的配置项未完善"},{default:v(()=>[g(t,{style:{"margin-left":"5px"},type:"QuestionCircleOutlined"})]),_:1})])):C("",!0)]))])]),_:1},8,["title"])}}});export{Y as _};
