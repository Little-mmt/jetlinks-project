import{ah as S,k as B}from"./vue-1730252110824.js";import{d as D}from"./scene-1730252110824.js";import{d2 as k,a4 as h,aF as E,a5 as I}from"./index-1730252110824.js";const x=t=>{const l=["when","then","terms","actions"];return t?t.map(s=>(s&&(s.key=E(),Object.keys(s).some(c=>{l.includes(c)&&I(s[c])&&(s[c]=x(s[c]))})),s)):[]},i=k(),p=[{when:[{terms:[{column:void 0,value:{source:"fixed",value:void 0},termType:void 0,key:"params_1",type:"and"}],type:"and",key:"terms_1"}],key:i,shakeLimit:{enabled:!1,time:1,threshold:1,alarmFirst:!1},then:[],executeAnyway:!0,branchId:i,branchName:"条件"}],d={trigger:{},when:[{terms:[{terms:[["","eq","","and"]]}],branchName:"条件",key:i,executeAnyway:!0,groupIndex:1}]},j=S("scene",()=>{const t=B({trigger:{type:""},options:[d],branches:p,description:"",name:"",id:void 0}),l={},s=()=>{t.value={trigger:{type:""},options:h(d),branches:h(p),description:"",name:"",id:void 0}};return{data:t,productCache:l,getDetail:async A=>{var g;s();const f=await D(A);if(f.success){const o=f.result,y=o.triggerType;let e=o.branches;if(!e)e=h(p),y==="device"?e.push(null):e[0].when.length=[];else if(y==="device"){const r=e.length,a=[];e.forEach((n,u)=>{var b,v,w;n!=null&&n.executeAnyway&&u>0&&((v=(b=e[u-1])==null?void 0:b.when)!=null&&v.length)&&a.push(null),a.push(n),u===r-1&&((w=n==null?void 0:n.when)!=null&&w.length)&&a.push(null)}),e=[...a]}e=e.map(r=>(r!=null&&r.then&&(r==null||r.then.forEach(a=>{a.actions&&a.actions.forEach(n=>{n.actionId||(n.actionId=k())})})),r)),t.value={...o,trigger:o.trigger||{},branches:h(x(e)),options:o.options&&((g=Object.keys(o.options))!=null&&g.length)?o.options:h(d)}}},refresh:s}});export{j as u};
