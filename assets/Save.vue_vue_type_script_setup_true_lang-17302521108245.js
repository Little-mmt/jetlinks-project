import{o as k,I as U,v as q,$ as S,a6 as V,a9 as D,F,aa as P}from"./index-1730252110824.js";import{c as R,d as B,e as J,v as A}from"./cardManagement-1730252110824.js";import{O as E,T as M}from"./data-17302521108245.js";import{d as $,k as v,r as Q,e as X,w as z,ab as G,U as H,V as K,X as n,_ as C,f as l,u as t,E as W,J as I}from"./vue-1730252110824.js";const Y={style:{"margin-top":"10px"}},le=$({__name:"Save",props:{type:{type:String},data:{type:Object,default:void 0}},emits:["change"],setup(d,{emit:g}){const c=d,p=v(!1),_=v([]),u=v(),a=Q({id:"",iccId:"",platformConfigId:void 0,operatorName:void 0,cardType:void 0,describe:""}),b=async o=>{var r;const e=await A(o);return e.status===200?(r=e.result)!=null&&r.passed?"":e.result.reason:"请输入输入正确的ICCID"},y={id:[{required:!0,message:"请输入卡号"},{max:64,message:"最多输入64个字符"},{validator:async(o,e)=>{if(e){const r=c.type==="add"?await b(e):"";return r===""?Promise.resolve():Promise.reject(new Error(`${r}`))}},trigger:"blur"}],iccId:[{required:!0,message:"请输入ICCID"},{max:64,message:"最多输入64个字符"}],platformConfigId:[{required:!0,message:"请选择平台对接"}],operatorName:[{required:!0,message:"请选择运营商"}],cardType:[{required:!0,message:"请选择类型"}]},m=(o,e)=>e.label.toLowerCase().indexOf(o.toLowerCase())>=0,w=X(()=>_.value.filter(o=>o.operatorName===a.operatorName).map(o=>({label:o.name,value:o.id})));z(()=>c.data,o=>{R({paging:!1,sorts:[{name:"createTime",order:"desc"}],terms:[{column:"state",value:"enabled"}]}).then(e=>{e.status===200&&(_.value=e.result)}),Object.assign(a,o)},{immediate:!0,deep:!0});const h=()=>{g("change",!1),u.value.resetFields()},x=()=>{u.value.validate().then(async()=>{p.value=!0;const o=c.type==="add"?await B(I(a)).catch(e=>e):await J(I(a)).catch(e=>e);p.value=!1,o.status===200&&(k("操作成功"),g("change",!0),u.value.resetFields())}).catch(o=>{console.log("error",o)})};return(o,e)=>{const r=U,i=q,T=G("AIcon"),N=S,f=V,j=D,L=F,O=P;return H(),K(O,{maskClosable:!1,width:"600px",visible:!0,title:d.type==="add"?"新增":"编辑",okText:"确定",cancelText:"取消",onOk:x,onCancel:h,confirmLoading:t(p)},{default:n(()=>[C("div",Y,[l(L,{layout:"vertical",ref_key:"formRef",ref:u,rules:y,model:t(a)},{default:n(()=>[l(i,{label:"卡号",name:"id"},{default:n(()=>[l(r,{value:t(a).id,"onUpdate:value":e[0]||(e[0]=s=>t(a).id=s),placeholder:"请输入卡号",disabled:d.type==="edit"},null,8,["value","disabled"])]),_:1}),l(i,{name:"iccId"},{label:n(()=>[C("span",null,[W(" ICCID "),l(N,{title:"IC卡的唯一识别号码"},{default:n(()=>[l(T,{type:"QuestionCircleOutlined",style:{"margin-left":"2px"}})]),_:1})])]),default:n(()=>[l(r,{value:t(a).iccId,"onUpdate:value":e[1]||(e[1]=s=>t(a).iccId=s),placeholder:"请输入ICCID",disabled:d.type==="edit"},null,8,["value","disabled"])]),_:1}),l(i,{label:"运营商",name:"operatorName"},{default:n(()=>[l(f,{allowClear:"",showSearch:"","filter-option":m,disabled:d.type==="edit",options:t(E),value:t(a).operatorName,"onUpdate:value":e[2]||(e[2]=s=>t(a).operatorName=s),placeholder:"请选择运营商",onSelect:e[3]||(e[3]=()=>{t(a).platformConfigId=void 0})},null,8,["disabled","options","value"])]),_:1}),l(i,{label:"平台对接",name:"platformConfigId"},{default:n(()=>[l(f,{showSearch:"","filter-option":m,disabled:d.type==="edit",allowClear:"",options:t(w),value:t(a).platformConfigId,"onUpdate:value":e[4]||(e[4]=s=>t(a).platformConfigId=s),placeholder:"请选择平台对接"},null,8,["disabled","options","value"])]),_:1}),l(i,{label:"类型",name:"cardType"},{default:n(()=>[l(f,{allowClear:"",showSearch:"",disabled:d.type==="edit","filter-option":m,options:t(M),value:t(a).cardType,"onUpdate:value":e[5]||(e[5]=s=>t(a).cardType=s),placeholder:"请选择类型"},null,8,["disabled","options","value"])]),_:1}),l(i,{label:"说明",name:"describe"},{default:n(()=>[l(j,{value:t(a).describe,"onUpdate:value":e[6]||(e[6]=s=>t(a).describe=s),placeholder:"请输入说明",showCount:"",maxlength:200},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["title","confirmLoading"])}}});export{le as _};
