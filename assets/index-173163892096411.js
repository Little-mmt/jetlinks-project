import{d as N,Z as S,aa as V,g as w}from"./index-1731638920964.js";import{a as E}from"./collector-1731638920964.js";import O from"./Table-1731638920964.js";import j from"./Tree-1731638920964.js";import{d as I,k as l,U as J,V as L,X as d,f as i,E as x,u,_ as R}from"./vue-1731638920964.js";import"./index-1731638920964282.js";import"./index-1731638920964279.js";import"./index-1731638920964280.js";import"./index-1731638920964281.js";import"./data-17316389209642.js";import"./validate-1731638920964.js";import"./regular-1731638920964.js";import"./index-1731638920964292.js";import"./index-1731638920964293.js";const U={class:"content"},X=I({__name:"index",props:{data:{type:Array,default:()=>[]}},emits:["change"],setup(A,{emit:_}){const p=A,B=l(p.data),f=l(!1),m=l(),n=l(),t=new Map,c=l(),T=async()=>{var r;const e=await((r=m.value)==null?void 0:r.validate().catch(()=>{}));if(!e)return;const a=e.map(o=>{var h,y,g,C,b,k;return{name:o.name,provider:"OPC_UA",collectorId:(h=p.data)==null?void 0:h.id,collectorName:(y=p.data)==null?void 0:y.name,pointKey:o.id,configuration:{interval:(C=(g=o.configuration)==null?void 0:g.interval)==null?void 0:C.value,type:o.type},features:(b=o.features)!=null&&b.value?["changedOnly"]:[],accessModes:((k=o.accessModes)==null?void 0:k.value)||[]}});f.value=!0;const s=await E([...a]).catch(()=>{});_("change",(s==null?void 0:s.status)===200),f.value=!1},v=()=>{_("change",!1)},M=(e,a)=>{a?t.set(e.id,e):t.delete(e.id),n.value=[...t.values()]},P=e=>{c.value=e,t.delete(e),n.value=[...t.values()]},D=e=>{c.value=[],e.forEach(a=>{t.has(a.id)&&(t.delete(a.id),c.value.push(a.id))}),n.value=[...t.values()]},K=e=>{e.forEach(a=>{t.set(a.id,a)}),n.value=[...t.values()]};return(e,a)=>{const s=N,r=S,o=V;return J(),L(o,{title:"扫描",visible:!0,width:"95%",onCancel:v},{footer:d(()=>[i(s,{key:"back",onClick:v},{default:d(()=>[x("取消")]),_:1}),i(r,{key:"submit",type:"primary",loading:u(f),onClick:T,style:{"margin-left":"8px"},hasPermission:"DataCollect/Collector:update"},{default:d(()=>[x(" 确认 ")]),_:1},8,["loading"])]),default:d(()=>[R("div",U,[i(j,{data:u(B),class:"tree",onChange:M,onCancelAll:D,onAddAll:K,unSelectKeys:u(c)},null,8,["data","unSelectKeys"]),i(O,{data:u(n),class:"table",onChange:P,ref_key:"formTableRef",ref:m},null,8,["data"])])]),_:1})}}});const ne=w(X,[["__scopeId","data-v-71776840"]]);export{ne as default};
