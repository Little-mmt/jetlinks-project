import{g as E,X as V,au as A,cY as M,c$ as j}from"./index-1730252110824.js";import{q as P,a as F}from"./log-17302521108243.js";import H from"./LogDetail-1730252110824.js";import{k as u,o as R,ab as D,U as e,Z as g,f as h,X as l,$ as y,u as a,Y as o,V as i,E as f,_ as C,F as X}from"./vue-1730252110824.js";import"./index-1730252110824284.js";import"./vue-json-viewer-1730252110824.js";const $={key:0},z=["onClick"],O={class:"tableBottom"},U={key:1},Z={__name:"Log",props:{currentId:{type:String,default:""},configId:{type:String,default:""},goal:{type:String,default:""}},setup(L){const s=L,I=V(),m=u(),_=u(!1),d=u([]),k=u(),S=[{title:"告警时间",dataIndex:"alarmTime",key:"alarmTime"},{title:"触发条件",dataIndex:"triggerDesc",key:"triggerDesc"},{title:"告警源",dataIndex:"sourceName",key:"sourceName"},{title:"告警原因",dataIndex:"actualDesc",key:"actualDesc"},{title:"操作",dataIndex:"action",key:"action",width:100}],b=async()=>{var c;const t={pageIndex:0,pageSize:51,terms:[{column:"alarmRecordId",termType:"eq",value:s.currentId,type:"and"}],sorts:[{name:"alarmTime",order:"desc"}]},n=s.goal?await P(s.configId,t):await F(s.configId,t);n.success&&(((c=n.result.data)==null?void 0:c.length)>50?(m.value=!0,d.value=n.result.data.slice(0,50)):(m.value=!1,d.value=n.result.data))},B=t=>{I.jumpPage("device/Instance/Detail",{id:t,tab:"Running"})},N=t=>{_.value=!0,k.value=t},T=()=>{_.value=!1},Y=()=>{I.jumpPage("rule-engine/Alarm/Log/Detail",{id:s.currentId})};return R(()=>{b()}),(t,n)=>{const c=D("Ellipsis"),q=D("AIcon"),v=M,w=j;return e(),g(X,null,[h(w,{dataSource:a(d),columns:S,pagination:!1,bordered:"",scroll:{y:"calc(100vh - 300px)"}},{bodyCell:l(({column:r,text:p,record:x})=>[r.dataIndex==="alarmTime"?(e(),g("span",$,y(a(A)(p).format("YYYY-MM-DD HH:mm:ss")),1)):o("",!0),r.dataIndex==="sourceName"?(e(),i(c,{key:1},{default:l(()=>[f(" 设备名称： "),C("span",{class:"deviceId",onClick:()=>B(x.targetId)},y(p),9,z)]),_:2},1024)):o("",!0),r.dataIndex==="triggerDesc"||r.dataIndex==="actualDesc"?(e(),i(c,{key:2},{default:l(()=>[f(y(p),1)]),_:2},1024)):o("",!0),r.dataIndex==="action"?(e(),i(v,{key:3,type:"link",onClick:()=>N(x)},{icon:l(()=>[h(q,{type:"EyeOutlined"})]),_:2},1032,["onClick"])):o("",!0)]),_:1},8,["dataSource","scroll"]),C("div",O,[a(m)?(e(),i(v,{key:0,class:"moreBtn",type:"link",onClick:Y},{default:l(()=>[f("查看更多 >")]),_:1})):a(d).length?(e(),g("span",U,"已展示全部数据")):o("",!0)]),a(_)?(e(),i(H,{key:0,data:a(k),onClose:T},null,8,["data"])):o("",!0)],64)}}},te=E(Z,[["__scopeId","data-v-da0d762f"]]);export{te as default};
