import{F as g,a4 as b,v as N,cY as O,g as U}from"./index-1731638920964.js";import p from"./item-17316389209642.js";import{P as F}from"./index-1731638920964294.js";import"./index-1731638920964295.js";import"./index-1731638920964293.js";import{d as I,c as T,k as y,r as A,e as M,w as R,ab as q,U as f,Z as V,f as s,X as l,V as D,_ as v,E,u as x,G,af as X,ag as Y}from"./vue-1731638920964.js";import"./context-1731638920964.js";import"./index-1731638920964296.js";import"./columns-1731638920964.js";import"./data-17316389209643.js";import"./sortBy-1731638920964.js";const Z=i=>(X("data-v-87a6cc9f"),i=i(),Y(),i),$={class:"metrics-item-value"},z={key:1,class:"data-table-boolean-item"},H={class:"data-table-boolean-item--value"},J=Z(()=>v("div",{style:{"line-height":"32px"}},"-",-1)),K={class:"data-table-boolean-item--value"},L=I({name:"MetricValueItems"}),Q=I({...L,props:{value:{type:Object,default:void 0},options:{type:Array,default:()=>[]},range:{type:Boolean,default:!1}},emits:["update:value"],setup(i,{emit:h}){const a=i,S=g.useInjectFormItemContext(),d=T("metricsType"),c=y(!1),n=A({value:a.range===!1?a.value:void 0,rangeValue:a.range===!0?b(a.value)||[void 0,void 0]:[void 0,void 0]}),_=y();M(()=>{var t;if(a.range===!1)switch(d){case"date":return a.value;case"boolean":const e=a.value,o=a.options.find(r=>r.value===a.value);return o?o.label:e?e==="true"?"是":"否":"";default:return a.value}else return(t=a.value)!=null&&t[0]?a.value.join("-"):""});const j=()=>{let t="请输入";return["boolean","date"].includes(d)&&(t="请选择"),`${t}指标值`},k=(t,e)=>a.range&&n.rangeValue[0]>=n.rangeValue[1]?Promise.reject("需大于左侧数值"):Promise.resolve(),w=(t,e)=>e==null?Promise.reject(j()):d==="string"&&(e==null?void 0:e.length)>64?Promise.reject("最多可输入64个字符"):Promise.resolve(),P=(t,e=!1)=>{if(e)return t.map(o=>{const r=String(o),m=String(o).indexOf(".");return m===-1?o:Number(r.substring(0,m))});{const o=String(t),r=String(t).indexOf(".");return r===-1?t:Number(o.substring(0,r))}},B=()=>new Promise((t,e)=>{_.value.validate().then(o=>{let r=a.range===!0?n.rangeValue:n.value;["int","long"].includes(d)&&(r=P(r,a.range)),c.value=!1,h("update:value",r),S.onFieldChange(),t(!0)}).catch(()=>{e()})});return R(()=>a.range,(t,e)=>{t!==e&&(n.rangeValue=t?b(a.value)||[void 0,void 0]:void 0)},{immediate:!0}),(t,e)=>{const o=N,r=g,m=q("AIcon"),C=O;return f(),V("div",$,[s(x(F),{visible:x(c),"onUpdate:visible":e[3]||(e[3]=u=>G(c)?c.value=u:null),"show-cancel":!1,"body-style":"width: 300px",onOk:B},{content:l(()=>[s(r,{ref_key:"formRef",ref:_,model:n},{default:l(()=>[i.range===!1?(f(),D(o,{key:0,rules:[{validator:w}],name:"value"},{default:l(()=>[s(p,{value:n.value,"onUpdate:value":e[0]||(e[0]=u=>n.value=u),options:i.options},null,8,["value","options"])]),_:1},8,["rules"])):(f(),V("div",z,[v("div",H,[s(o,{name:["rangeValue",0],rules:[{required:!0,message:"请输入指标值"}]},{default:l(()=>[s(p,{value:n.rangeValue[0],"onUpdate:value":e[1]||(e[1]=u=>n.rangeValue[0]=u)},null,8,["value"])]),_:1})]),J,v("div",K,[s(o,{name:["rangeValue",1],rules:[{required:!0,message:"请输入指标值"},{validator:k}]},{default:l(()=>[s(p,{value:n.rangeValue[1],"onUpdate:value":e[2]||(e[2]=u=>n.rangeValue[1]=u)},null,8,["value"])]),_:1},8,["rules"])])]))]),_:1},8,["model"])]),default:l(()=>[s(C,{type:"link",style:{padding:"0"}},{icon:l(()=>[s(m,{type:"SettingOutlined"})]),default:l(()=>[E(" 配置 ")]),_:1})]),_:1},8,["visible"])])}}});const de=U(Q,[["__scopeId","data-v-87a6cc9f"]]);export{de as default};
