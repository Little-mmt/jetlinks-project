import{a4 as h,o as g,I as j,v as k,F as C,aa as V}from"./index-1730252110824.js";import{i as q}from"./regular-1730252110824.js";import{s as M,e as P}from"./dictionary-1730252110824.js";import{d as U,k as u,o as w,U as D,V as L,X as n,f as l,u as t}from"./vue-1730252110824.js";const T=U({__name:"index",props:{type:{type:String,default:"add"},dicId:{type:String,default:""},sort:{type:Number,default:1},data:{type:Object,default:{}}},emits:["closeModal","refresh"],setup(c,{emit:v}){const s=c,e=u({dictId:"",name:"",value:"",text:"",ordinal:0,searchCode:""}),f=u(),i=u(!1),p=u(),_={name:[{required:!0,message:"请输入name"},{validator:async(d,a)=>{if(a){if(!q(a))return Promise.reject("请输入英文或者数字或者-或者_")}else return Promise.resolve()},trigger:"change"},{max:64,message:"最多可输入64位字符",trigger:"change"}],value:[{required:!0,message:"请输入value",trigger:"blur"},{max:64,message:"最多可输入64位字符",trigger:"change"},{validator:async(d,a)=>{if(a&&f.value!==a){const r=await P({terms:[{terms:[{value:a,termType:"eq",column:"value"},{value:e.value.dictId,termType:"eq",column:"dictId"}]}]});return r.status===200&&r.result?Promise.reject("value已存在，请重新输入"):Promise.resolve()}else return Promise.resolve()},trigger:"blur"}],text:[{required:!0,message:"请输入text",trigger:"blur"},{max:64,message:"最多可输入64位字符",trigger:"change"}]},y=()=>{p.value.validate().then(async()=>{i.value=!0,e.value.searchCode=e.value.name+":"+e.value.value+":"+e.value.text,(await M(e.value)).status===200?(g("操作成功!"),v("refresh")):g("操作失败!","error"),i.value=!1})},x=()=>{v("closeModal")};return w(()=>{s.type==="add"?(e.value.dictId=s.dicId,e.value.ordinal=s.sort):(e.value=h(s.data),f.value=s.data.value)}),(d,a)=>{const r=j,m=k,I=C,b=V;return D(),L(b,{visible:"",title:c.type==="add"?"新增":"编辑",onCancel:x,onOk:y,maskClosable:!1,confirmLoading:t(i)},{default:n(()=>[l(I,{model:t(e),layout:"vertical",rules:_,ref_key:"formRef",ref:p},{default:n(()=>[l(m,{label:"name",name:"name"},{default:n(()=>[l(r,{placeholder:"con_type",value:t(e).name,"onUpdate:value":a[0]||(a[0]=o=>t(e).name=o)},null,8,["value"])]),_:1}),l(m,{label:"value",name:"value"},{default:n(()=>[l(r,{placeholder:"con_type",value:t(e).value,"onUpdate:value":a[1]||(a[1]=o=>t(e).value=o)},null,8,["value"])]),_:1}),l(m,{label:"text",name:"text"},{default:n(()=>[l(r,{placeholder:"连接失败",value:t(e).text,"onUpdate:value":a[2]||(a[2]=o=>t(e).text=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","confirmLoading"])}}});export{T as _};
