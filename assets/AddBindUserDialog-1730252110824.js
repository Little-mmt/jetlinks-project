import{o as u,a3 as K,aa as R,g as h}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{m as S,o as x}from"./department-17302521108242.js";import{u as B}from"./department-1730252110824.js";import{d as I,k as _,r as k,ab as A,U as C,V as U,X as q,f,_ as L,u as r}from"./vue-1730252110824.js";const D={class:"table"},T=I({__name:"AddBindUserDialog",props:{parentId:{},visible:{type:Boolean}},emits:["confirm","update:visible"],setup(y,{emit:i}){const l=y,g=B(),c=_(!1),w=()=>{e._selectedRowKeys&&l.parentId?(c.value=!0,x(l.parentId,e._selectedRowKeys).then(()=>{u("操作成功"),i("confirm"),i("update:visible",!1),e._selectedRowKeys=[]}).finally(()=>c.value=!1)):u("请选择要绑定的用户","warning")},v=()=>{i("update:visible",!1),g.setSelectedKeys([])},p=[{title:"姓名",dataIndex:"name",key:"name",ellipsis:!0,search:{type:"string"}},{title:"用户名",dataIndex:"username",key:"username",ellipsis:!0,search:{type:"string"}}],m=_({}),e=k({_selectedRowKeys:[],requestFun:async s=>{if(l.parentId){const a={...s,sorts:[{name:"createTime",order:"desc"}],terms:[...s.terms,{terms:[{column:"id$in-dimension$org$not",value:l.parentId}]}]},t=await S(a);return{code:t.status,result:t.result,status:t.status}}else return{code:200,result:{data:[],pageIndex:0,pageSize:0,total:0},status:200}},onSelectChange:(s,a)=>{const t=new Set(e._selectedRowKeys);a?t.add(s.id):t.delete(s.id),e._selectedRowKeys=[...t.values()]}}),b=(s,a,t)=>{if(s)t.map(o=>{e._selectedRowKeys.includes(o.id)||e._selectedRowKeys.push(o.id)});else{const o=t.map(n=>n.id),d=[];e._selectedRowKeys.map(n=>{o.includes(n)||d.push(n)}),e._selectedRowKeys=d}};return(s,a)=>{const t=A("pro-search"),o=K,d=R;return C(),U(d,{class:"add-bind-user-dialog-container",title:"绑定",width:"1440px",visible:"",centered:"",confirmLoading:r(c),onOk:w,onCancel:v},{default:q(()=>[f(t,{type:"simple",columns:p,target:"category",onSearch:a[0]||(a[0]=n=>m.value={...n}),style:{"margin-bottom":"0"}}),L("div",D,[f(o,{ref:"tableRef",columns:p,request:r(e).requestFun,params:r(m),rowSelection:{selectedRowKeys:r(e)._selectedRowKeys,onSelect:r(e).onSelectChange,onSelectNone:()=>r(e)._selectedRowKeys=[],onSelectAll:b},model:"TABLE",defaultParams:{sorts:[{name:"createTime",order:"desc"}]},style:{"max-height":"510px",overflow:"auto","padding-top":"0"}},null,8,["request","params","rowSelection"])])]),_:1},8,["confirmLoading"])}}});const O=h(T,[["__scopeId","data-v-e25a0483"]]);export{O as default};
