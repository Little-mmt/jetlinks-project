import{g as qe,X as Ue,k as Ve,au as P,o as K,a4 as fe,g2 as $e,ct as Ke,dj as Xe,cY as Je,Z as Ze,d5 as Qe,g3 as et}from"./index-1730252110824.js";import{C as tt,a as st,c as Ce,i as Ee,m as W,d as j,y as d,D as nt,b as at,e as ge,f as re,g as rt,h as it,j as U,k as he,S as lt,V as pe,l as ot,r as dt,R as V,s as ct,_ as z,n as $,B as ut,o as ft,p as gt,P as te,q as ht,t as pt,u as ie,v as vt,w as yt,x as mt,E as bt,z as Rt,A as ve,W as St,F as ye,G as Ct,H as Et,I as Dt,J as xt,K as wt,L as ne,M as Mt,N as kt,O as Tt,Q as Pt,T as Ht,U as Yt,X as Nt,Y as It}from"./index-1730252110824309.js";import{d as le,n as ee,F as Ot,j as zt,k as H,c as At,e as Wt,w as me,q as _t,u as O,U as G,Z as X,_ as J,f as B,G as Bt,X as A,E as F,V as be,Y as L,a0 as Re,$ as ae}from"./vue-1730252110824.js";const Ft={headerToolbar:!0,footerToolbar:!0,events:!0,eventSources:!0,resources:!0},jt=le({props:{options:Object},data(){return{renderId:0,customRenderingMap:new Map}},methods:{getApi(){return this.calendar},buildOptions(n){return{...n,customRenderingMetaMap:Ut(this.$slots),handleCustomRendering:this.handleCustomRendering}}},render(){const n=[];for(const e of this.customRenderingMap.values())n.push(ee(Lt,{key:e.id,customRendering:e}));return ee("div",{attrs:{"data-fc-render-id":this.renderId}},ee(Ot,n))},mounted(){const n=new tt;this.handleCustomRendering=n.handle.bind(n);const e=this.buildOptions(this.options),t=new st(this.$el,e);this.calendar=t,t.render(),n.subscribe(s=>{this.customRenderingMap=s,this.renderId++,this.needCustomRenderingResize=!0})},beforeUpdate(){this.getApi().resumeRendering()},updated(){this.needCustomRenderingResize&&(this.needCustomRenderingResize=!1,this.getApi().updateSize())},beforeUnmount(){this.getApi().destroy()},watch:qt()}),Gt=jt,Lt=le({props:{customRendering:Object},render(){const n=this.customRendering,e=typeof n.generatorMeta=="function"?n.generatorMeta(n.renderProps):n.generatorMeta;return ee(zt,{to:n.containerEl},e)}});function qt(){let n={options:{deep:!0,handler(e){let t=this.getApi();t.pauseRendering();let s=this.buildOptions(e);t.resetOptions(s),this.renderId++}}};for(let e in Ft)n[`options.${e}`]={deep:!0,handler(t){if(t!==void 0){let s=this.getApi();s.pauseRendering(),s.resetOptions({[e]:t},[e]),this.renderId++}}};return n}function Ut(n){const e={};for(const t in n)e[Vt(t)]=n[t];return e}function Vt(n){return n.split("-").map((e,t)=>t?$t(e):e).join("")}function $t(n){return n.charAt(0).toUpperCase()+n.slice(1)}class Kt extends U{constructor(){super(...arguments),this.headerElRef=j()}renderSimpleLayout(e,t){let{props:s,context:r}=this,a=[],i=he(r.options);return e&&a.push({type:"header",key:"header",isSticky:i,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),a.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),d(pe,{elClasses:["fc-daygrid"],viewSpec:r.viewSpec},d(lt,{liquid:!s.isHeightAuto&&!s.forPrint,collapsibleWidth:s.forPrint,cols:[],sections:a}))}renderHScrollLayout(e,t,s,r){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{props:i,context:o}=this,m=!i.forPrint&&he(o.options),b=!i.forPrint&&ot(o.options),g=[];return e&&g.push({type:"header",key:"header",isSticky:m,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),g.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),b&&g.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:dt}]}),d(pe,{elClasses:["fc-daygrid"],viewSpec:o.viewSpec},d(a,{liquid:!i.isHeightAuto&&!i.forPrint,forPrint:i.forPrint,collapsibleWidth:i.forPrint,colGroups:[{cols:[{span:s,minWidth:r}]}],sections:g}))}}function Z(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.row].push(s);return t}function Q(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.firstCol].push(s);return t}function Se(n,e){let t=[];if(n){for(let s=0;s<e;s+=1)t[s]={affectedInstances:n.affectedInstances,isEvent:n.isEvent,segs:[]};for(let s of n.segs)t[s.row].segs.push(s)}else for(let s=0;s<e;s+=1)t[s]=null;return t}const De=Ce({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function xe(n){let{display:e}=n.eventRange.ui;return e==="list-item"||e==="auto"&&!n.eventRange.def.allDay&&n.firstCol===n.lastCol&&n.isStart&&n.isEnd}class we extends ie{render(){let{props:e}=this;return d(vt,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:De,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class Me extends ie{render(){let{props:e,context:t}=this,{options:s}=t,{seg:r}=e,a=s.eventTimeFormat||De,i=yt(r,a,t,!0,e.defaultDisplayEventEnd);return d(bt,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:mt(e.seg,t),defaultGenerator:Xt,timeText:i,isResizing:!1,isDateSelecting:!1}))}}function Xt(n){return d(z,null,d("div",{className:"fc-daygrid-event-dot",style:{borderColor:n.borderColor||n.backgroundColor}}),n.timeText&&d("div",{className:"fc-event-time"},n.timeText),d("div",{className:"fc-event-title"},n.event.title||d(z,null," ")))}class Jt extends ie{constructor(){super(...arguments),this.compileSegs=W(Zt)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:s}=this.compileSegs(e.singlePlacements);return d(kt,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:s,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let r=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return d(z,null,t.map(a=>{let i=a.eventRange.instance.instanceId;return d("div",{className:"fc-daygrid-event-harness",key:i,style:{visibility:r[i]?"hidden":""}},xe(a)?d(Me,Object.assign({seg:a,isDragging:!1,isSelected:i===e.eventSelection,defaultDisplayEventEnd:!1},$(a,e.todayRange))):d(we,Object.assign({seg:a,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:i===e.eventSelection,defaultDisplayEventEnd:!1},$(a,e.todayRange))))}))}})}}function Zt(n){let e=[],t=[];for(let s of n)e.push(s.seg),s.isVisible||t.push(s.seg);return{allSegs:e,invisibleSegs:t}}const Qt=Ce({week:"narrow"});class es extends U{constructor(){super(...arguments),this.rootElRef=j(),this.state={dayNumberId:Rt()},this.handleRootEl=e=>{ve(this.rootElRef,e),ve(this.props.elRef,e)}}render(){let{context:e,props:t,state:s,rootElRef:r}=this,{options:a,dateEnv:i}=e,{date:o,dateProfile:m}=t;const b=t.showDayNumber&&ss(o,m.currentRange,i);return d(Et,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":s.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:ts,date:o,dateProfile:m,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:b,extraRenderProps:t.extraRenderProps},(g,w)=>d("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&d(St,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:ye(e,o,"week"),date:o,defaultFormat:Qt}),!w.isDisabled&&(t.showDayNumber||Ct(a)||t.forceDayTop)?d("div",{className:"fc-daygrid-day-top"},d(g,{elTag:"a",elClasses:["fc-daygrid-day-number",b&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},ye(e,o)),{id:s.dayNumberId})})):t.showDayNumber?d("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},d("a",{className:"fc-daygrid-day-number"}," ")):void 0,d("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,d("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},d(Jt,{allDayDate:o,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:r,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),d("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function ts(n){return n.dayNumberText||d(z,null," ")}function ss(n,e,t){const{start:s,end:r}=e,a=Dt(r,-1),i=t.getYear(s),o=t.getMonth(s),m=t.getYear(a),b=t.getMonth(a);return!(i===m&&o===b)&&(n.valueOf()===s.valueOf()||t.getDay(n)===1&&n.valueOf()<r.valueOf())}function ke(n){return n.eventRange.instance.instanceId+":"+n.firstCol}function Te(n){return ke(n)+":"+n.lastCol}function ns(n,e,t,s,r,a,i){let o=new is(y=>{let R=n[y.index].eventRange.instance.instanceId+":"+y.span.start+":"+(y.span.end-1);return r[R]||1});o.allowReslicing=!0,o.strictOrder=s,e===!0||t===!0?(o.maxCoord=a,o.hiddenConsumes=!0):typeof e=="number"?o.maxStackCnt=e:typeof t=="number"&&(o.maxStackCnt=t,o.hiddenConsumes=!0);let m=[],b=[];for(let y=0;y<n.length;y+=1){let R=n[y],k=Te(R);r[k]!=null?m.push({index:y,span:{start:R.firstCol,end:R.lastCol+1}}):b.push(R)}let g=o.addSegs(m),w=o.toRects(),{singleColPlacements:T,multiColPlacements:p,leftoverMargins:E}=as(w,n,i),u=[],c=[];for(let y of b){p[y.firstCol].push({seg:y,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let R=y.firstCol;R<=y.lastCol;R+=1)T[R].push({seg:q(y,R,R+1,i),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let y=0;y<i.length;y+=1)u.push(0);for(let y of g){let R=n[y.index],k=y.span;p[k.start].push({seg:q(R,k.start,k.end,i),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let D=k.start;D<k.end;D+=1)u[D]+=1,T[D].push({seg:q(R,D,D+1,i),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let y=0;y<i.length;y+=1)c.push(E[y]);return{singleColPlacements:T,multiColPlacements:p,moreCnts:u,moreMarginTops:c}}function as(n,e,t){let s=rs(n,t.length),r=[],a=[],i=[];for(let o=0;o<t.length;o+=1){let m=s[o],b=[],g=0,w=0;for(let p of m){let E=e[p.index];b.push({seg:q(E,o,o+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:p.levelCoord,marginTop:p.levelCoord-g}),g=p.levelCoord+p.thickness}let T=[];g=0,w=0;for(let p of m){let E=e[p.index],u=p.span.end-p.span.start>1,c=p.span.start===o;w+=p.levelCoord-g,g=p.levelCoord+p.thickness,u?(w+=p.thickness,c&&T.push({seg:q(E,p.span.start,p.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:p.levelCoord,marginTop:0})):c&&(T.push({seg:q(E,p.span.start,p.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:p.levelCoord,marginTop:w}),w=0)}r.push(b),a.push(T),i.push(w)}return{singleColPlacements:r,multiColPlacements:a,leftoverMargins:i}}function rs(n,e){let t=[];for(let s=0;s<e;s+=1)t.push([]);for(let s of n)for(let r=s.span.start;r<s.span.end;r+=1)t[r].push(s);return t}function q(n,e,t,s){if(n.firstCol===e&&n.lastCol===t-1)return n;let r=n.eventRange,a=r.range,i=xt(a,{start:s[e].date,end:re(s[t-1].date,1)});return Object.assign(Object.assign({},n),{firstCol:e,lastCol:t-1,eventRange:{def:r.def,ui:Object.assign(Object.assign({},r.ui),{durationEditable:!1}),instance:r.instance,range:i},isStart:n.isStart&&i.start.valueOf()===a.start.valueOf(),isEnd:n.isEnd&&i.end.valueOf()===a.end.valueOf()})}class is extends wt{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:s}=this,r=a=>!this.forceHidden[ne(a)];for(let a=0;a<s.length;a+=1)s[a]=s[a].filter(r);return t}handleInvalidInsertion(e,t,s){const{entriesByLevel:r,forceHidden:a}=this,{touchingEntry:i,touchingLevel:o,touchingLateral:m}=e;if(this.hiddenConsumes&&i){const b=ne(i);if(!a[b])if(this.allowReslicing){const g=Object.assign(Object.assign({},i),{span:Mt(i.span,t.span)}),w=ne(g);a[w]=!0,r[o][m]=g,s.push(g),this.splitEntry(i,t,s)}else a[b]=!0,s.push(i)}super.handleInvalidInsertion(e,t,s)}}class Pe extends U{constructor(){super(...arguments),this.cellElRefs=new V,this.frameElRefs=new V,this.fgElRefs=new V,this.segHarnessRefs=new V,this.rootElRef=j(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:s}=this,{options:r}=s,a=e.cells.length,i=Q(e.businessHourSegs,a),o=Q(e.bgEventSegs,a),m=Q(this.getHighlightSegs(),a),b=Q(this.getMirrorSegs(),a),{singleColPlacements:g,multiColPlacements:w,moreCnts:T,moreMarginTops:p}=ns(ct(e.fgEventSegs,r.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,r.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),E=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return d("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((u,c)=>{let y=this.renderFgSegs(c,e.forPrint?g[c]:w[c],e.todayRange,E),R=this.renderFgSegs(c,ls(b[c],w),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return d(es,{key:u.key,elRef:this.cellElRefs.createRef(u.key),innerElRef:this.frameElRefs.createRef(u.key),dateProfile:e.dateProfile,date:u.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&c===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:u.extraRenderProps,extraDataAttrs:u.extraDataAttrs,extraClassNames:u.extraClassNames,extraDateSpan:u.extraDateSpan,moreCnt:T[c],moreMarginTop:p[c],singlePlacements:g[c],fgContentElRef:this.fgElRefs.createRef(u.key),fgContent:d(z,null,d(z,null,y),d(z,null,R)),bgContent:d(z,null,this.renderFillSegs(m[c],"highlight"),this.renderFillSegs(i[c],"non-business"),this.renderFillSegs(o[c],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let s=this.props;this.updateSizing(!Ee(e,s))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,s,r,a,i,o){let{context:m}=this,{eventSelection:b}=this.props,{framePositions:g}=this.state,w=this.props.cells.length===1,T=a||i||o,p=[];if(g)for(let E of t){let{seg:u}=E,{instanceId:c}=u.eventRange.instance,y=E.isVisible&&!r[c],R=E.isAbsolute,k="",D="";R&&(m.isRtl?(D=0,k=g.lefts[u.lastCol]-g.lefts[u.firstCol]):(k=0,D=g.rights[u.firstCol]-g.rights[u.lastCol])),p.push(d("div",{className:"fc-daygrid-event-harness"+(R?" fc-daygrid-event-harness-abs":""),key:ke(u),ref:T?null:this.segHarnessRefs.createRef(Te(u)),style:{visibility:y?"":"hidden",marginTop:R?"":E.marginTop,top:R?E.absoluteTop:"",left:k,right:D}},xe(u)?d(Me,Object.assign({seg:u,isDragging:a,isSelected:c===b,defaultDisplayEventEnd:w},$(u,s))):d(we,Object.assign({seg:u,isDragging:a,isResizing:i,isDateSelecting:o,isSelected:c===b,defaultDisplayEventEnd:w},$(u,s)))))}return p}renderFillSegs(e,t){let{isRtl:s}=this.context,{todayRange:r}=this.props,{framePositions:a}=this.state,i=[];if(a)for(let o of e){let m=s?{right:0,left:a.lefts[o.lastCol]-a.lefts[o.firstCol]}:{left:0,right:a.rights[o.firstCol]-a.rights[o.lastCol]};i.push(d("div",{key:gt(o.eventRange),className:"fc-daygrid-bg-harness",style:m},t==="bg-event"?d(ut,Object.assign({seg:o},$(o,r))):ft(t)))}return d(z,{},...i)}updateSizing(e){let{props:t,state:s,frameElRefs:r}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let m=t.cells.map(b=>r.currentMap[b.key]);if(m.length){let b=this.rootElRef.current,g=new te(b,m,!0,!1);(!s.framePositions||!s.framePositions.similarTo(g))&&this.setState({framePositions:new te(b,m,!0,!1)})}}const a=this.state.segHeights,i=this.querySegHeights(),o=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},a),i),maxContentHeight:o?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let s in e){let r=Math.round(e[s].getBoundingClientRect().height);t[s]=Math.max(t[s]||0,r)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],s=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-s.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}Pe.addStateEquality({segHeights:Ee});function ls(n,e){if(!n.length)return[];let t=os(e);return n.map(s=>({seg:s,isVisible:!0,isAbsolute:!0,absoluteTop:t[s.eventRange.instance.instanceId],marginTop:0}))}function os(n){let e={};for(let t of n)for(let s of t)e[s.seg.eventRange.instance.instanceId]=s.absoluteTop;return e}class ds extends U{constructor(){super(...arguments),this.splitBusinessHourSegs=W(Z),this.splitBgEventSegs=W(Z),this.splitFgEventSegs=W(Z),this.splitDateSelectionSegs=W(Z),this.splitEventDrag=W(Se),this.splitEventResize=W(Se),this.rowRefs=new V}render(){let{props:e,context:t}=this,s=e.cells.length,r=this.splitBusinessHourSegs(e.businessHourSegs,s),a=this.splitBgEventSegs(e.bgEventSegs,s),i=this.splitFgEventSegs(e.fgEventSegs,s),o=this.splitDateSelectionSegs(e.dateSelectionSegs,s),m=this.splitEventDrag(e.eventDrag,s),b=this.splitEventResize(e.eventResize,s),g=s>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return d(Yt,{unit:"day"},(w,T)=>d(z,null,e.cells.map((p,E)=>d(Pe,{ref:this.rowRefs.createRef(E),key:p.length?p[0].date.toISOString():E,showDayNumbers:s>1,showWeekNumbers:e.showWeekNumbers,todayRange:T,dateProfile:e.dateProfile,cells:p,renderIntro:e.renderRowIntro,businessHourSegs:r[E],eventSelection:e.eventSelection,bgEventSegs:a[E].filter(cs),fgEventSegs:i[E],dateSelectionSegs:o[E],eventDrag:m[E],eventResize:b[E],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:g,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new te(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new te(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:s,rowPositions:r}=this,a=s.leftToIndex(e),i=r.topToIndex(t);if(i!=null&&a!=null){let o=this.props.cells[i][a];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(i,a),allDay:!0},o.extraDateSpan),dayEl:this.getCellEl(i,a),rect:{left:s.lefts[a],right:s.rights[a],top:r.tops[i],bottom:r.bottoms[i]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let s=this.props.cells[e][t].date,r=re(s,1);return{start:s,end:r}}}function cs(n){return n.eventRange.def.allDay}class us extends U{constructor(){super(...arguments),this.elRef=j(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:s,expandRows:r}=e,a=s===!0||t===!0;a&&!r&&(a=!1,t=null,s=null);let i=["fc-daygrid-body",a?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",r?"":"fc-daygrid-body-natural"];return d("div",{ref:this.elRef,className:i.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},d("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:r?e.clientHeight:""}},e.colGroupNode,d("tbody",{role:"presentation"},d(ds,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:s,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=fs(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),s=t.closest(".fc-scroller"),r=e.getBoundingClientRect().top-t.getBoundingClientRect().top;s.scrollTop=r?r+1:0}this.needsScrollReset=!1}}}function fs(n,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=n.querySelector(`[data-date="${Tt(e.currentDate)}-01"]`)),t||(t=n.querySelector(`[data-date="${Pt(e.currentDate)}"]`)),t}class gs extends Ht{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class hs extends U{constructor(){super(...arguments),this.slicer=new gs,this.tableRef=j()}render(){let{props:e,context:t}=this;return d(us,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class ps extends Kt{constructor(){super(...arguments),this.buildDayTableModel=W(vs),this.headerRef=j(),this.tableRef=j()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:s}=this,r=this.buildDayTableModel(s.dateProfile,t),a=e.dayHeaders&&d(nt,{ref:this.headerRef,dateProfile:s.dateProfile,dates:r.headerDates,datesRepDistinctDays:r.rowCnt===1}),i=o=>d(hs,{ref:this.tableRef,dateProfile:s.dateProfile,dayTableModel:r,businessHours:s.businessHours,dateSelection:s.dateSelection,eventStore:s.eventStore,eventUiBases:s.eventUiBases,eventSelection:s.eventSelection,eventDrag:s.eventDrag,eventResize:s.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:o.tableColGroupNode,tableMinWidth:o.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!s.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:o.clientWidth,clientHeight:o.clientHeight,forPrint:s.forPrint});return e.dayMinWidth?this.renderHScrollLayout(a,i,r.colCnt,e.dayMinWidth):this.renderSimpleLayout(a,i)}}function vs(n,e){let t=new ht(n.renderRange,e);return new pt(t,/year|month|week/.test(n.currentRangeUnit))}class ys extends at{buildRenderRange(e,t,s){let r=super.buildRenderRange(e,t,s),{props:a}=this;return ms({currentRange:r,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:a.fixedWeekCount,dateEnv:a.dateEnv})}}function ms(n){let{dateEnv:e,currentRange:t}=n,{start:s,end:r}=t,a;if(n.snapToWeek&&(s=e.startOfWeek(s),a=e.startOfWeek(r),a.valueOf()!==r.valueOf()&&(r=ge(a,1))),n.fixedWeekCount){let i=e.startOfWeek(e.startOfMonth(re(t.end,-1))),o=Math.ceil(rt(i,r));r=ge(r,6-o)}return{start:s,end:r}}var bs=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';it(bs);var Rs=Nt({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:ps,dateProfileGeneratorClass:ys},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}}),Ss={code:"zh-cn",week:{dow:1,doy:4},buttonText:{prev:"上月",next:"下月",today:"今天",year:"年",month:"月",week:"周",day:"日",list:"日程"},weekText:"周",allDayText:"全天",moreLinkText(n){return"另外 "+n+" 个"},noEventsText:"没有事件显示"};const Cs={key:0,class:"calendarContainer"},Es={class:"calenderButton"},Ds={key:1,class:"compareTip"},xs={key:2,class:"compareSave"},ws={class:"event"},Ms={class:"event-title"},ks=le({name:"FullCalendar"}),Ts=Object.assign(ks,{props:{selectable:{type:String,default:!1},preview:{type:Boolean,default:!1}},emits:["selectDate","resetRapid"],setup(n,{expose:e,emit:t}){const s=n,r=Ue(),a=Ve(),i=H(!1),o=a.$state.calendarTagColor,m=At("tagsMap"),b=H([]),g=H(P().format("YYYY-MM")),w=H(),T=H(),p=H(),E=H(),u=H(),c=H([]),y=H([]),R=H([]),k=H([]),D=H(),Y=H(),_=H([]),oe=async(l,h,v)=>{const f=await et(l,h);if(f.success){const M=f.result.filter(S=>{const x=!k.value.find(C=>C.date===S.date);return x&&S.tags.forEach(C=>{c.value.push({date:S.date,id:C.id,name:C.name}),y.value.push({date:S.date,id:C.id,name:C.name})}),x});k.value=[...k.value,...M],v&&(R.value=c.value.map(S=>({id:S.id,title:S.name,start:S.date,backgroundColor:o.get(S.id)||"#000000"})),u.value.removeAllEvents(),u.value.addEventSource(R.value))}},He=l=>{const h=l.event;h.remove();let v;c.value.forEach((f,M)=>{f.date===h.startStr&&f.id===h.id&&(v=M)}),c.value.splice(v,1)},Ye=({event:l})=>{const h=c.value.filter(v=>v.date===l.startStr);if((h==null?void 0:h.length)>=5){l.remove(),K("该日期已超出可配置标签上限","error");return}else h.length?h.find(f=>f.id===l.id)?l.remove():c.value.push({date:l.startStr,id:l.id,name:l.title}):c.value.push({date:l.startStr,id:l.id,name:l.title})},de=async l=>{const h=P(l.view.activeStart).format("YYYY-MM-DD"),v=P(l.view.activeEnd).subtract(1,"day").format("YYYY-MM-DD");b.value.includes(v)||(b.value.push(v),o.size===0&&await a.getTagsColor(),oe(h,v,!0))},ce=Wt(()=>JSON.stringify(c.value)!==JSON.stringify(y.value)),Ne=()=>{u.value.prev(),g.value=P(g.value).subtract(1,"month").format("YYYY-MM")},Ie=()=>{g.value=P(g.value).add(1,"month").format("YYYY-MM"),u.value.next()},Oe=()=>{g.value=P().format("YYYY-MM"),u.value.today()},ze=async()=>{var M;let l=[],h=[];c.value.forEach(S=>{var C,N;const x=l.findIndex(I=>I.date===S.date);x!==-1?(N=(C=l[x])==null?void 0:C.tags)==null||N.push({id:S.id,name:S.name}):l.push({date:S.date,tags:[{id:S.id,name:S.name}]})});const v=new Map;l.map(S=>{v.set(S.date,S)}),h=fe(l),(M=k.value)==null||M.forEach(S=>{v.has(S.date)||h.push({date:S.date,tags:[]})}),(await $e(h)).success&&(K("操作成功"),ue())},se=(l,h)=>{const v=[];let f=l.clone();for(;f.isBefore(h);)v.push(f.format("YYYY-MM-DD")),f=f.add(1,"day");return v},Ae=l=>{if(s.selectable)if(!D.value)D.value=P(l.dateStr),document.querySelector(`.fc-day[data-date="${l.dateStr}"]`).classList.add("selectedDate");else{if(P(l.dateStr).isBefore(D.value)){K("结束时间必须大于开始时间");return}Y.value=P(l.dateStr).add(1,"day"),t("selectDate",{start:D.value.format("YYYY.MM.DD"),end:Y.value.subtract(1,"day").format("YYYY.MM.DD"),days:Y.value.diff(D.value,"day")})}},We=l=>{l.el.addEventListener("mouseenter",()=>{const h=P(l.date);if(_.value&&!Y.value&&_.value.forEach(v=>{document.querySelector(`.fc-day[data-date="${v}"]`).classList.remove("selectedDate")}),D.value&&h.isAfter(D.value)&&!Y.value){const v=se(D.value,h.add(1,"day"));v.forEach(f=>{document.querySelector(`.fc-day[data-date="${f}"]`).classList.add("selectedDate")}),_.value=v,_.value.shift()}})},_e={plugins:[It,Rs],initialView:"dayGridMonth",headerToolbar:{start:"",center:"",end:""},events:R.value,unselectAuto:!1,locale:Ss,droppable:!0,height:s.preview?"600px":"620px",eventReceive:Ye,datesSet:de,dateClick:Ae,dayCellDidMount:We,dayHeaderContent:function(l){return l.date.toLocaleDateString("default",{weekday:"narrow"})},dayCellContent:function(l){return{html:'<div class="custom-day-cell">'+l.date.getDate()+"</div>"}}},Be=(l,h,v)=>{const f=l.filter(x=>{const C=h.find(I=>x.date===I.date&&x.id===I.id),N=h.filter(I=>x.date===I.date).length>=5;return!C&&!N}),M=[];return v.forEach(x=>{const C=f.filter(I=>x===I.date).length,N=h.filter(I=>x===I.date).length;C+N>5&&M.push(x)}),f.filter(x=>!M.includes(x.date))},Fe=async l=>{const h=se(D.value,Y.value),v=se(Y.value,Y.value.add(l,"day")),f=h.map(C=>c.value.filter(N=>C===N.date)),M=Array.from({length:l});for(let C=0;C<M.length;C++)M[C]=fe(f[C%f.length]),M[C].length?M[C].forEach(N=>{N.date=P(N.date).add(f.length*Math.ceil((C+1)/f.length),"day").format("YYYY-MM-DD")}):c.value=c.value.filter(N=>(console.log(M[C]),N.date!==v[C]));const S=Ke(M);await oe(P(Y.value).format("YYYY-MM-DD"),P(Y.value).add(l-1,"day").format("YYYY-MM-DD"),!1);const x=Be(S,c.value,v);c.value=[...c.value,...x],R.value=c.value.map(C=>({id:C.id,title:C.name,start:C.date,backgroundColor:o.get(C.id)||"#000000"})),u.value.removeAllEvents(),u.value.addEventSource(R.value),K("操作成功"),t("resetRapid")},je=()=>{D.value&&_.value.push(P(D.value).format("YYYY-MM-DD")),Y.value&&_.value.push(P(D.value).format("YYYY-MM-DD")),_.value.forEach(l=>{document.querySelector(`.fc-day[data-date="${l}"]`).classList.remove("selectedDate")}),D.value="",Y.value=""},ue=()=>{c.value=[],y.value=[],k.value=[],b.value=[],de(u.value)},Ge=l=>{u.value.gotoDate(l)},Le=()=>{r.jumpPage("system/Calendar")};return e({reselection:je,rapidAction:Fe,refresh:ue}),me(()=>s.selectable,l=>{u.value.setOption("droppable",!l),l||t("resetRapid")}),me(()=>m==null?void 0:m.value,(l,h)=>{if((l==null?void 0:l.length)<=(h==null?void 0:h.length)){const v=new Map;m.value.forEach(f=>{v.set(f.id,{name:f.name,color:f.color})}),c.value=c.value.filter(f=>v.has(f.id)),R.value=c.value.map(f=>{var M,S;return{id:f.id,title:(M=v.get(f.id))==null?void 0:M.name,start:f.date,backgroundColor:((S=v.get(f.id))==null?void 0:S.color)||"#000000"}}),u.value.removeAllEvents(),u.value.addEventSource(R.value)}},{deep:!0}),setTimeout(()=>{i.value=!0,_t(()=>{var h;u.value=(h=E.value)==null?void 0:h.getApi();const l=document.querySelector(".fc-view-harness");l==null||l.addEventListener("mousemove",v=>{s.selectable&&(p.value=!0,T.value=v.clientX,w.value=v.clientY)}),l==null||l.addEventListener("mouseout",()=>{s.selectable&&(p.value=!1)})})},300),(l,h)=>{const v=Xe,f=Je,M=Ze,S=Qe;return O(i)?(G(),X("div",Cs,[J("div",Es,[B(v,{value:O(g),"onUpdate:value":h[0]||(h[0]=x=>Bt(g)?g.value=x:null),disabled:n.selectable,format:"YYYY-MM",picker:"month",onChange:Ge,valueFormat:"YYYY-MM"},null,8,["value","disabled"]),B(f,{onClick:Ne,disabled:n.selectable},{default:A(()=>[F("上月")]),_:1},8,["disabled"]),B(f,{onClick:Oe,disabled:n.selectable},{default:A(()=>[F("今天")]),_:1},8,["disabled"]),B(f,{onClick:Ie,disabled:n.selectable},{default:A(()=>[F("下月")]),_:1},8,["disabled"])]),n.preview?(G(),be(f,{key:0,class:"skip",type:"link",onClick:Le},{default:A(()=>[F("日历维护")]),_:1})):L("",!0),O(ce)?(G(),X("div",Ds," 点击确认完成本次日历维护 ")):L("",!0),O(ce)?(G(),X("div",xs,[B(M,{type:"primary",onClick:ze,disabled:n.selectable},{default:A(()=>[F("确认")]),_:1},8,["disabled"])])):L("",!0),B(O(Gt),{ref_key:"calendarEl",ref:E,class:"calendar",options:_e},{eventContent:A(x=>[J("div",ws,[J("div",{class:"decoration",style:Re({backgroundColor:x.backgroundColor})},null,4),B(S,null,{title:A(()=>[F(ae(x.event.title),1)]),default:A(()=>[J("div",Ms,ae(x.event.title),1)]),_:2},1024),!n.selectable&&!n.preview?(G(),be(f,{key:0,type:"text",class:"closeBtn",onClick:()=>He(x)},{default:A(()=>[F("x")]),_:2},1032,["onClick"])):L("",!0)])]),_:1},512),n.selectable&&!O(Y)&&O(p)?(G(),X("div",{key:3,class:"tips",style:Re({top:O(w)+"px",left:O(T)+20+"px"})},ae(O(D)?"点击选中模板结束日期":"点击选中模板开始日期"),5)):L("",!0)])):L("",!0)}}}),Ns=qe(Ts,[["__scopeId","data-v-02ed157b"]]);export{Ns as default};
