import{aC as tt,cZ as kt,cA as St,c_ as Ct,cY as oe,g as re,I as Re,aR as at,c$ as Tt,e as wt,d0 as lt,d1 as Ce,aL as nt,aM as ot,aF as st,af as It,d2 as $t,d3 as Ye,d4 as Ot,d5 as ut,aN as Rt,_ as Vt,d6 as jt,v as pe,F as X,d7 as Mt,cs as At,aQ as Et,aB as Be,a5 as Ue,d8 as Ut,d9 as dt,da as Pt,a4 as Te,cK as Pe,db as rt,cC as Xe,a6 as Ft,b4 as Bt,dc as Kt,dd as it,de as Nt}from"./index-1730252110824.js";import"./index-1730252110824296.js";import{o as Ve,t as He,k as C,r as ae,d as F,a7 as qe,e as L,w as E,ab as se,U as x,Z as B,f,X as v,_ as O,$ as ne,B as Ie,Y as q,a0 as de,R as Y,h as Dt,a4 as ie,u as l,V,G as W,E as N,af as Ke,ag as Ne,F as $e,a1 as Oe,W as ct,q as pt,n as Lt,m as Ze,v as Gt,A as Ht,M as qt,p as ce,a8 as Wt,a9 as zt,aa as Jt,J as Qe,c as Yt}from"./vue-1730252110824.js";import{u as Xt,a as Zt,b as We,c as Qt,d as fe,e as ea,f as ta,T as aa,F as la,R as na,g as oa,h as sa,i as ua,j as da,k as ra,l as ia,m as ca,n as pa,o as va,p as fa,q as _a,r as ma,M as ya}from"./context-1730252110824.js";import{u as ga}from"./columns-1730252110824.js";import{t as ba}from"./data-17302521108243.js";import"./index-1730252110824293.js";import"./index-1730252110824295.js";import{s as ha}from"./sortBy-1730252110824.js";const xa=s=>{const p={};return s.forEach(e=>{e.form&&e.form.rules&&(p[e.dataIndex]=e.form.rules)}),p},Le=s=>s?tt(s,["__serial","__index","__top","__selected","__key","__dataIndex"]):{},ka=(s,p)=>{let e=[...s],t=0,i=0,r=0,o=0,a=0,d;return e.forEach(c=>{c.width?i+=c.width:t+=1}),t&&(r=(p-i)/t,o=Math.trunc(r),a=(r-o)*t),e.forEach((c,n)=>{c.width||(d=n)}),e.map((c,n)=>{let _=c.width,g=0;return c.width||(_=o),n===d&&(_=Math.trunc(a)+o),n!==0&&(g=e[n-1].width+e[n-1].left),c.width=_,c.left=g,c},[])},Sa=(s,p)=>{let e;const t=i=>{let r={};for(const o of i)r=o.contentRect;p(r,i)};Ve(()=>{e=new kt(St(t,100)),e.observe(s.value)}),He(()=>{e==null||e.unobserve(s.value)})},Ca=(s,p,e,t={})=>{const i=C({});let r,o=C({});const a=Object.assign({validateRowKey:!1},t),d=(_,g=0)=>new Promise((y,m)=>{r.validate(_,{firstFields:!0,index:g},h=>{h!=null&&h.length?m(h.map(w=>({...w,__serial:_.__serial,__dataIndex:g}))):y(_)})}),c=()=>new Promise((_,g)=>{const y=s.value,m=y.length,h=[],w=[];let S=0;const $=()=>{var k,b;S+=1,S===m&&(!Object.keys(h).length?(_(w),(k=a.onSuccess)==null||k.call(a)):((b=a.onError)==null||b.call(a,h),g(h)))},u=a.validateRowKey;y.length?y.forEach((k,b)=>{u||k[e]?d(k,b).then(T=>{w.push(Le(T)),$()}).catch(T=>{h.push(T),$()}):$()}):_(y)});return(()=>{o.value=xa(p),r=new Ct(o.value)})(),{validate:c,validateItem:d,errorMap:i,rules:o}},Ta=(s=!1)=>{const p=C([]),e=ae({value:void 0,label:void 0});return{groupOptions:p,groupActive:e,updateGroupActive:(a,d)=>{s&&(e.value=a,e.label=d)},addGroup:a=>{s&&p.value.push(a)},removeGroup:a=>{s&&p.value.splice(a,1)},updateGroupOptions:(a=[])=>{s&&(p.value=a)}}},wa={key:0,class:"header"},Ia=F({name:"DragModal",__name:"DragModal",props:{title:{type:[String,Boolean],default:""},width:{type:Number,default:400},height:{type:Number,default:100},dragRang:{type:[Array,Number],default:[400,200]},bodyStyle:{type:Object,default:()=>({})}},emits:["close","heightChange"],setup(s,{emit:p}){const e=s;qe();const t=document.body,i=C(),r=C(),o=C(e.width||400),a=C(e.height||100),d=C(100),c=C(100),n=L(()=>({top:_(c.value)+"px",left:_(d.value)+"px",width:_(o.value)+"px",height:_(a.value)+"px"})),_=w=>Number(w.toFixed(2)),g=()=>{let w=!1,S,$,u,k;r.value.addEventListener("mousedown",b=>{w=!0,S=b.clientX,$=b.clientY,u=i.value.offsetLeft,k=i.value.offsetTop}),document.addEventListener("mouseup",()=>{w=!1}),document.addEventListener("mousemove",b=>{if(w){const T=b.clientX-S,R=b.clientY-$;d.value=u+T,c.value=k+R}})},y=()=>{document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}},m=(w,S)=>{let $=!1,u=!1,k=!1,b=!1,T=!1,R=!1,A=w.clientX,P=w.clientY;document.onmousemove=Q=>{S==="bottom-right"?($=!0,u=!0):S==="bottom-left"?($=!0,u=!0,k=!0,T=!0):S==="top-right"?($=!0,u=!0,b=!0,R=!0):S==="top-left"&&($=!0,u=!0,k=!0,T=!0,b=!0,R=!0);let le=Q.clientX-A,z=Q.clientY-P;if(A=Q.clientX,P=Q.clientY,$){let Z=le;T&&(Z=-Z),k&&(d.value=d.value-Z);const ue=o.value+Z;o.value=ue<=e.dragRang[0]?e.dragRang[0]:ue}if(u){let Z=z;R&&(Z=-Z),b&&(c.value=c.value-Z);const ue=a.value+Z;a.value=ue<=e.dragRang[1]?e.dragRang[1]:ue,p("heightChange",a.value)}},y()},h=()=>{console.log("close---1"),p("close")};return Ve(()=>{if(i.value&&r.value&&g(),t){const w=t==null?void 0:t.getBoundingClientRect();d.value=((w==null?void 0:w.right)-o.value)/2||0,c.value=(w==null?void 0:w.top)+200||0}}),E(()=>e.height,()=>{e.height>a.value&&(a.value=e.height)}),(w,S)=>{const $=se("AIcon"),u=oe;return x(),B("div",{ref_key:"dialog",ref:i,style:de(l(n)),class:"dialog"},[f(Dt,{name:"dialog"},{default:v(()=>[O("div",{class:"dialog-sprite",ref_key:"header",ref:r},[s.title!==!1?(x(),B("div",wa,[O("span",null,ne(s.title),1),f(u,{size:"small",type:"text",onClick:Ie(h,["stop"])},{default:v(()=>[f($,{type:"CloseOutlined"})]),_:1},8,["onClick"])])):q("",!0),O("div",{class:"dialog-body",style:de(s.bodyStyle)},[Y(w.$slots,"default",{},void 0,!0)],4)],512)]),_:3}),O("div",{class:ie({range:!0,"bottom-right":!0}),onMousedown:S[0]||(S[0]=Ie(k=>m(k,"bottom-right"),["stop"]))},null,32)],4)}}});const $a=re(Ia,[["__scopeId","data-v-49ae9ae5"]]);const Oa=s=>(Ke("data-v-ae1e978f"),s=s(),Ne(),s),Ra={class:"table-search"},Va={class:"table-search-header"},ja=Oa(()=>O("span",null,"查找",-1)),Ma={key:0,style:{margin:"12px 0"}},Aa={key:0},Ea={key:1},Ua={key:1},Pa={class:"table-search-result-total"},Fa=F({name:"MetadataTableSearch"}),Ba=Object.assign(Fa,{props:{searchKey:{type:String,default:"id"}},emits:["close"],setup(s,{emit:p}){const e=s,t=Xt(),i=Zt(),r=We(),o=Qt(),a=C(),d=C([]),c=C(!1),n=C(-1),_=C(100),g=C(230),y=C([]),m=C(),h=[{title:"标识",dataIndex:"id"},{title:"名称",dataIndex:"name"}],w=T=>{r.scrollTo({...T,__serial:T.__serial-1}),r.selected([T.id])},S=()=>{const R=JSON.parse(JSON.stringify(t.value||"[]")).map(A=>Object.assign(A,{__oldSerial:A.__serial})).filter(A=>A[e.searchKey]?A[e.searchKey].includes(a.value):!1);if(i){const A=[];return o.value.forEach(P=>{A.push(...R.filter(Q=>Q.expands.groupId===P.value))}),A}return R},$=T=>{var A;d.value=S(),T==="all"?(c.value=!0,_.value=400,n.value=0):T==="next"?n.value+=1:n.value-=1,n.value<0?n.value=d.value.length-1:n.value>d.value.length-1&&(n.value=0);const R=d.value[n.value];T!=="all"&&c.value&&((A=m.value)==null||A.scrollToByIndex(n.value-1)),d.value.length>1?(y.value=[R.id],w(R)):(y.value=[],r.selected([]))},u=T=>{T>340&&(g.value=T-160)},k=()=>{console.log("close"),p("close")},b=T=>{n.value=d.value.findIndex(R=>R.id===T.id),y.value=[T.id],w(T)};return(T,R)=>{const A=Re,P=oe,Q=at,le=se("Ellipsis");return x(),V(l($a),{width:800,height:l(_),title:!1,dragRang:[600,200],bodyStyle:{overflow:"hidden"},onHeightChange:u},{default:v(()=>[O("div",Ra,[O("div",Va,[O("div",null,[f(Q,null,{default:v(()=>[ja,f(A,{value:l(a),"onUpdate:value":R[0]||(R[0]=z=>W(a)?a.value=z:null),maxlength:64,placeholder:"请输入查找内容"},null,8,["value"]),f(P,{type:"primary",ghost:"",onClick:R[1]||(R[1]=()=>$("all"))},{default:v(()=>[N("查找全部")]),_:1}),f(P,{type:"primary",ghost:"",onClick:R[2]||(R[2]=()=>$("prev"))},{default:v(()=>[N("上一个")]),_:1}),f(P,{type:"primary",ghost:"",onClick:R[3]||(R[3]=()=>$("next"))},{default:v(()=>[N("下一个")]),_:1})]),_:1})]),O("div",null,[f(P,{type:"primary",onClick:Ie(k,["stop"])},{default:v(()=>[N("关闭")]),_:1},8,["onClick"])])]),l(c)?(x(),B("div",Ma,[f(ze,{ref_key:"tableRef",ref:m,"data-source":l(d),columns:h,height:l(g),disableMenu:!1,cellHeight:36,rowSelection:{onSelect:b,selectedRowKeys:l(y)},serial:{width:l(i)?150:66,title:"行数"}},{serial:v(({record:z})=>[l(i)?(x(),B("span",Aa,[f(le,null,{default:v(()=>[N(ne(z.expands.groupName)+" 第 "+ne(z.__oldSerial)+" 行 ",1)]),_:2},1024)])):(x(),B("span",Ea,ne(z.__serial),1))]),id:v(({record:z})=>[f(le,null,{default:v(()=>[N(ne(z.id),1)]),_:2},1024)]),name:v(({record:z})=>[f(le,null,{default:v(()=>[N(ne(z.name),1)]),_:2},1024)]),_:1},8,["data-source","height","rowSelection","serial"])])):q("",!0),l(c)?(x(),B("div",Ua,[N(" 查找到 "),O("span",Pa,ne(l(d).length),1),N(" 条相关属性 ")])):q("",!0)])]),_:1},8,["height"])}}}),Ka=re(Ba,[["__scopeId","data-v-ae1e978f"]]);const Na=s=>(Ke("data-v-15ded86d"),s=s(),Ne(),s),Da={class:"table-sort-content"},La=Na(()=>O("div",{class:"table-sort-title"}," 排序 ",-1)),Ga={class:"table-sort-body"},Ha={class:"table-sort-footer"},qa=F({name:"MetadataTableSort"}),Wa=Object.assign(qa,{props:{dataSource:{type:[Function,Array],default:()=>[]},sortKey:{type:[String,Array],default:void 0},dataIndex:{type:[Number,String],default:void 0},selectedRowKeys:{type:Array,default:()=>[]},active:{type:Boolean,default:!1}},emits:["click"],setup(s,{emit:p}){const e=s,t=fe(),i=We(),r=C(!1),o=C([]),a=C([]),d=[{dataIndex:"name",title:"名称"},{dataIndex:"total",title:"计数",width:70}],c=h=>{var w;h&&(a.value=e.selectedRowKeys,o.value=(((w=e.dataSource)==null?void 0:w.call(e))||[]).map((S,$)=>Object.assign(S,{__index:$+1}))),h?r.value=h:setTimeout(()=>{r.value=h},300)},n=h=>{a.value=h},_=()=>{a.value=[],i.cleanOrder()},g=()=>o.value.filter(h=>a.value.includes(h.key)).sort((h,w)=>w.__index-h.__index).map(h=>h.key),y=()=>{i.order("asc",e.sortKey,g(),e.dataIndex),p("click")},m=()=>{i.order("desc",e.sortKey,g(),e.dataIndex),p("click")};return(h,w)=>{const S=Tt,$=oe,u=wt,k=se("AIcon"),b=lt;return x(),V(b,{trigger:"click",placement:"bottom",overlayStyle:{zIndex:1050},getPopupContainer:T=>l(t)||T,onVisibleChange:c},{content:v(()=>[O("div",Da,[La,O("div",Ga,[l(r)?(x(),V(S,{key:0,size:"small",columns:d,dataSource:l(o),"row-selection":{selectedRowKeys:l(a),onChange:n},pagination:!1,scroll:l(o).length>5?{y:200}:void 0},null,8,["dataSource","row-selection","scroll"])):q("",!0)]),O("div",Ha,[f(u,{size:16},{default:v(()=>[f($,{type:"primary",onClick:_,disabled:!l(a).length},{default:v(()=>[N("清空条件")]),_:1},8,["disabled"]),f($,{type:"primary",ghost:"",onClick:y},{default:v(()=>[N("升序")]),_:1}),f($,{type:"primary",ghost:"",onClick:m},{default:v(()=>[N("降序")]),_:1})]),_:1})])])]),default:v(()=>[f(k,{type:"icon-paixu",class:ie({"table-sort-icon":!0,active:e.active})},null,8,["class"])]),_:1},8,["getPopupContainer"])}}}),za=re(Wa,[["__scopeId","data-v-15ded86d"]]);const Ja=["id"],Ya={class:"table-header-cell-title"},Xa={key:0,class:"header-cell-required"},Za={key:0,class:"table-header-cell-trigger"},Qa=F({name:"MetadataBaseTableHeader"}),el=Object.assign(Qa,{props:{columns:{type:Array,default:()=>[]},serial:{type:Boolean,default:!1},style:{type:Object,default:void 0}},setup(s){const p=We(),e=ae({visible:!1,key:void 0}),t=r=>{e.visible=!0,e.key=r},i=()=>{e.visible=!1};return(r,o)=>{const a=se("AIcon");return x(),B("div",{class:"metadata-edit-table-header-container",style:de(s.style)},[(x(!0),B($e,null,Oe(s.columns,(d,c)=>{var n;return x(),B("div",{class:"metadata-edit-table-header-cell",id:d.dataIndex,style:de({width:`${d.width}px`,left:`${d.left}px`})},[O("div",{class:ie({"metadata-edit-table-header-cell-box":!0,"header-cell-box-tool":!!(d.sort||d.filter)})},[O("div",Ya,[O("span",null,ne(d.title),1),(n=d.form)!=null&&n.required?(x(),B("span",Xa,"*")):q("",!0)]),d.sort||d.filter?(x(),B("div",Za,[d.filter?(x(),V(a,{key:0,type:"SearchOutlined",style:{color:"rgba(0,0,0, 0.25)"},onClick:()=>{t(d.filter.key||d.dataIndex)}},null,8,["onClick"])):q("",!0),d.sort?(x(),V(l(za),ct({key:1},d.sort,{key:d.dataIndex,active:l(p).sortData.dataIndex===d.dataIndex,selectedRowKeys:l(p).sortData.dataIndex===d.dataIndex?l(p).sortData.orderKeys:[],dataIndex:d.dataIndex,onClick:i}),null,16,["active","selectedRowKeys","dataIndex"])):q("",!0)])):q("",!0)],2)],12,Ja)}),256)),l(e).visible?(x(),V(l(Ka),{key:0,searchKey:l(e).key,onClose:o[0]||(o[0]=d=>l(e).visible=!1)},null,8,["searchKey"])):q("",!0)],4)}}}),tl=re(el,[["__scopeId","data-v-d1a1267d"]]);const al=F({name:"MetadataContextMenu"}),ll=Object.assign(al,{props:{data:{type:Object,default:()=>({})},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}},onCopy:{type:Function,default:()=>{}},paste:{type:Object,default:()=>({})}},setup(s){const p=s,e=C(null),t=L(()=>!p.data.id),i=L(()=>!p.paste),r=L(()=>{var d;return(d=p.data.expands)==null?void 0:d.isProduct}),o=({key:d})=>{d==="copy"&&p.onCopy(p.data),p.onClick(d)},a=d=>{setTimeout(()=>{p.onClose()},300)};return Ve(async()=>{await pt(),e.value.focus()}),(d,c)=>{const n=nt,_=ot;return x(),B("div",{class:"metadata-context-menu",ref_key:"contextMenu",ref:e,tabindex:"-1",onBlur:a},[f(_,{onClick:o},{default:v(()=>[f(n,{key:"add"},{icon:v(()=>[f(l(Ce),{type:"PlusSquareOutlined"})]),default:v(()=>[N(" 新增行 ")]),_:1}),f(n,{key:"copy"},{icon:v(()=>[f(l(Ce),{type:"icon-copy"})]),default:v(()=>[N(" 复制行 ")]),_:1}),f(n,{key:"paste",disabled:l(i)},{icon:v(()=>[f(l(Ce),{type:"icon-paste"})]),default:v(()=>[N(" 粘贴行 ")]),_:1},8,["disabled"]),f(n,{key:"detail",disabled:l(t)},{icon:v(()=>[f(l(Ce),{type:"icon-chakan"})]),default:v(()=>[N(" 查看详情 ")]),_:1},8,["disabled"]),f(n,{key:"delete",class:"danger",disabled:l(r)},{icon:v(()=>[f(l(Ce),{type:"DeleteOutlined"})]),default:v(()=>[N(" 删除 ")]),_:1},8,["disabled"])]),_:1})],544)}}}),nl=re(ll,[["__scopeId","data-v-7e7be347"]]);let be=null,ol=1,Fe;const sl=(s,p,e)=>{be&&be.destroy(),be=null;let t=ol++;const i=document.createElement("div"),r=e.getPopupContainer()||document.body,a=Lt(nl,{data:p,onClose:()=>{be&&be.destroy()},onClick:$=>{const u=Le(Fe);u.expands&&(u.expands=tt(u.expands,["isProduct"])),e.click($,p,Le(u))},onCopy:$=>{Fe=$,e.click("copy",$)},paste:!!Fe});Ze(a,i),r.appendChild(i.firstElementChild);const d=a.el,{offsetWidth:c,offsetHeight:n}=d,{clientWidth:_}=r,{clientX:g,clientY:y}=s,m=_-g>c?"left":"right",h=window.innerHeight-y>n?"top":"bottom",w=Math.abs(_-g);d.style[m]=m==="left"?`${g+20}px`:`${w}px`,d.style[h]=h==="bottom"?"2px":`${y}px`;const S={id:t,destroy:()=>{be=null,Ze(null,i)},cleanCopy:()=>{Fe=null}};return be=S,S},vt=()=>({dataSource:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},cellHeight:{type:Number,default:50},height:{type:Number,default:300},style:{type:Object,default:()=>({})},disableMenu:{type:Boolean,default:!0},rowKey:{type:String,default:"id"},openGroup:{type:Boolean,default:!1},rowSelection:{type:Object,default:void 0}});const ul={style:{position:"relative"}},dl=["data-row-key","onContextmenu","onClick"],rl={key:0,class:"body-cell-box"},il={key:1,class:"body-cell-box"},cl={class:"metadata-edit-table-body-empty"},pl=F({name:"MetadataBaseTableBody"}),vl=Object.assign(pl,{props:{...vt(),groupKey:{type:[String,Number],default:void 0}},emits:["update:dataSource","scrollDown"],setup(s,{expose:p,emit:e}){const t=s,i=C(),r=C(),o=ae({start:0,end:15}),a=C(0),d=ea();let c=C(!1),n;const _=L(()=>Math.trunc(t.height/t.cellHeight)),g=C([]),y=L(()=>{const u=t.dataSource.slice(o.start,o.end);return r.value&&(r.value.style.webkitTransform=`translate3d(0, ${o.start*t.cellHeight}px, 0)`),u}),m=()=>{if(!i.value)return;const u=i.value.scrollTop,k=i.value.clientHeight;i.value.scrollHeight;const b=Math.round(u/t.cellHeight)-1,T=b<0?0:b,R=T+_.value+4;u+k>=t.dataSource.length*t.cellHeight&&!c.value&&(e("scrollDown"),c.value=!0),o.start=T,o.end=R},h=u=>{if(i.value){let k=u*t.cellHeight;i.value.scrollTop=k}},w=(u,k,b)=>{u.preventDefault(),t.disableMenu&&(k={...k,__index:b},n=sl(u,k,d))},S=u=>{var k,b,T;if((k=t.rowSelection)!=null&&k.selectedRowKeys){const R=new Set(g.value),A=u[t.rowKey],P=!R.has(A);P?R.delete(A):R.add(A),(T=(b=t.rowSelection).onSelect)==null||T.call(b,u,P),g.value=[...R.values()]}},$=u=>{g.value=u};return Ve(()=>{pt(()=>{m()})}),He(()=>{n==null||n.destroy(),n==null||n.cleanCopy()}),E(()=>{var u;return JSON.stringify((u=t.rowSelection)==null?void 0:u.selectedRowKeys)},u=>{g.value=JSON.parse(u||"[]")},{immediate:!0}),E(()=>t.dataSource,(u,k)=>{t.dataSource.forEach((b,T)=>{b.__key||(b.__key=st())})},{immediate:!0,deep:!0}),E(()=>t.dataSource.length,()=>{c.value=!1,a.value={height:t.dataSource.length*t.cellHeight+"px"},(t.dataSource.length<=_.value||t.dataSource.length===0)&&e("scrollDown",_.value-t.dataSource.length+3)},{immediate:!0}),E(()=>t.groupKey,()=>{t.openGroup&&h(0)}),p({scrollTo:h,updateSelectedKeys:$}),(u,k)=>{const b=It;return u.dataSource.length?(x(),B("div",{key:0,class:"metadata-edit-table-body-viewport",style:de({...u.style,height:u.height+"px"}),ref_key:"viewScrollRef",ref:i,onScroll:m},[O("div",ul,[O("div",{class:"metadata-edit-scrollbar",style:de(l(a))},null,4),O("div",{class:"metadata-edit-table-center",ref_key:"tableCenterRef",ref:r},[l(y).length?(x(!0),B($e,{key:0},Oe(l(y),(T,R)=>{var A;return x(),B("div",{class:ie({"metadata-edit-table-row":!0,"metadata-edit-table-row-selected":(A=l(g))==null?void 0:A.includes(T[u.rowKey]||l(o).start+R+1)}),key:`record_${T.__key}`,style:de({height:`${u.cellHeight}px`}),"data-row-key":T[u.rowKey]||l(o).start+R+1,onContextmenu:Ie(P=>w(P,T,l(o).start+R),["right"]),onClick:Ie(()=>S(T),["stop"])},[(x(!0),B($e,null,Oe(u.columns,P=>(x(),B("div",{class:"metadata-edit-table-cell",style:de({width:`${P.width}px`,left:`${P.left}px`})},[P.dataIndex==="__serial"?(x(),B("div",rl,[Y(u.$slots,"serial",{record:T,index:T.__dataIndex,column:P},()=>[N(ne(l(o).start+R+1),1)],!0)])):(x(),B("div",il,[Y(u.$slots,P.dataIndex,{record:T,index:T.__dataIndex,column:P},()=>[N(ne(T[P.dataIndex]),1)],!0)]))],4))),256))],46,dl)}),128)):q("",!0)],512)])],36)):Y(u.$slots,"empty",{key:1},()=>[O("div",cl,[f(b)])],!0)}}}),fl=re(vl,[["__scopeId","data-v-e6211578"]]);const De=s=>(Ke("data-v-b940d488"),s=s(),Ne(),s),_l={class:"table-group-warp"},ml={class:"table-group-error-warp"},yl=De(()=>O("span",{style:{color:"#1d2129"}},"校验不合规",-1)),gl=De(()=>O("div",{class:"table-group-error-target"},null,-1)),bl={key:1,class:"table-group-error-warp"},hl=De(()=>O("span",{style:{color:"#1d2129"}},"校验不合规",-1)),xl=De(()=>O("div",{class:"table-group-error-target"},null,-1)),kl=F({name:"MetadataBaseTableGroup"}),Sl=Object.assign(kl,{props:{options:{type:Array,default:()=>[]},activeKey:{type:String,default:void 0}},emits:["delete","edit","add","change","update:activeKey"],setup(s,{emit:p}){const e=s,t=C(e.activeKey),i=C(!1),r=C("新增分组"),o=ta(),a=fe(),d=C(0),c=C(),n=ae({label:void 0}),_=(u,k)=>{if(k==="add"){r.value="add";const b=e.options.filter(A=>A.label.includes("分组_"));let T=d.value+1,R=!1;for(;!R;)R=!b.some(P=>{const[Q,le]=P.label.split("_");return T===Number(le)?(T=Number(le)+1,!0):!1});d.value=T,n.label="分组_"+T,m()}},g=u=>{i.value=!0,r.value="edit",n.label=u.label},y=()=>{c.value.resetFields(),i.value=!1},m=()=>{const u={...n};r.value==="add"?(u.value="group_"+$t(),t.value=u.value,p(r.value,u),p("change",u.value,u.label),p("update:activeKey",u.value),i.value=!1):c.value.validate().then(()=>{u.value=t.value,p(r.value,u),p("change",u.value,u.label),i.value=!1})},h=()=>{const u=e.options.find(k=>k.value===t.value);p("change",t.value,u.label),p("update:activeKey",t.value)},w=(u,k)=>{u.key==="edit"?g(k):Ye.confirm({title:"将会同步删除分组内的数据，确认删除？",onOk:()=>{const b=e.options.findIndex(R=>R.value===k.value);let T="";b!==0&&b===e.options.length-1?(t.value=e.options[b-1].value,T=e.options[b-1].label):b===0&&e.options.length===1?(t.value=e.options[0].value,T=e.options[0].label):(t.value=e.options[b+1].value,T=e.options[b+1].label),p("delete",k.value,b),p("change",t.value,T)}})},S=u=>a.value||u,$=u=>Ot()&&a.value||document.body;return Ve(()=>{var u,k;t.value=(u=e.options[0])==null?void 0:u.value,p("change",t.value,(k=e.options[0])==null?void 0:k.label),p("update:activeKey",t.value)}),E(()=>e.activeKey,u=>{t.value=u}),(u,k)=>{const b=nt,T=ot,R=ut,A=Rt,P=Vt,Q=jt,le=Re,z=pe,Z=oe,ue=X,ge=Ye;return x(),B("div",_l,[f(Q,{type:"editable-card",activeKey:l(t),"onUpdate:activeKey":k[0]||(k[0]=K=>W(t)?t.value=K:null),onEdit:_,onChange:h},{default:v(()=>[(x(!0),B($e,null,Oe(s.options,K=>(x(),V(P,{key:K.value,closable:!1},{tab:v(()=>[l(t)===K.value?(x(),V(A,{key:0,trigger:["click"],getPopupContainer:M=>l(a)||M},{overlay:v(()=>[f(T,{onClick:M=>{w(M,K)}},{default:v(()=>[f(b,{key:"edit"},{default:v(()=>[N(" 编辑 ")]),_:1}),f(b,{key:"delete"},{default:v(()=>[N(" 删除 ")]),_:1})]),_:2},1032,["onClick"])]),default:v(()=>[O("div",ml,[N(ne(K.label)+" ("+ne(K.effective)+") ",1),l(o)[K.value]?(x(),V(R,{key:0,color:"#ffffff",arrowPointAtCenter:!0,"get-popup-container":S},{title:v(()=>[yl]),default:v(()=>[gl]),_:1})):q("",!0)])]),_:2},1032,["getPopupContainer"])):(x(),B("div",bl,[N(ne(K.label)+" ("+ne(K.effective)+") ",1),l(o)[K.value]?(x(),V(R,{key:0,color:"#ffffff",arrowPointAtCenter:!0,getContainer:S},{title:v(()=>[hl]),default:v(()=>[xl]),_:1})):q("",!0)]))]),_:2},1024))),128))]),_:1},8,["activeKey"]),f(ge,{visible:l(i),title:"编辑分组",maskClosable:!1,getContainer:$,onCancel:y,onOk:m},{default:v(()=>[f(ue,{ref_key:"formRef",ref:c,model:l(n),onFinish:m},{default:v(()=>[f(z,{name:"label",rules:[{required:!0,message:"请输入分组名称"},{max:16,message:"最多可输入16个字符"}]},{default:v(()=>[f(le,{value:l(n).label,"onUpdate:value":k[1]||(k[1]=K=>l(n).label=K),placeholder:"请输入分组名称"},null,8,["value"])]),_:1}),Gt(f(z,null,{default:v(()=>[f(Z,{"html-type":"submit"})]),_:1},512),[[Ht,!1]])]),_:1},8,["model"])]),_:1},8,["visible"])])}}}),Cl=re(Sl,[["__scopeId","data-v-b940d488"]]);const Tl={class:"metadata-edit-table-extra"},wl={class:"metadata-edit-table"},Il=F({name:"MetadataBaseTable"}),$l=Object.assign(Il,{props:{...Mt.tableProps(),...vt(),serial:{type:[Object,Boolean],default:()=>({width:66,title:"序号"})},validateRowKey:{type:Boolean,default:!1}},emits:["scrollDown","rightMenuClick","editChange","groupDelete","groupEdit"],setup(s,{expose:p,emit:e}){const t=s,i=qe();qt();const r=C([]),o=C(),a=C(),d=ae({width:"100%",height:t.height}),c={},n="group_1",_=C({}),g=C({}),y=ae({key:void 0,order:void 0,orderKeys:[],dataIndex:void 0}),{groupActive:m,groupOptions:h,addGroup:w,removeGroup:S,updateGroupActive:$,updateGroupOptions:u}=Ta(t.openGroup),k=L(()=>{const I=new Map,U=y.key?ha(t.dataSource,j=>{if(!j.id)return 99999999;const G=At(y.orderKeys,D=>Be(j,y.key)===D);return y.order==="desc"?G:~G+1}):t.dataSource;return U.forEach((j,G)=>{var D,ve,ee;if(j.__dataIndex=G,t.openGroup){((D=j.expands)==null?void 0:D.groupId)||(j.expands.groupId=m.value||n,j.expands.groupName=m.label||"分组_1");const te=I.get(j.expands.groupId);te?(j.id&&(te.effective+=1),te.len+=1,I.set(j.expands.groupId,te)):I.set(j.expands.groupId,{value:(ve=j.expands)==null?void 0:ve.groupId,label:(ee=j.expands)==null?void 0:ee.groupName,effective:j.id?1:0,len:1}),j.__serial=(te==null?void 0:te.len)||1}else j.__serial=G+1}),t.openGroup&&u([...I.values()]),U}),b=L(()=>t.openGroup?k.value.filter(I=>I.expands.groupId===m.value):k.value);Sa(o,J);const{isFullscreen:T,toggle:R}=Et(o),{rules:A,validateItem:P,validate:Q,errorMap:le}=Ca(k,t.columns,t.rowKey,{onError:I=>{_.value={},g.value={};const U={};I.forEach((j,G)=>{j.forEach((D,ve)=>{const ee=ue(D.__dataIndex,D.field),me=ee?ee.eventKey:`${D.__dataIndex}-${D.field}`;if(ee&&ee.showErrorTip(D.message),U[me]=D.message,G===0&&ve===0){if(t.openGroup){const te=k.value[D.__dataIndex].expands;$(te.groupId,te.groupName)}setTimeout(()=>{a.value.scrollTo(D.__serial-1)},10)}})}),_.value=U},onSuccess:()=>{_.value={}},onEdit:()=>{e("editChange",!0)},validateRowKey:t.validateRowKey});ce(aa,o),ce(la,T),ce(na,{click:xe,getPopupContainer:()=>o.value}),ce(oa,_),ce(sa,g),ce(ua,k),ce(da,t.openGroup),ce(ra,{scrollTo:I=>{if(t.openGroup){const U=I.expands;$(U.groupId,U.groupName)}setTimeout(()=>{a.value.scrollTo(I.__serial)},10)},selected:I=>{a.value.updateSelectedKeys(I)},order:(I,U,j,G)=>{y.key=U,y.order=I,y.orderKeys=j,y.dataIndex=G},cleanOrder:()=>{y.key=void 0,y.order=void 0,y.orderKeys=[],y.dataIndex=void 0},sortData:y}),ce(ia,h),ce(ca,m);const z=(I,U)=>{c[I]=U},Z=I=>{delete c[I]};function ue(I,U){const j=Object.keys(c).find(G=>{const{names:D}=c[G];return D[0]===I&&D[1]===U});return c[j]}function ge(I){delete _.value[I]}function K(I,U){_.value[I]=U}const M=L(()=>t.dataSource.length*t.cellHeight>t.height?17:0);function J({width:I=0,height:U}){var D;const j=I-M.value;d.width=I||"100%";let G=[...t.columns];t.serial&&(G=[{dataIndex:"__serial",title:t.serial.title||"序号",customRender:ee=>{var me,te;return(me=t.serial)!=null&&me.customRender?(te=t.serial)==null?void 0:te.customRender(ee):ee.index+1},width:(D=t.serial)==null?void 0:D.width},...t.columns]),r.value=ka(G,j)}const he=I=>{e("scrollDown",I)};function xe(I,U,j){e("rightMenuClick",I,U,j)}const ke=I=>{const U=k.value.findIndex(j=>j[t.rowKey]===I);a.value.scrollTo(U)},H=I=>{a.value.scrollTo(I)},je=()=>o.value,Me=(I,U)=>{S(U),Object.keys(_.value).forEach(j=>{var ee;const[G]=j.split("-");((ee=k.value[G].expands)==null?void 0:ee.groupId)===I&&(ge(j),Z(j))}),e("groupDelete",I)},Ae=I=>{e("groupEdit",I)},Ee=()=>m.value;return E(()=>_.value,I=>{if(g.value={},t.openGroup){const U=I,j={};Object.keys(U).forEach(G=>{var Je;const[D]=G.split("-"),ve=k.value[D],ee=(Je=ve.expands)==null?void 0:Je.groupId,me=j[ee],te={[G]:{message:U[G],index:D,serial:ve.__serial}};me?me.push(te):j[ee]=[te]}),console.log(j),g.value=j}},{deep:!0}),E(()=>M.value,()=>{J({width:d.width})}),pa({dataSource:L(()=>t.dataSource),errorMap:le,rules:A,addField:z,removeField:Z,removeFieldError:ge,addFieldError:K,validateItem:P}),p({validate:Q,tableWrapper:o,scrollToById:ke,scrollToByIndex:H,getTableWrapperRef:je,getGroupActive:Ee}),(I,U)=>(x(),B("div",{class:ie({"metadata-edit-table-wrapper":!0,"table-full-screen":l(T)}),ref_key:"tableWrapper",ref:o},[O("div",Tl,[Y(I.$slots,"extra",{isFullscreen:l(T),fullScreenToggle:l(R)},void 0,!0)]),O("div",wl,[O("div",{class:"metadata-edit-table-header",style:de([{height:"50px"},{paddingRight:l(M)+"px"}])},[f(tl,{columns:l(r),style:de({width:l(d).width})},null,8,["columns","style"])],4),O("div",{class:"metadata-edit-table-body",style:de({width:l(d).width,height:`${I.height}px`})},[f(fl,{ref_key:"tableBody",ref:a,dataSource:l(b),columns:l(r),cellHeight:I.cellHeight,height:I.height,disableMenu:I.disableMenu,rowKey:I.rowKey,groupKey:l(m).value,openGroup:I.openGroup,rowSelection:I.rowSelection,onScrollDown:he},Wt({_:2},[Oe(l(i),(j,G)=>({name:G,fn:v(D=>[Y(I.$slots,G,zt(Jt(D||{})),void 0,!0)])}))]),1032,["dataSource","columns","cellHeight","height","disableMenu","rowKey","groupKey","openGroup","rowSelection"]),Y(I.$slots,"bodyExtra",{},void 0,!0)],4),I.dataSource.length&&I.openGroup?(x(),V(Cl,{key:0,activeKey:l(m).value,"onUpdate:activeKey":U[0]||(U[0]=j=>l(m).value=j),options:l(h),onAdd:l(w),onDelete:Me,onEdit:Ae,onChange:l($)},null,8,["activeKey","options","onAdd","onChange"])):q("",!0)])],2))}}),ze=re($l,[["__scopeId","data-v-a2dc8a71"]]);const Ol={style:{color:"#1d2129"}},Rl={key:0,class:"table-form-error-target"},Vl=["id"],jl=F({name:"TableFormItem"}),Ml=Object.assign(jl,{props:{name:{type:[String,Array],default:void 0},required:{type:Boolean,default:!1}},emits:["change"],setup(s,{emit:p}){const e=s;fe();const t=va(),i=fa();let r;const o=L(()=>(Ue(e.name)?e.name:[e.name]).join("-")),a=ae({message:"",visible:!1}),d=L(()=>(Ue(e.name)?e.name:[e.name]).join("_")),c=L(()=>{const S=Ue(e.name)?e.name:[e.name],$=t.rules.value;let u;for(const k of S)k in $&&(u=k);return u});L(()=>Be(t.dataSource.value,e.name)),ce(_a,a);const n=S=>S,_=()=>{r&&(window.clearTimeout(r),r=null)},g=S=>{_(),a.message=S,a.visible=!0},y=()=>{a.visible=!1,_(),r=setTimeout(()=>{a.message=""},300)},m=()=>{let S=0;Ue(e.name)&&(S=e.name[0]);const $=t.validateItem({[c.value]:Be(t.dataSource.value,e.name)},S);return $.then(()=>{y(),t.removeFieldError(o.value)}).catch(u=>{var b;const k=(u==null?void 0:u.filter(T=>T.field===c.value))||[];return k.length===0?(y(),t.removeFieldError(o.value)):(_(),a.message=((b=k[0])==null?void 0:b.message)||a.message,a.visible=!!k.length,t.addFieldError(o.value,a.message)),a.message}),$},h=()=>{},w=()=>{m(),p("change")};return E(()=>i.value,S=>{S[o.value]?g(S[o.value]):y()},{immediate:!0,deep:!0}),Ut({id:d,onFieldChange:w,onFieldBlur:h},L(()=>Be(t.dataSource.value,e.name))),He(()=>{y()}),E(()=>[c.value,e.name],()=>{t.addField(o.value,{filedName:c.value,eventKey:o.value,names:e.name,validateRules:m,showErrorTip:g})},{immediate:!0}),(S,$)=>{const u=ut;return x(),B($e,null,[f(u,{color:"#ffffff","get-popup-container":n,arrowPointAtCenter:!0},{title:v(()=>[O("span",Ol,ne(l(a).message),1)]),default:v(()=>[l(a).visible?(x(),B("div",Rl)):q("",!0)]),_:1}),O("div",{id:o.value,style:{position:"relative"},class:ie({"edit-table-form-has-error":l(a).message})},[Y(S.$slots,"default",{},void 0,!0)],10,Vl)],64)}}}),we=re(Ml,[["__scopeId","data-v-885bfddd"]]),Al=F({name:"MetadataScaleItem"}),ft=Object.assign(Al,{props:{value:{type:Number,default:0},name:{type:String,default:"scale"}},emits:["update:value"],setup(s,{emit:p}){const e=s,t=C(e.value),i=()=>{p("update:value",t.value)};return E(()=>e.value,()=>{t.value=e.value}),(r,o)=>{const a=dt,d=pe;return x(),V(d,{label:"精度",name:s.name},{default:v(()=>[f(a,{value:l(t),"onUpdate:value":o[0]||(o[0]=c=>W(t)?t.value=c:null),style:{width:"100%"},precision:0,min:0,max:99,placeholder:"请输入0-99以内的整数",onChange:i},null,8,["value"])]),_:1},8,["name"])}}}),El=F({name:"MetadataStringItem"}),_t=Object.assign(El,{props:{value:{type:Number,default:0},name:{type:String,default:"maxLength"}},emits:["update:value"],setup(s,{emit:p}){const e=s,t=C(e.value),i=()=>{p("update:value",t.value)};return E(()=>e.value,r=>{t.value=r},{immediate:!0}),(r,o)=>{const a=dt,d=pe;return x(),V(d,{label:"最大长度",name:s.name},{default:v(()=>[f(a,{value:l(t),"onUpdate:value":o[0]||(o[0]=c=>W(t)?t.value=c:null),style:{width:"100%"},placeholder:"请输入0-9999以内的整数",precision:0,min:0,max:9999,onChange:i},null,8,["value"])]),_:1},8,["name"])}}});const mt=s=>(Ke("data-v-8fc93ea9"),s=s(),Ne(),s),Ul={class:"boolean-items"},Pl={class:"boolean-item boolean-true"},Fl={class:"boolean-true-text"},Bl=mt(()=>O("span",null,"-",-1)),Kl={class:"boolean-true-value"},Nl={class:"boolean-item boolean-false"},Dl={class:"boolean-false-text"},Ll=mt(()=>O("span",null,"-",-1)),Gl={class:"boolean-false-value"},Hl=F({name:"BooleanItemContext"}),ql=Object.assign(Hl,{props:{value:{type:Object,default:{}}},emits:["update:value","change"],setup(s,{emit:p}){var r,o,a,d;const e=s,t=ae({trueText:((r=e.value)==null?void 0:r.trueText)||"是",trueValue:((o=e.value)==null?void 0:o.trueValue)||"true",falseText:((a=e.value)==null?void 0:a.falseText)||"否",falseValue:((d=e.value)==null?void 0:d.falseValue)||"false"}),i=()=>{p("update:value",Qe(t)),p("change",Qe(t))};return E(()=>JSON.stringify(e.value),()=>{var c,n,_,g;t.trueText=(c=e.value)==null?void 0:c.trueText,t.trueValue=(n=e.value)==null?void 0:n.trueValue,t.falseText=(_=e.value)==null?void 0:_.falseText,t.falseValue=(g=e.value)==null?void 0:g.falseValue},{immediate:!0}),(c,n)=>{const _=Re;return x(),B("div",Ul,[O("div",Pl,[O("div",Fl,[f(_,{value:l(t).trueText,"onUpdate:value":n[0]||(n[0]=g=>l(t).trueText=g),onChange:i},null,8,["value"])]),Bl,O("div",Kl,[f(_,{value:l(t).trueValue,"onUpdate:value":n[1]||(n[1]=g=>l(t).trueValue=g),onChange:i},null,8,["value"])])]),O("div",Nl,[O("div",Dl,[f(_,{value:l(t).falseText,"onUpdate:value":n[2]||(n[2]=g=>l(t).falseText=g),onChange:i},null,8,["value"])]),Ll,O("div",Gl,[f(_,{value:l(t).falseValue,"onUpdate:value":n[3]||(n[3]=g=>l(t).falseValue=g),onChange:i},null,8,["value"])])])])}}}),Wl=re(ql,[["__scopeId","data-v-8fc93ea9"]]),zl=F({name:"MetadataBooleanItem"}),yt=Object.assign(zl,{props:{value:{type:Object,default:()=>({})},name:{type:String,default:"value"}},emits:["update:value","change"],setup(s,{emit:p}){const e=s,t=C(e.value),i=[{validator(o,a){const d=Object.values(a).some(n=>n.length>64),c=Object.values(a).some(n=>!n);return d?Promise.reject("最多可输入64个字符"):c?Promise.reject("请输入布尔值"):Promise.resolve()}}],r=()=>{p("update:value",t.value),p("change",t.value)};return E(()=>JSON.stringify(e.value),()=>{t.value=e.value}),(o,a)=>{const d=pe;return x(),V(d,{label:"布尔值",required:"",name:s.name,rules:i,"validate-first":!0},{default:v(()=>[f(Wl,{value:l(t),"onUpdate:value":a[0]||(a[0]=c=>W(t)?t.value=c:null),onChange:r},null,8,["value"])]),_:1},8,["name"])}}}),Jl=F({name:"MetadataDateItem"}),gt=Object.assign(Jl,{props:{value:{type:String,default:void 0},name:{type:String,default:"format"}},emits:["update:value"],setup(s,{emit:p}){const e=s,t=[{label:"yyyy-MM-dd HH:mm:ss",value:"yyyy-MM-dd HH:mm:ss"},{label:"yyyy-MM-dd",value:"yyyy-MM-dd"},{label:"hh:mm:ss",value:"hh:mm:ss"}],i=C(e.value),r=fe(),o=()=>{p("update:value",i.value)};return E(()=>e.value,()=>{i.value=e.value}),(a,d)=>{const c=pe;return x(),V(c,{label:"时间格式",required:"",name:s.name,rules:[{required:!0,message:"请选择时间格式"}]},{default:v(()=>[f(l(Pt),{value:l(i),"onUpdate:value":d[0]||(d[0]=n=>W(i)?i.value=n:null),options:t,mode:"tags",placeholder:"请选择时间格式",dropdownStyle:{zIndex:1072},getPopupContainer:n=>l(r)||n,onChange:o},null,8,["value","getPopupContainer"])]),_:1},8,["name"])}}});const Yl=F({name:"EnumItemContent"}),Xl=Object.assign(Yl,{props:{value:{type:Array,default:()=>[]}},emits:["update:value","change"],setup(s,{expose:p,emit:e}){const t=s,i=X.useInjectFormItemContext(),r=C(t.value||[]),o=C(),a=[{title:"Value",dataIndex:"value",form:{rules:[{max:64,message:"最多可输入64个字符"},{asyncValidator:(g,y,...m)=>{const h=m[2];return y?r.value.some(S=>S.__dataIndex!==h.index&&S.value===y)?Promise.reject("该Value值已存在"):Promise.resolve():Promise.reject("请输入Value值")}}]}},{title:"Text",dataIndex:"text",width:150,form:{rules:[{required:!0,message:"请输入Text"},{max:64,message:"最多可输入64个字符"}]}},{title:"操作",dataIndex:"action",width:60}],d=g=>{r.value.splice(g,1),e("update:value",r.value),e("change",r.value),i.onFieldChange()},c=()=>{r.value.push({value:void 0,text:void 0}),e("update:value",r.value),e("change",r.value),i.onFieldChange()},n=()=>{e("update:value",r.value),e("change",r.value),i.onFieldChange()};return p({validate:async()=>{var y;return await((y=o.value)==null?void 0:y.validate())}}),E(()=>JSON.stringify(t.value),()=>{r.value=t.value||[]}),(g,y)=>{const m=Re,h=se("AIcon"),w=oe;return x(),B("div",null,[f(ze,{ref_key:"tableRef",ref:o,rowKey:"value",columns:a,dataSource:l(r),pagination:!1,height:200,disableMenu:!1,validateRowKey:!0},{value:v(({record:S,index:$})=>[f(we,{name:[$,"value"]},{default:v(()=>[f(m,{value:S.value,"onUpdate:value":u=>S.value=u,onChange:n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),text:v(({record:S,index:$})=>[f(we,{name:[$,"text"]},{default:v(()=>[f(m,{value:S.text,"onUpdate:value":u=>S.text=u,onChange:n},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),action:v(({index:S})=>[f(w,{danger:"",type:"link",onClick:()=>d(S)},{icon:v(()=>[f(h,{type:"DeleteOutlined"})]),_:2},1032,["onClick"])]),_:1},8,["dataSource"]),f(w,{class:"enum-table-add",onClick:c},{icon:v(()=>[f(h,{type:"PlusOutlined"})]),default:v(()=>[N(" 新增枚举项 ")]),_:1})])}}}),Zl=re(Xl,[["__scopeId","data-v-b7bc2565"]]),Ql=O("span",{style:{color:"#ff4d4f","padding-right":"4px","padding-top":"2px"}},"*",-1),en=F({name:"MetadataEnumItem"}),bt=Object.assign(en,{props:{value:{type:Array,default:()=>[]},type:{type:Boolean,default:!1},name:{type:String,default:"elements"}},emits:["update:value"],setup(s,{expose:p,emit:e}){const t=s,i=C(t.value||[]),r=C(),o=[{validator:async(c,n)=>{var _;return console.log(n,i.value),(_=i.value)!=null&&_.length?Promise.resolve():Promise.reject("请添加枚举项")}}],a=()=>{e("update:value",i.value)};return p({validate:async()=>{var n;return await((n=r.value)==null?void 0:n.validate())}}),E(()=>JSON.stringify(t.value),c=>{i.value=c?JSON.parse(c):[]}),(c,n)=>{const _=pe;return x(),V(_,{name:s.name,rules:o,"validate-first":!0},{label:v(()=>[N(" 枚举项 "),Ql]),default:v(()=>[f(Zl,{ref_key:"tableRef",ref:r,value:l(i),"onUpdate:value":n[0]||(n[0]=g=>W(i)?i.value=g:null),onChange:a},null,8,["value"])]),_:1},8,["name"])}}}),tn={style:{width:"450px"}},an=F({name:"MetadataArray"}),ln=Object.assign(an,{props:{value:{type:Object,default:()=>({})},unitOptions:{type:[Array,Function],default:()=>[]},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","cancel","confirm"],setup(s,{emit:p}){var u,k,b,T,R,A,P,Q,le,z,Z,ue,ge;const e=s,t=X.useInjectFormItemContext(),i=C(),r=C(),o=C(!1),a=ae({type:(u=e.value)==null?void 0:u.type,scale:(k=e.value)==null?void 0:k.scale,expands:{maxLength:((b=e.value)==null?void 0:b.maxLength)||((R=(T=e.value)==null?void 0:T.expands)==null?void 0:R.maxLength)},boolean:{trueText:((A=e.value)==null?void 0:A.trueText)||"是",trueValue:((P=e.value)==null?void 0:P.trueValue)||"true",falseText:((Q=e.value)==null?void 0:Q.falseText)||"否",falseValue:((le=e.value)==null?void 0:le.falseValue)||"false"},format:(z=e.value)==null?void 0:z.format,enum:{multiple:(Z=e.value)==null?void 0:Z.multiple,elements:Te((ue=e.value)==null?void 0:ue.elements)||[]},elementType:((ge=e.value)==null?void 0:ge.type)==="array"?e.value.elementType:{type:void 0}}),d=L(()=>["float","double"].includes(a.type)),c=L(()=>["string","password"].includes(a.type)),n=L(()=>a.type==="boolean"),_=L(()=>a.type==="date"),g=L(()=>a.type==="enum"),y=L(()=>a.type==="array"),m=[{validator(K,M){return M?Promise.resolve():Promise.reject("请选择元素类型")},trigger:"change"}],h=()=>{var K,M,J,he,xe,ke,H,je,Me,Ae,Ee,I,U;a.type=(K=e.value)==null?void 0:K.type,a.scale=(M=e.value)==null?void 0:M.scale,a.expands.maxLength=((J=e.value)==null?void 0:J.maxLength)||((xe=(he=e.value)==null?void 0:he.expands)==null?void 0:xe.maxLength),a.boolean={trueText:((ke=e.value)==null?void 0:ke.trueText)||"是",trueValue:((H=e.value)==null?void 0:H.trueValue)||"true",falseText:((je=e.value)==null?void 0:je.falseText)||"否",falseValue:((Me=e.value)==null?void 0:Me.falseValue)||"false"},a.format=(Ae=e.value)==null?void 0:Ae.format,a.enum={multiple:(Ee=e.value)==null?void 0:Ee.multiple,elements:Te(((I=e.value)==null?void 0:I.elements)||[])},a.elementType=((U=e.value)==null?void 0:U.type)==="array"?e.value.elementType:{type:void 0}},w=(K,M)=>{let J={};switch(K){case"float":case"double":J=Pe(M,"scale");break;case"boolean":J={...M.boolean};break;case"enum":J.elements=M.enum.elements;break;case"string":case"password":J=Pe(M,"expands");break;case"date":J=Pe(M,"format");break;case"array":J=Pe(M,"elementType")}return{type:K,...J}},S=async()=>{const K=await i.value.validate();let M=!0;if(r.value&&(M=!!await r.value.validate()),K&&M){o.value=!1;const J=w(a.type,a);p("update:value",J),p("confirm",J),t.onFieldChange()}},$=()=>{var K;(K=i.value)==null||K.resetFields(),h(),p("cancel")};return E(()=>JSON.stringify(e.value),()=>{h()}),(K,M)=>{const J=pe,he=X,xe=se("AIcon"),ke=oe;return x(),V(l(_e),{visible:l(o),"onUpdate:visible":M[7]||(M[7]=H=>W(o)?o.value=H:null),placement:s.placement,onOk:S,onCancel:$},{content:v(()=>[O("div",tn,[f(he,{ref_key:"formRef",ref:i,layout:"vertical",model:l(a)},{default:v(()=>[f(J,{label:"元素类型",required:"",name:"type",rules:m,"validate-first":!0},{default:v(()=>[f(l(Ge),{value:l(a),"onUpdate:value":M[0]||(M[0]=H=>W(a)?a.value=H:null)},null,8,["value"])]),_:1}),l(d)?(x(),V(ft,{key:0,value:l(a).scale,"onUpdate:value":M[1]||(M[1]=H=>l(a).scale=H)},null,8,["value"])):l(c)?(x(),V(_t,{key:1,value:l(a).expands.maxLength,"onUpdate:value":M[2]||(M[2]=H=>l(a).expands.maxLength=H)},null,8,["value"])):l(n)?(x(),V(yt,{key:2,value:l(a).boolean,"onUpdate:value":M[3]||(M[3]=H=>l(a).boolean=H),name:"boolean"},null,8,["value"])):l(_)?(x(),V(gt,{key:3,value:l(a).format,"onUpdate:value":M[4]||(M[4]=H=>l(a).format=H)},null,8,["value"])):l(g)?(x(),V(bt,{key:4,ref_key:"enumTableRef",ref:r,value:l(a).enum.elements,"onUpdate:value":M[5]||(M[5]=H=>l(a).enum.elements=H)},null,8,["value"])):l(y)?(x(),V(J,{key:5,label:"子元素类型",required:"",name:["elementType","type"],rules:[{required:!0,message:"请选择子元素类型"}]},{default:v(()=>[f(l(Ge),{value:l(a).elementType,"onUpdate:value":M[6]||(M[6]=H=>l(a).elementType=H),filter:["array","object"]},null,8,["value"])]),_:1})):q("",!0)]),_:1},8,["model"])])]),default:v(()=>[Y(K.$slots,"default",{},()=>[f(ke,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(xe,{type:"EditOutlined",class:ie({"table-form-required-aicon":!s.value.type})},null,8,["class"])]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),nn=ln,on=F({name:"BooleanSelect"}),sn=Object.assign(on,{props:{...rt(),value:{type:[Boolean,Number,String],default:!0},trueLabel:{type:String,default:"必填"},falseLabel:{type:String,default:"不必填"},trueValue:{type:[Boolean,Number,String],default:!0},falseValue:{type:[Boolean,Number,String],default:!1}},emits:["update:value","change"],setup(s,{emit:p}){const e=s,t=fe(),i=C(),r=L(()=>{const a=Xe(e.trueValue)?String(e.trueValue):e.trueValue,d=Xe(e.falseValue)?String(e.falseValue):e.falseValue;return[{label:e.trueLabel,value:a,baseValue:e.trueValue},{label:e.falseLabel,value:d,baseValue:e.falseValue}]}),o=a=>{const d=r.value.find(c=>c.value===i.value);p("update:value",d.baseValue),p("change",d.baseValue)};return E(()=>[e.value,r.value],()=>{const a=r.value.find(d=>d.baseValue===e.value);i.value=a?a.value:r.value[0].value},{immediate:!0}),(a,d)=>{const c=Ft;return x(),V(c,{value:l(i),"onUpdate:value":d[0]||(d[0]=n=>W(i)?i.value=n:null),style:{width:"100%"},options:l(r),getPopupContainer:n=>l(t)||n,onChange:o},null,8,["value","options","getPopupContainer"])}}}),un=sn,dn={style:{width:"750px"}},rn={style:{display:"flex",gap:"12px","align-items":"center"}},cn=F({name:"MetadataObject"}),pn=Object.assign(cn,{props:{value:{type:Array,default:()=>[]},placement:{type:String,default:"top"},type:{type:String,default:"properties"},disabled:{type:Boolean,default:!1}},emits:["update:value","confirm","cancel"],setup(s,{emit:p}){const e=s,t=(m,h=!1)=>{var w,S;return m?m.type==="enum"&&!((w=m.elements)!=null&&w.length)?Promise.reject("请添加枚举项"):m.type==="array"&&!((S=m.elementType)!=null&&S.type)?Promise.reject("请选择元素类型"):m.type==="date"&&!m.format?Promise.reject("请选择时间格式"):m.type==="file"&&(!m.bodyType||Bt(m.bodyType)&&!Object.keys(m.bodyType).length)?Promise.reject("请选择文件类型"):Promise.resolve():Promise.resolve()},i=X.useInjectFormItemContext();qe();const r=C(),o=C([]),a=C(!1),d=[{title:"参数标识",dataIndex:"id",form:{rules:[{asyncValidator(m,h,...w){if(h){const S=w[2];return o.value.some(u=>u.__dataIndex!==S.index&&u.id===h)?Promise.reject("该标识已存在"):Promise.resolve()}return Promise.reject("请输入标识")}},{max:64,message:"最多可输入64个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"标识只能由数字、字母、下划线组成"}]}},{title:"参数名称",dataIndex:"name",form:{rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多可输入64个字符"}]}},e.type==="functions"?{title:"填写约束",dataIndex:"expands",width:120}:null,{title:"数据类型",dataIndex:"valueType",width:240,form:{required:!0,rules:[{validator(m,h){return h!=null&&h.type?t(h,!0):Promise.reject("请选择数据类型")}}]}}],c=L(()=>[...d.filter(m=>!!m),{dataIndex:"action",title:"操作",width:60}]),n=async()=>{const m=await r.value.validate();m&&(a.value=!1,p("update:value",m),p("confirm",m),i.onFieldChange())},_=()=>{p("cancel")},g=m=>{o.value.splice(m,1)},y=()=>{o.value.push({id:void 0,name:void 0,expands:{required:!1},valueType:{expands:{}}})};return E(()=>[JSON.stringify(e.value),a.value],m=>{a.value&&(o.value=JSON.parse(m[0]||"[]").map(h=>(h={expands:{required:!1},...h},h)))},{immediate:!0}),(m,h)=>{const w=Re,S=se("AIcon"),$=oe;return x(),V(l(_e),{visible:l(a),"onUpdate:visible":h[0]||(h[0]=u=>W(a)?a.value=u:null),placement:s.placement,onOk:n,onCancel:_},{content:v(()=>[O("div",dn,[f(l(ze),{ref_key:"tableRef",ref:r,columns:l(c),dataSource:l(o),pagination:!1,height:200},{id:v(({record:u,index:k})=>[f(l(we),{name:[k,"id"]},{default:v(()=>[f(w,{value:u.id,"onUpdate:value":b=>u.id=b,placeholder:"请输入标识"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),name:v(({record:u,index:k})=>[f(l(we),{name:[k,"name"]},{default:v(()=>[f(w,{value:u.name,"onUpdate:value":b=>u.name=b,placeholder:"请输入名称"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),expands:v(({record:u})=>[f(un,{value:u.expands.required,"onUpdate:value":k=>u.expands.required=k},null,8,["value","onUpdate:value"])]),valueType:v(({record:u,index:k})=>[f(l(we),{name:[k,"valueType"]},{default:v(()=>[O("div",rn,[f(l(Ge),{value:u.valueType,"onUpdate:value":b=>u.valueType=b,style:{flex:"1 1 0","min-width":"0"}},null,8,["value","onUpdate:value"]),["float","double"].includes(u.valueType.type)?(x(),V(l(Nn),{key:0,value:u.valueType,"onUpdate:value":b=>u.valueType=b,placement:"topRight"},null,8,["value","onUpdate:value"])):u.valueType.type==="string"?(x(),V(l(Hn),{key:1,value:u.valueType,"onUpdate:value":b=>u.valueType=b,placement:"topRight"},null,8,["value","onUpdate:value"])):u.valueType.type==="date"?(x(),V(l(mn),{key:2,value:u.valueType.format,"onUpdate:value":b=>u.valueType.format=b,placement:"topRight"},null,8,["value","onUpdate:value"])):u.valueType.type==="file"?(x(),V(l(An),{key:3,value:u.valueType.bodyType,"onUpdate:value":b=>u.valueType.bodyType=b,placement:"topRight"},null,8,["value","onUpdate:value"])):u.valueType.type==="enum"?(x(),V(l($n),{key:4,value:u.valueType.elements,"onUpdate:value":b=>u.valueType.elements=b,placement:"topRight"},null,8,["value","onUpdate:value"])):u.valueType.type==="boolean"?(x(),V(l(Cn),{key:5,falseText:u.valueType.falseText,"onUpdate:falseText":b=>u.valueType.falseText=b,falseValue:u.valueType.falseValue,"onUpdate:falseValue":b=>u.valueType.falseValue=b,trueText:u.valueType.trueText,"onUpdate:trueText":b=>u.valueType.trueText=b,trueValue:u.valueType.trueValue,"onUpdate:trueValue":b=>u.valueType.trueValue=b,placement:"topRight"},null,8,["falseText","onUpdate:falseText","falseValue","onUpdate:falseValue","trueText","onUpdate:trueText","trueValue","onUpdate:trueValue"])):u.valueType.type==="array"?(x(),V(l(nn),{key:6,value:u.valueType.elementType,"onUpdate:value":b=>u.valueType.elementType=b,placement:"topRight"},null,8,["value","onUpdate:value"])):q("",!0)])]),_:2},1032,["name"])]),action:v(({index:u})=>[f($,{danger:"",type:"link",style:{padding:"0 5px"},onClick:()=>g(u)},{icon:v(()=>[f(S,{type:"DeleteOutlined"})]),_:2},1032,["onClick"])]),_:1},8,["columns","dataSource"]),f($,{style:{width:"100%","margin-top":"4px"},onClick:y},{icon:v(()=>[f(S,{type:"PlusOutlined"})]),default:v(()=>[N(" 新增 ")]),_:1})])]),default:v(()=>[Y(m.$slots,"default",{},()=>[f($,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(S,{type:"EditOutlined",class:ie({"table-form-required-aicon":!s.value.length})},null,8,["class"])]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),po=pn,vn={style:{width:"200px"}},fn=F({name:"MetadataDate"}),_n=Object.assign(fn,{props:{value:{type:String,default:void 0},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","confirm","cancel"],setup(s,{emit:p}){const e=s,t=X.useInjectFormItemContext(),i=C(),r=C(!1),o=ae({format:e.value}),a=async()=>{await i.value.validate()&&(r.value=!1,p("update:value",o.format),p("confirm",o.format),t.onFieldChange())},d=()=>{var c;(c=i.value)==null||c.resetFields(),o.format=e.value,p("cancel")};return E(()=>e.value,c=>{o.format=c}),(c,n)=>{const _=X,g=se("AIcon"),y=oe;return x(),V(l(_e),{visible:l(r),"onUpdate:visible":n[1]||(n[1]=m=>W(r)?r.value=m:null),placement:s.placement,onOk:a,onCancel:d},{content:v(()=>[O("div",vn,[f(_,{ref_key:"formRef",ref:i,layout:"vertical",model:l(o)},{default:v(()=>[f(gt,{value:l(o).format,"onUpdate:value":n[0]||(n[0]=m=>l(o).format=m)},null,8,["value"])]),_:1},8,["model"])])]),default:v(()=>[Y(c.$slots,"default",{},()=>[f(y,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(g,{type:"EditOutlined",class:ie({"table-form-required-aicon":!s.value})},null,8,["class"])]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),mn=_n;let ye=[];const et="popover-mask",yn=()=>document.body.scrollHeight>document.body.clientHeight,Se=(s,p)=>{s&&Object.keys(p).forEach(e=>{s.style[e]=p[e]})},gn=()=>{yn()&&Se(document.body,{overflow:"hidden",width:"calc(100% - 17px)"})},bn=(s,p)=>{let e=document.querySelector(`#${s}`);if(e)return e;e=document.createElement("div"),e.id=s,Se(e,{position:"fixed",top:0,bottom:0,left:0,right:0,"z-index":1070,"background-color":"#0003"});const t=document.querySelector(`.${p}`);if(t)return t.insertAdjacentElement("beforebegin",e),e},hn=(s,p)=>{const e=st(6),t=C(s),i=`${et}-${e}`,r=`${et}-warp-${e}`,o=()=>(ye.includes(i)||ye.push(i),bn(i,r)),a=()=>{const y=ye.findIndex(w=>w===i);let m,h=0;if(ye.length>0){h=y<=0?0:y-1;const w=ye[h];m=document.querySelector(`#${w}`)}return m},d=()=>{const y=a();Se(y,{display:"none"})},c=()=>{const y=a();Se(y,{display:"block"})},n=()=>{gn(),setTimeout(()=>{d();const y=o();Se(y,{display:"block"})},150)},_=()=>{const y=o();c();const m=ye.findIndex(h=>h===i);ye.splice(m,1),m===0&&(document.body.style="",ye=[]),Se(y,{display:"none"})};return{warpClassNames:r,visible:t,hideMask:_,showMask:n,visibleChange:y=>{t.value=y,p==null||p.visibleChange(y),y?n():_()}}},ht=()=>({trueText:"是",trueValue:"true",falseText:"否",falseValue:"false"}),xn={style:{width:"250px"}},kn=F({name:"MetadataBoolean"}),Sn=Object.assign(kn,{props:{trueText:{type:String,default:void 0},trueValue:{type:String,default:void 0},falseText:{type:String,default:void 0},falseValue:{type:String,default:void 0},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:trueText","update:trueValue","update:falseText","update:falseValue","confirm","cancel"],setup(s,{emit:p}){const e=s,t=X.useInjectFormItemContext(),i=ht(),r=C(),o=C(!1),a=ae({value:{trueText:e.trueText||"是",trueValue:e.trueValue||"true",falseText:e.falseText||"否",falseValue:e.falseValue||"false"}}),d=async()=>{await r.value.validate()&&(o.value=!1,p("update:trueText",a.value.trueText),p("update:trueValue",a.value.trueValue),p("update:falseText",a.value.falseText),p("update:falseValue",a.value.falseValue),p("confirm",a.value),t.onFieldChange())},c=()=>{a.value.trueText=e.trueText||i.trueText,a.value.trueValue=e.trueValue||i.trueValue,a.value.falseText=e.falseText||i.falseText,a.value.falseValue=e.falseValue||i.falseValue},n=()=>{var _;(_=r.value)==null||_.resetFields(),c(),p("cancel")};return E(()=>[e.trueText,e.trueValue,e.falseText,e.falseValue],()=>{c()}),(_,g)=>{const y=X,m=se("AIcon"),h=oe;return x(),V(l(_e),{visible:l(o),"onUpdate:visible":g[1]||(g[1]=w=>W(o)?o.value=w:null),placement:s.placement,onOk:d,onCancel:n},{content:v(()=>[O("div",xn,[f(y,{ref_key:"formRef",ref:r,layout:"vertical",model:l(a)},{default:v(()=>[f(yt,{value:l(a).value,"onUpdate:value":g[0]||(g[0]=w=>l(a).value=w)},null,8,["value"])]),_:1},8,["model"])])]),default:v(()=>[Y(_.$slots,"default",{},()=>[f(h,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(m,{type:"EditOutlined"})]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),Cn=Sn,Tn={key:0,style:{width:"450px"}},wn=F({name:"MetadataEnum"}),In=Object.assign(wn,{props:{value:{type:Array,default:()=>[]},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","confirm","cancel"],setup(s,{emit:p}){const e=s,t=X.useInjectFormItemContext(),i=C(),r=C(),o=C(!1),a=ae({elements:Te(e.value)||[]}),d=()=>{var n;(n=i.value)==null||n.resetFields(),a.elements=Te(e.value)||[],p("cancel")},c=async()=>{const n=await i.value.validate(),_=await r.value.validate();console.log(n,_),n&&_&&(o.value=!1,a.elements=_,p("update:value",a.elements),p("confirm",a.elements),t.onFieldChange())};return E(()=>JSON.stringify(e.value),()=>{a.elements=Te(e.value)||[]}),(n,_)=>{const g=X,y=se("AIcon"),m=oe;return x(),V(l(_e),{visible:l(o),"onUpdate:visible":_[0]||(_[0]=h=>W(o)?o.value=h:null),placement:s.placement,onOk:c,onCancel:d},{content:v(()=>[l(o)?(x(),B("div",Tn,[f(g,{ref_key:"formRef",ref:i,layout:"vertical",model:l(a)},{default:v(()=>[f(bt,{ref_key:"tableRef",ref:r,value:l(a).elements},null,8,["value"])]),_:1},8,["model"])])):q("",!0)]),default:v(()=>[Y(n.$slots,"default",{},()=>[f(m,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(y,{type:"EditOutlined",class:ie({"table-form-required-aicon":!s.value.length})},null,8,["class"])]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),$n=In,On=F({name:"MetadataFileType"}),Rn=Object.assign(On,{props:{name:{type:[String,Array],default:"bodyType"},value:{type:String,default:void 0}},emits:["update:value"],setup(s,{emit:p}){const e=s,t=C(e.value),i=()=>{p("update:value",t.value)};return E(()=>e.value,()=>{t.value=e.value}),(r,o)=>{const a=Kt,d=pe;return x(),V(d,{label:"文件类型",required:"",name:s.name,rules:[{required:!0,message:"请选择文件类型"}]},{default:v(()=>[f(a,{value:t.value,"onUpdate:value":o[0]||(o[0]=c=>t.value=c),options:[{label:"URL",value:"url"},{label:"Base64",value:"base64"},{label:"binary",value:"binary"}],onChange:i},null,8,["value"])]),_:1},8,["name"])}}}),Vn={style:{width:"250px"}},jn=F({name:"MetadataFile"}),Mn=Object.assign(jn,{props:{value:{type:String,default:void 0},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","confirm","cancel"],setup(s,{emit:p}){const e=s,t=X.useInjectFormItemContext(),i=C(),r=ae({bodyType:e.value}),o=C(!1),a=async()=>{await i.value.validate()&&(o.value=!1,p("update:value",r.bodyType),p("onOk",r.bodyType),t.onFieldChange())},d=()=>{var c;(c=i.value)==null||c.resetFields(),r.bodyType=e.value,p("cancel")};return E(()=>e.value,()=>{r.bodyType=e.value}),(c,n)=>{const _=X,g=se("AIcon"),y=oe;return x(),V(l(_e),{visible:l(o),"onUpdate:visible":n[1]||(n[1]=m=>W(o)?o.value=m:null),placement:s.placement,onOk:a,onCancel:d},{content:v(()=>[O("div",Vn,[f(_,{ref_key:"formRef",ref:i,model:l(r),layout:"vertical"},{default:v(()=>[f(Rn,{value:l(r).bodyType,"onUpdate:value":n[0]||(n[0]=m=>l(r).bodyType=m),name:"bodyType"},null,8,["value"])]),_:1},8,["model"])])]),default:v(()=>[Y(c.$slots,"default",{},()=>[f(y,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(g,{type:"EditOutlined",class:ie({"table-form-required-aicon":!s.value})},null,8,["class"])]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),An=Mn,En={style:{width:"200px"}},Un=F({name:"MetadataInteger"}),Pn=Object.assign(Un,{props:{value:{type:String,default:void 0},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","cancel","confirm"],setup(s,{emit:p}){const e=s,t=C(),i=C(!1),r=ae({unit:e.value}),o=async()=>{await t.value.validate()&&(i.value=!1,p("update:value",r.unit),p("confirm",r.unit))},a=()=>{var d;(d=t.value)==null||d.resetFields(),r.unit=e.value,p("cancel")};return E(()=>e.value,d=>{r.unit=d}),(d,c)=>{const n=pe,_=X,g=se("AIcon"),y=oe;return x(),V(l(_e),{visible:l(i),"onUpdate:visible":c[1]||(c[1]=m=>W(i)?i.value=m:null),placement:s.placement,onOk:o,onCancel:a},{content:v(()=>[O("div",En,[f(_,{ref_key:"formRef",ref:t,layout:"vertical",model:l(r)},{default:v(()=>[f(n,{label:"单位",name:"unit",rules:[{max:64,message:"最多可输入64个字符"}]},{default:v(()=>[f(l(xt),{value:l(r).unit,"onUpdate:value":c[0]||(c[0]=m=>l(r).unit=m)},null,8,["value"])]),_:1})]),_:1},8,["model"])])]),default:v(()=>[Y(d.$slots,"default",{},()=>[f(y,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(g,{type:"EditOutlined"})]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),vo=Pn,Fn={style:{width:"200px"}},Bn=F({name:"MetadataDouble"}),Kn=Object.assign(Bn,{props:{value:{type:Object,default:()=>({})},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","cancel","confirm"],setup(s,{emit:p}){var c,n;const e=s,t=X.useInjectFormItemContext(),i=C(),r=C(!1),o=ae({unit:(c=e.value)==null?void 0:c.unit,scale:((n=e.value)==null?void 0:n.scale)||0}),a=async()=>{await i.value.validate()&&(r.value=!1,p("update:value",{...e.value,...o}),p("confirm",{...e.value,...o}),t.onFieldChange())},d=()=>{var _,g,y;(_=i.value)==null||_.resetFields(),o.unit=(g=e.value)==null?void 0:g.unit,o.scale=((y=e.value)==null?void 0:y.scale)||0,p("cancel")};return E(()=>e.value,_=>{var g,y;o.unit=(g=e.value)==null?void 0:g.unit,o.scale=((y=e.value)==null?void 0:y.scale)||0}),(_,g)=>{const y=pe,m=X,h=se("AIcon"),w=oe;return x(),V(l(_e),{visible:l(r),"onUpdate:visible":g[2]||(g[2]=S=>W(r)?r.value=S:null),placement:s.placement,onOk:a,onCancel:d},{content:v(()=>[O("div",Fn,[f(m,{ref_key:"formRef",ref:i,layout:"vertical",model:l(o)},{default:v(()=>[f(y,{label:"单位",name:"unit",rules:[{max:64,message:"最多可输入64个字符"}]},{default:v(()=>[f(l(xt),{value:l(o).unit,"onUpdate:value":g[0]||(g[0]=S=>l(o).unit=S)},null,8,["value"])]),_:1}),f(ft,{value:l(o).scale,"onUpdate:value":g[1]||(g[1]=S=>l(o).scale=S)},null,8,["value"])]),_:1},8,["model"])])]),default:v(()=>[Y(_.$slots,"default",{},()=>[f(w,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(h,{type:"EditOutlined"})]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),Nn=Kn,Dn={style:{width:"200px"}},Ln=F({name:"MetadataString"}),Gn=Object.assign(Ln,{props:{value:{type:Object,default:()=>({})},placement:{type:String,default:"top"},disabled:{type:Boolean,default:!1}},emits:["update:value","confirm","cancel"],setup(s,{emit:p}){var d;const e=s,t=C(),i=C(!1),r=ae({maxLength:e.value.maxLength||((d=e.value.expands)==null?void 0:d.maxLength)}),o=()=>{i.value=!1;const c={...e.value,expands:{maxLength:r.maxLength}};p("update:value",c),p("confirm",c)},a=()=>{var c,n;(c=t.value)==null||c.resetFields(),r.maxLength=e.value.maxLength||((n=e.value.expands)==null?void 0:n.maxLength),p("cancel")};return E(()=>e.value,c=>{var n;r.maxLength=c.maxLength||((n=c.expands)==null?void 0:n.maxLength)}),(c,n)=>{const _=X,g=se("AIcon"),y=oe;return x(),V(l(_e),{visible:l(i),"onUpdate:visible":n[1]||(n[1]=m=>W(i)?i.value=m:null),placement:s.placement,onOk:o,onCancel:a},{content:v(()=>[O("div",Dn,[f(_,{ref_key:"formRef",ref:t,layout:"vertical",model:l(r)},{default:v(()=>[f(_t,{value:l(r).maxLength,"onUpdate:value":n[0]||(n[0]=m=>l(r).maxLength=m)},null,8,["value"])]),_:1},8,["model"])])]),default:v(()=>[Y(c.$slots,"default",{},()=>[f(y,{type:"link",disabled:s.disabled,style:{padding:"0"}},{icon:v(()=>[f(g,{type:"EditOutlined"})]),_:1},8,["disabled"])])]),_:3},8,["visible","placement"])}}}),Hn=Gn;const qn={key:0},Wn={class:"footer"},zn=F({name:"MetadataPopover"}),Jn=Object.assign(zn,{props:{placement:{type:String,default:"top"},confirmLoading:{type:Boolean,default:!1},showCancel:{type:Boolean,default:!0},showOk:{type:Boolean,default:!0},bodyStyle:{type:[String,Object],default:void 0},visible:{type:Boolean,default:!1}},emits:["ok","cancel","update:visible"],setup(s,{emit:p}){const e=s,t=fe(),i=ma(),{warpClassNames:r,visibleChange:o,visible:a}=hn(e.visible,{visibleChange(n){p("update:visible",n)}}),d=()=>{p("cancel"),o(!1)},c=async()=>{p("ok")};return E(()=>e.visible,n=>{o(n)}),E(()=>i.value,n=>{n||d()}),(n,_)=>{const g=oe,y=at,m=lt;return x(),V(m,{trigger:"click",visible:l(a),"overlay-class-name":{[l(r)]:!0,"metadata-table-popover-warp":!0},overlayStyle:{zIndex:1070},getPopupContainer:h=>l(t)||h,onVisibleChange:h=>null},{content:v(()=>[l(a)?(x(),B("div",qn,[O("div",{style:de(s.bodyStyle)},[Y(n.$slots,"content",{},void 0,!0)],4),O("div",Wn,[f(y,null,{default:v(()=>[s.showCancel?(x(),V(g,{key:0,size:"small",onClick:d},{default:v(()=>[N("取消")]),_:1})):q("",!0),s.showOk?(x(),V(g,{key:1,type:"primary",size:"small",onClick:c,loading:s.confirmLoading},{default:v(()=>[N("确认")]),_:1},8,["loading"])):q("",!0)]),_:1})])])):q("",!0)]),default:v(()=>[O("span",{onClick:_[0]||(_[0]=()=>l(o)(!0))},[Y(n.$slots,"default",{},void 0,!0)])]),_:3},8,["visible","overlay-class-name","getPopupContainer"])}}}),_e=re(Jn,[["__scopeId","data-v-a3c4286e"]]),Yn=F({name:"MetadataUnitSelect"}),Xn=Object.assign(Yn,{props:{value:{type:[String,Number],default:void 0},size:{type:String,default:"middle"},name:{type:String,default:"maxLength"},rules:{type:Array,default:()=>[]}},emits:["update:value","change"],setup(s,{emit:p}){const e=s,t=C(e.value),i=ga(),r=X.useInjectFormItemContext(),o=fe(),a=d=>{const c=d.length>1?d.pop():d==null?void 0:d[0];t.value=[c],p("update:value",c),p("change",c),r.onFieldChange()};return E(()=>e.value,d=>{t.value=d?[d]:void 0},{immediate:!0}),(d,c)=>(x(),V(l(it),{placeholder:"请选择单位",style:{width:"100%"},mode:"tags",value:l(t),"onUpdate:value":c[0]||(c[0]=n=>W(t)?t.value=n:null),dropdownStyle:{zIndex:1071},getPopupContainer:n=>l(o)||n,options:l(i),optionFilterProp:"label",onChange:a},null,8,["value","getPopupContainer","options"]))}}),xt=Xn,Zn=F({name:"MetadataType"}),Qn=Object.assign(Zn,{props:{...rt(),filter:{type:Array,default:()=>[]},value:{type:Object,default:()=>({type:void 0})}},emits:["update:value"],setup(s,{emit:p}){const e=s,t=C(e.value.type),i=L(()=>ba.filter(a=>!e.filter.includes(a.value))),r=fe(),o=a=>{t.value=a;const d={};let c={type:a};if(a==="boolean"){const n=ht();Object.keys(n).forEach(_=>{e.value[_]||(d[_]=n[_])}),c=Object.assign(c,d)}p("update:value",c)};return E(()=>e.value,a=>{t.value=a.type}),(a,d)=>{const c=it;return x(),B("div",{class:ie({"select-no-value":!s.value})},[f(c,ct(e,{"allow-clear":"",value:l(t),style:{width:"100%"},placeholder:"请选择数据类型",dropdownStyle:{zIndex:1071},options:l(i),getPopupContainer:n=>l(r)||n,onChange:o}),null,16,["value","options","getPopupContainer"])],2)}}}),Ge=Qn;const eo=F({name:"MetadataGroup"}),to=Object.assign(eo,{props:{value:{type:String,default:void 0}},emits:["update:value","change"],setup(s,{emit:p}){const e=s,t=C(e.value),i=C(),r=Yt(ya,{}),o=fe(),a=L(()=>{if(i.value){let n=(r.options.value||[]).filter(_=>_.value.includes(i.value));return n.length||n.unshift({label:i.value,value:i.value}),n}return r.options.value||[]}),d=n=>{i.value=n},c=n=>{r.addOptions({label:n,value:n}),p("update:value",n),p("change",n)};return E(()=>e.value,()=>{t.value=e.value}),(n,_)=>{const g=Nt;return x(),V(g,{value:l(t),"onUpdate:value":_[0]||(_[0]=y=>W(t)?t.value=y:null),options:l(a),placeholder:"请选择分组",style:{width:"100%"},getPopupContainer:y=>l(o)||y,onSearch:d,onSelect:c},null,8,["value","options","getPopupContainer"])}}}),fo=to;export{nn as A,Cn as B,Nn as D,ze as E,An as F,fo as G,vo as I,po as O,_e as P,Hn as S,Ge as T,we as a,mn as b,$n as c,un as d};
