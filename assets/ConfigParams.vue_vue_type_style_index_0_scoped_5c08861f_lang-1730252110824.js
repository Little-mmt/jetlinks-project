import{F as w,a4 as z,eZ as E,e_ as M,e$ as N,f0 as G,f1 as X,f2 as Y,f3 as H,f4 as K,f5 as Q,f6 as W,aC as j,Z as D}from"./index-1730252110824.js";import"./Source.vue_vue_type_style_index_0_scoped_5dc360f1_lang-1730252110824.js";import{_ as S}from"./ConfigModal.vue_vue_type_script_setup_true_name_ConfigModal_lang-1730252110824.js";import"./Metrics.vue_vue_type_script_setup_true_name_Metrics_lang-1730252110824.js";import"./OtherSetting.vue_vue_type_style_index_0_scoped_d8c8c8c1_lang-1730252110824.js";import"./OutputParams.vue_vue_type_style_index_0_scoped_6ffcb997_lang-1730252110824.js";import{_ as R}from"./ValueObject.vue_vue_type_script_setup_true_name_ValueObject_lang-1730252110824.js";import"./OtherConfigInfo.vue_vue_type_script_setup_true_name_OtherConfigInfo_lang-1730252110824.js";import V from"./Constraint-1730252110824.js";import{c as ee,T as A,v as F,t as te,h as ne}from"./columns-1730252110824.js";import{d as P,k as C,w as J,U as f,Z as ae,_ as q,f as x,u as a,G as h,V as c,X as v,E as B,$ as O,Y as oe,ab as L}from"./vue-1730252110824.js";const re={class:"metadata-type"},se={class:"metadata-type-select"},le=P({name:"MetadataDataType"}),Te=P({...le,props:{value:{type:Object,default:()=>({})}},emits:["update:value"],setup(I,{emit:T}){var l,i,d,_;const p=I,b=w.useInjectFormItemContext(),y=[{title:"参数标识",dataIndex:"id",type:"text",width:100,placement:"Left",form:{required:!0,rules:[{callback(m,e,t){if(e){const g=m.field.split("."),$=Number(g[1]);return t.some((Z,U)=>Z.id===e&&$!==U)?Promise.reject("该标识已存在"):Promise.resolve()}return Promise.reject("请输入标识")}},{max:64,message:"最多可输入64个字符"},{pattern:/^[a-zA-Z0-9_\-]+$/,message:"标识只能由数字、字母、下划线、中划线组成"}]}},{title:"参数名称",dataIndex:"name",type:"text",width:100,form:{required:!0,rules:[{required:!0,message:"请输入参数名称"},{max:64,message:"最多可输入64个字符"}]}},{title:"数据类型",type:"components",dataIndex:"valueType",components:{name:R},form:{required:!0,rules:[{validator(m,e){return e!=null&&e.type?Promise.resolve():Promise.reject("请选择数据类型")}}]},width:100},{title:"其他配置",dataIndex:"config",width:100,form:{rules:[{callback(m,e,t){const g=m.field.split("."),$=Number(g[1]),k=t.find((Z,U)=>U===$);return F(k==null?void 0:k.valueType)}}]}},{title:"操作",dataIndex:"action",width:60}];C([]);const u=C((i=(l=p.value)==null?void 0:l.valueType)==null?void 0:i.type);C((_=(d=p.value)==null?void 0:d.valueType)==null?void 0:_.elements);const o=C(z(p.value.valueType)),r=m=>{let e=te(m);o.value=e,T("update:value",{...p.value,valueType:{...e,type:m}}),b.onFieldChange()},n=(m,e)=>{const t=ne(e,m);T("update:value",{...p.value,valueType:{...t,type:u.value}}),b.onFieldChange()},{unitOptions:s}=ee(u);return J(()=>JSON.stringify(p.value),()=>{var m,e,t;u.value=(e=(m=p.value)==null?void 0:m.valueType)==null?void 0:e.type,o.value=(t=p.value)==null?void 0:t.valueType,console.log(p.value)},{immediate:!0}),(m,e)=>(f(),ae("div",re,[q("div",se,[x(a(E),{value:a(u),"onUpdate:value":e[0]||(e[0]=t=>h(u)?u.value=t:null),onChange:r},null,8,["value"])]),a(u)==="array"?(f(),c(a(M),{key:0,value:a(o).elementType,"onUpdate:value":e[1]||(e[1]=t=>a(o).elementType=t),unitOptions:a(s),placement:"bottomRight",onConfirm:e[2]||(e[2]=t=>{n(t,"array")})},null,8,["value","unitOptions"])):a(u)==="object"?(f(),c(a(N),{key:1,value:a(o).properties,placement:"bottomRight",columns:y,onConfirm:e[3]||(e[3]=t=>{n(t,"object")})},{valueType:v(({data:t})=>{var g;return[B(O(a(A)[(g=t.record.valueType)==null?void 0:g.type]),1)]}),config:v(({data:t})=>[x(S,{value:t.record.valueType,"onUpdate:value":g=>t.record.valueType=g,showOther:!1},null,8,["value","onUpdate:value"])]),_:1},8,["value"])):a(u)==="enum"?(f(),c(a(G),{key:2,value:a(o),"onUpdate:value":e[4]||(e[4]=t=>h(o)?o.value=t:null),placement:"bottomRight",onConfirm:e[5]||(e[5]=t=>{n(t,"enum")})},null,8,["value"])):a(u)==="boolean"?(f(),c(a(X),{key:3,value:a(o),"onUpdate:value":e[6]||(e[6]=t=>h(o)?o.value=t:null),placement:"bottomRight",onConfirm:e[7]||(e[7]=t=>{n(t,"boolean")})},null,8,["value"])):["float","double"].includes(a(u))?(f(),c(a(Y),{key:4,options:a(s),value:a(o),"onUpdate:value":e[8]||(e[8]=t=>h(o)?o.value=t:null),placement:"bottomRight",onConfirm:e[9]||(e[9]=t=>{n(t,"float")})},null,8,["options","value"])):["int","long"].includes(a(u))?(f(),c(a(H),{key:5,options:a(s),value:a(o).unit,"onUpdate:value":e[10]||(e[10]=t=>a(o).unit=t),placement:"bottomRight",onConfirm:e[11]||(e[11]=t=>{n(t,"int")})},null,8,["options","value"])):a(u)==="file"?(f(),c(a(K),{key:6,value:a(o).bodyType,"onUpdate:value":e[12]||(e[12]=t=>a(o).bodyType=t),placement:"bottomRight",onConfirm:e[13]||(e[13]=t=>{n(t,"file")})},null,8,["value"])):a(u)==="date"?(f(),c(a(Q),{key:7,value:a(o).format,"onUpdate:value":e[14]||(e[14]=t=>a(o).format=t),placement:"bottomRight",onConfirm:e[15]||(e[15]=t=>{n(t,"date")})},null,8,["value"])):["string","password"].includes(a(u))?(f(),c(a(W),{key:8,value:a(o).maxLength,"onUpdate:value":e[16]||(e[16]=t=>a(o).maxLength=t),placement:"bottomRight",onConfirm:e[17]||(e[17]=t=>{n(t,"string")})},null,8,["value"])):oe("",!0)]))}});const ie=P({name:"InputParams"}),be=P({...ie,props:{value:{type:Array,default:()=>[]},placeholder:{type:String,default:"请选择"},options:{type:Array,default:()=>[]},hasPermission:String},emits:["update:value","change"],setup(I,{emit:T}){const p=w.useInjectFormItemContext(),b=()=>({id:void 0,name:void 0,valueType:{},expands:{required:!1}}),y=C([{title:"参数标识",dataIndex:"id",type:"text",placement:"Left",form:{required:!0,rules:[{callback(o,r,n){if(r){const s=o.field.split("."),l=Number(s[1]);return n.some((d,_)=>d.id===r&&l!==_)?Promise.reject("该标识已存在"):Promise.resolve()}return Promise.reject("请输入标识")}},{max:64,message:"最多可输入64个字符"},{pattern:/^[a-zA-Z0-9_\-]+$/,message:"标识只能由数字、字母、下划线、中划线组成"}]}},{title:"参数名称",dataIndex:"name",type:"text",form:{required:!0,rules:[{required:!0,message:"请输入名称"},{max:64,message:"最多可输入64个字符"}]}},{title:"填写约束",dataIndex:"required",type:"components",width:100,components:{name:V},control(o,r){var n;return o.expands.required!==((n=r==null?void 0:r.expands)==null?void 0:n.required)}},{title:"数据类型",type:"components",dataIndex:"valueType",components:{name:R},form:{required:!0,rules:[{validator(o,r){return r!=null&&r.type?Promise.resolve():Promise.reject("请选择数据类型")}}]},control(o,r){var n;return o.valueType.type!==((n=r==null?void 0:r.valueType)==null?void 0:n.type)}},{title:"其他配置",dataIndex:"config",form:{required:!0,rules:[{callback(o,r,n){const s=o.field.split("."),l=Number(s[1]),i=n.find((d,_)=>_===l);return F(i.valueType)}}]},control(o,r){if(o&&!r)return!0;if(o&&r){const n=j(o.valueType,["type","required"]),s=j(r.valueType,["type","required"]);return JSON.stringify(n)!==JSON.stringify(s)}return!1}},{title:"操作",dataIndex:"action",width:60}]),u=o=>{console.log("inputParams",o),T("update:value",o),p.onFieldChange()};return(o,r)=>{const n=L("AIcon"),s=D;return f(),c(a(N),{value:I.value,columns:a(y),onAdd:b,width:"700px",onConfirm:u,placement:"bottomRight"},{valueType:v(({data:l})=>{var i;return[q("span",null,O(a(A)[(i=l.record.valueType)==null?void 0:i.type]),1)]}),required:v(({data:l})=>{var i;return[q("span",null,O((i=l.record.expands)!=null&&i.required?"必填":"不必填"),1)]}),config:v(({data:l})=>[x(S,{value:l.record.valueType,"onUpdate:value":i=>l.record.valueType=i,showOther:!1},null,8,["value","onUpdate:value"])]),default:v(()=>[x(s,{key:"properties","has-permission":I.hasPermission,type:"link"},{default:v(()=>[x(n,{type:"SettingOutlined"}),B(" 配置 ")]),_:1},8,["has-permission"])]),_:1},8,["value","columns"])}}});const ue=P({name:"ConfigParams"}),Ce=P({...ue,props:{value:{type:Object,default:()=>({})},placeholder:{type:String,default:"请选择"},options:{type:Array,default:()=>[]},hasPermission:String},emits:["update:value","change"],setup(I,{emit:T}){const p=I,b=[{title:"参数标识",dataIndex:"id",type:"text",placement:"Left",form:{required:!0,rules:[{callback(r,n,s){if(n){const l=r.field.split("."),i=Number(l[1]);return s.some((_,m)=>_.id===n&&i!==m)?Promise.reject("该标识已存在"):Promise.resolve()}return Promise.reject("请输入标识")}},{max:64,message:"最多可输入64个字符"},{pattern:/^[a-zA-Z0-9_\-]+$/,message:"标识只能由数字、字母、下划线、中划线组成"}]}},{title:"参数名称",dataIndex:"name",type:"text",form:{required:!0,rules:[{required:!0,message:"请输入参数名称"},{max:64,message:"最多可输入64个字符"}]}},{title:"数据类型",type:"components",dataIndex:"valueType",components:{name:R},form:{required:!0,rules:[{validator(r,n){return n!=null&&n.type?Promise.resolve():Promise.reject("请选择数据类型")}}]},control(r,n){var s,l;return((s=r.valueType)==null?void 0:s.type)!==((l=n==null?void 0:n.valueType)==null?void 0:l.type)}},{title:"其他配置",dataIndex:"config",form:{required:!0,rules:[{callback(r,n,s){const l=r.field.split("."),i=Number(l[1]),d=s[i];return F(d.valueType)}}]},control(r,n){if(r&&!n)return!0;if(r&&n){const s=j(r.valueType,["type"]),l=j(n.valueType,["type"]);return JSON.stringify(s)!==JSON.stringify(l)}return!1}},{title:"操作",dataIndex:"action",width:80}],y=C(p.value.properties),u=w.useInjectFormItemContext(),o=r=>{console.log("ConfigParams",r);const n=r.map(s=>j(s,["_sortIndex","config","action"]));console.log("ConfigParams",n),T("update:value",{properties:n,type:"object"}),u.onFieldChange()};return J(()=>p.value,r=>{y.value=p.value.properties},{immediate:!0}),(r,n)=>{const s=L("AIcon"),l=D;return f(),c(a(N),{value:a(y),"onUpdate:value":n[0]||(n[0]=i=>h(y)?y.value=i:null),columns:b,onConfirm:o,placement:"bottomRight"},{valueType:v(({data:i})=>{var d;return[q("span",null,O(a(A)[(d=i.record.valueType)==null?void 0:d.type]),1)]}),config:v(({data:i})=>[x(S,{value:i.record.valueType,"onUpdate:value":d=>i.record.valueType=d,showOther:!1},null,8,["value","onUpdate:value"])]),default:v(()=>[x(l,{key:"properties","has-permission":I.hasPermission,style:{"padding-left":"0"},type:"link"},{default:v(()=>[x(s,{type:"SettingOutlined"}),B(" 配置 ")]),_:1},8,["has-permission"])]),_:1},8,["value"])}}});export{Te as _,Ce as a,be as b};
