import{aF as x,aO as P,y as T,v as $,g as W}from"./index-1731638920964.js";import{_ as z}from"./WhenItem.vue_vue_type_script_setup_true_name_WhenItem_lang-1731638920964.js";import{d as F,ai as E,k as w,e as _,ab as G,U as p,Z as b,_ as a,$ as q,V as g,X as f,f as l,Y as J,u as r,F as R,a1 as U,a0 as X,E as Y,a4 as k}from"./vue-1731638920964.js";import{u as Z}from"./scene-17316389209642.js";import H from"./index-1731638920964222.js";import"./TermsItem.vue_vue_type_script_setup_true_name_TermsItem_lang-1731638920964.js";import"./ParamsItem.vue_vue_type_script_setup_true_name_ParamsItem_lang-1731638920964.js";import"./DropdownButton-1731638920964.js";import"./DropdownButton.vue_vue_type_style_index_0_scoped_011bae6b_lang-1731638920964.js";import"./index-1731638920964281.js";import"./Menus-1731638920964.js";import"./util-17316389209643.js";import"./isUndefined-1731638920964.js";import"./Time.vue_vue_type_style_index_0_lang-1731638920964.js";import"./index-1731638920964223.js";import"./typings-1731638920964.js";import"./Array-1731638920964.js";import"./Array.vue_vue_type_style_index_0_scoped_59b5dd9b_lang-1731638920964.js";import"./Double.vue_vue_type_script_setup_true_name_DoubleParamsDropdown_lang-1731638920964.js";import"./util-17316389209645.js";import"./scene-1731638920964.js";import"./index-1731638920964276.js";import"./index-1731638920964224.js";import"./index-1731638920964279.js";import"./index-1731638920964291.js";import"./List-1731638920964.js";import"./index-1731638920964219.js";import"./ActionTypeComponent.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./index.vue_vue_type_script_setup_true_lang-173163892096430.js";import"./index-1731638920964220.js";import"./index-1731638920964286.js";import"./NotifyWay-1731638920964.js";import"./config-17316389209642.js";import"./NotifyConfig.vue_vue_type_style_index_0_lang-1731638920964.js";import"./index-1731638920964278.js";import"./index-1731638920964280.js";import"./index-1731638920964282.js";import"./index-1731638920964283.js";import"./const-17316389209642.js";import"./NotifyTemplate.vue_vue_type_style_index_0_lang-1731638920964.js";import"./template-1731638920964.js";import"./VariableDefinitions.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./BuildIn.vue_vue_type_script_setup_true_name_NotifyBuildIn_lang-1731638920964.js";import"./Org.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./Tag.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./InputFile.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./User.vue_vue_type_script_setup_true_name_NotifyUser_lang-1731638920964.js";import"./unionBy-1731638920964.js";import"./index-1731638920964218.js";import"./index-1731638920964287.js";import"./Product-17316389209643.js";import"./product-17316389209644.js";import"./category-1731638920964.js";import"./department-17316389209642.js";import"./setting-17316389209642.js";import"./index.vue_vue_type_script_setup_true_name_Device_lang-1731638920964.js";import"./TopCard-17316389209646.js";import"./Device-1731638920964.js";import"./Tag-1731638920964.js";import"./RelationSelect.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./util-17316389209642.js";import"./lodash.default-1731638920964.js";import"./throttle-1731638920964.js";import"./min-1731638920964.js";import"./isNil-1731638920964.js";import"./difference-1731638920964.js";import"./flattenDeep-1731638920964.js";import"./sortBy-1731638920964.js";import"./uniqBy-1731638920964.js";import"./toLower-1731638920964.js";import"./index.vue_vue_type_script_setup_true_name_ActionDeviceActions_lang-1731638920964.js";import"./EditTable.vue_vue_type_script_setup_true_lang-17316389209642.js";import"./FunctionItem.vue_vue_type_script_setup_true_name_FunctionItem_lang-1731638920964.js";import"./index-1731638920964310.js";import"./WriteProperty.vue_vue_type_script_setup_true_lang-1731638920964.js";import"./CardSelect-1731638920964.js";import"./Item-17316389209643.js";import"./index-1731638920964221.js";import"./AlarmModal-1731638920964.js";import"./useRequest-1731638920964.js";import"./useAlarmLevel-1731638920964.js";import"./config-1731638920964.js";import"./configuration-1731638920964.js";import"./util-1731638920964.js";import"./FilterGroup.vue_vue_type_script_setup_true_name_FilterGroup_lang-1731638920964.js";import"./FilterCondition.vue_vue_type_script_setup_true_name_FilterCondition_lang-1731638920964.js";import"./CheckFilterItem-1731638920964.js";import"./CheckItem.vue_vue_type_script_setup_true_name_ActionCheckItem_lang-1731638920964.js";const K={class:"actions-terms-title"},Q={class:"actions-terms-list-content"},ee={style:{display:"flex","padding-top":"10px"}},te={key:1,style:{display:"flex","padding-top":"10px"}},oe={class:"actions-branches"},re=F({name:"Branches"}),se=F({...re,props:{isFirst:{type:Boolean,default:!0},data:{type:Object,default:()=>({when:[],shakeLimit:{},then:[]})},class:{type:String,default:""},name:{type:Number,default:0},branches_Index:{type:Number,default:0},groupLen:{type:Number,default:0},groupIndex:{type:Number,default:0},showGroupDelete:{type:Boolean,default:!1}},emits:["deleteGroup","delete"],setup(o,{emit:C}){const e=o,I=Z(),{data:t}=E(I),y=w(!1),N=w(!1),B=_(()=>e.data.when.length),d=_(()=>e.data.when),D=_(()=>{var m;return{"actions-terms-warp":!0,"first-children":e.isFirst,"terms-items":(((m=t.value.branches)==null?void 0:m.length)||0)>0}}),S=()=>{C("delete")},L=()=>{t.value.branches&&(t.value.branches[e.name].when=[],t.value.options.when[e.branches_Index].terms=[],t.value.branches[e.name+1]===null&&t.value.branches.splice(e.name+1,1))},O=()=>{e.isFirst||(y.value=!0)},A=()=>{e.isFirst||(y.value=!1)},j=()=>{var s,i,n,u,h;const m={type:"and",terms:[{column:void 0,value:{source:"fixed",value:void 0},termType:void 0,key:`params_${x()}`,type:"and"}],key:`terms_${x()}`};(i=(s=t.value.branches)==null?void 0:s[e.name].when)==null||i.push(m),((n=t.value.branches)==null?void 0:n.length)<=e.name+1&&((u=t.value.branches)==null||u.splice(e.groupLen,0,null)),(h=t.value.options.when[e.branches_Index])==null||h.terms.push({termType:"并且",terms:[["","eq","","and"]]})},V=_(()=>({"actions-terms-options":!0,border:!e.isFirst,error:N})),M=[{validator(m,s){return!s||s&&!s.length?Promise.reject("至少配置一个执行动作"):s.some(n=>n.actions&&n.actions.length)?Promise.resolve():Promise.reject("至少配置一个执行动作")}}];return(m,s)=>{const i=G("AIcon"),n=P,u=T,h=$;return p(),b("div",{class:k(r(D))},[a("div",K,q(o.isFirst?"当":"否则"),1),a("div",{class:k(r(V))},[o.isFirst?J("",!0):(p(),g(n,{key:0,title:"确认删除？",onConfirm:S,className:"terms-params-delete danger show"},{default:f(()=>[l(i,{type:"DeleteOutlined"})]),_:1})),a("div",{class:"actions-terms-list",onMouseover:O,onMouseout:A},[l(n,{title:"该操作将清空过滤条件，确认删除？",show:r(y)&&r(d).length,onConfirm:L,className:"terms-params-delete"},{default:f(()=>[l(i,{type:"CloseOutlined"})]),_:1},8,["show"]),a("div",Q,[r(B)?(p(),g(u,{key:0},{default:f(()=>[a("div",ee,[(p(!0),b(R,null,U(r(d),(c,v)=>(p(),g(z,{key:c.key,name:v,showDeleteBtn:r(d).length!==1,isFirst:v===0,isLast:v===r(d).length-1,branchName:o.name,branches_Index:o.branches_Index,data:c},null,8,["name","showDeleteBtn","isFirst","isLast","branchName","branches_Index","data"]))),128))])]),_:1})):(p(),b("div",te,[a("span",{class:"when-add",onClick:j,style:X({padding:o.isFirst?"16px 0":0})},[l(i,{type:"PlusCircleOutlined",style:{padding:"4px"}}),Y(" 添加过滤条件 ")],4)]))])],32),a("div",oe,[l(h,{name:["branches",o.name,"then"],rules:M},{default:f(()=>{var c;return[l(H,{name:o.name,openShakeLimit:!0,thenOptions:(c=r(t).branches[o.name])==null?void 0:c.then,groupIndex:o.groupIndex},null,8,["name","thenOptions","groupIndex"])]}),_:1},8,["name"])])],2)],2)}}});const $t=W(se,[["__scopeId","data-v-88bc8570"]]);export{$t as default};
