import{o as p,a3 as g,aa as S}from"./index-1730252110824.js";import"./index-1730252110824278.js";import"./index-1730252110824279.js";import"./index-1730252110824280.js";import"./index-1730252110824281.js";import"./index-1730252110824282.js";import"./index-1730252110824283.js";import{a as w,d as k}from"./role-1730252110824.js";import{d as x,k as d,ab as B,U as I,V as U,X as A,f as u,u as f}from"./vue-1730252110824.js";const M=x({__name:"AddUserDialog",props:{visible:{type:Boolean},roleId:{}},emits:["refresh","update:visible"],setup(v,{emit:l}){const i=v,m=[{title:"姓名",dataIndex:"name",key:"name",search:{type:"string"}},{title:"用户名",dataIndex:"username",key:"username",search:{type:"string"}}],c=d({}),t=d([]),_=e=>{const s={...e,sorts:[{name:"createTime",order:"desc"}],terms:[{terms:[{column:"id$in-dimension$role$not",value:i.roleId},{column:"username",value:"admin",termType:"not",type:"and"}]}]};return e.terms[0]&&s.terms.unshift({terms:e.terms[0].terms}),w(s)},y=()=>{t.value.length<1?p("请至少选择一项","error"):k(i.roleId,t.value).then(e=>{e.status===200&&(p("操作成功"),l("refresh"),l("update:visible",!1))})},h=(e,s)=>{const o=new Set(t.value);console.log(e,s),s?o.add(e.id):o.delete(e.id),t.value=[...o.values()]},b=(e,s,o)=>{if(e)o.map(a=>{t.value.includes(a.id)||t.value.push(a.id)});else{const a=o.map(r=>r.id),n=[];t.value.map(r=>{a.includes(r)||n.push(r)}),t.value=n}};return(e,s)=>{const o=B("pro-search"),a=g,n=S;return I(),U(n,{visible:"",title:"新增",width:"1000px",onOk:y,onCancel:s[1]||(s[1]=r=>l("update:visible",!1))},{default:A(()=>[u(o,{columns:m,target:"simple",onSearch:s[0]||(s[0]=r=>c.value={...r})}),u(a,{ref:"tableRef",columns:m,request:_,model:"TABLE",params:f(c),rowSelection:{selectedRowKeys:f(t),onSelect:h,onSelectAll:b,onSelectNone:()=>t.value=[]}},null,8,["params","rowSelection"])]),_:1})}}});export{M as _};
